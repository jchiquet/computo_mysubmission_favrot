<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.398">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Armand Favrot">
<meta name="author" content="David Makowski">
<meta name="dcterms.date" content="2023-10-06">
<meta name="keywords" content="bayesian model, epidemiology, hierarchical model, pest control, trial, survey">

<title>submitted-202310-favrot-pest - A hierarchical model to evaluate pest treatments from prevalence and intensity data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: #FFFFFF;
      }

      .quarto-title-block .quarto-title-banner {
        color: #FFFFFF;
background: #034E79;
      }
</style>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<meta name="citation_title" content="A hierarchical model to evaluate pest treatments from prevalence and intensity data">
<meta name="citation_abstract" content="In plant epidemiology, pest abundance is measured in field trials using metrics assessing either pest prevalence (fraction of the plant population infected) or pest intensity (average number of pest individuals present in infected plants). Some of these trials rely on prevalence, while others rely on intensity, depending on the protocols.
In this paper, we present a hierarchical Bayesian model able to handle both types of data. In this model, the intensity and prevalence variables are derived from a latent variable representing the number of pest individuals on each host individual, assumed to follow a Poisson distribution. Effects of pest treaments, time trend, and between-trial variability are described using fixed and random effects.
We apply the model to a real dataset in the context of aphid control in sugar beet fields. In this dataset, prevalence and intensity were derived from aphid counts observed on either factorial trials testing different types of pesticides treatments or field surveys monitoring aphid abundance.
Next, we perform simulations to assess the impacts of using either prevalence or intensity data, or both types of data simultaneously, on the accuracy of the model parameter estimates and on the ranking of pesticide treatment efficacy.
Our results show that, when pest prevalence and pest intensity data are collected separately in different trials, the model parameters are more accurately estimated using both types of trials than using one type of trials only. When prevalence data are collected in all trials and intensity data are collected in a subset of trials, estimations and pest treatment ranking are more accurate using both types of data than using prevalence data only. When only one type of observation can be collected in a pest survey or in an experimental trial, our analysis indicates that it is better to collect intensity data than prevalence data when all or most of the plants are expected to be infested, but that both types of data lead to similar results when the level of infestation is low to moderate. Finally, our simulations show that it is unlikely to obtain accurate results with fewer than 40 trials when assessing the efficacy of pest control treatments based on prevalence and intensity data.
Because of its flexibility, our model can be used to evaluate and rank the efficacy of pest treatments using either prevalence or intensity data, or both types of data simultaneously. As it can be easily implemented using standard Bayesian packages, we hope that it will be useful to agronomists, plant pathologists, and applied statisticians to analyze pest surveys and field experiments conducted to assess the efficacy of pest treatments.

">
<meta name="citation_keywords" content="bayesian model,epidemiology,hierarchical model,pest control,trial,survey">
<meta name="citation_author" content="Armand Favrot">
<meta name="citation_author" content="David Makowski">
<meta name="citation_publication_date" content="2023-01-25">
<meta name="citation_cover_date" content="2023-01-25">
<meta name="citation_year" content="2023">
<meta name="citation_online_date" content="2023-10-06">
<meta name="citation_fulltext_html_url" content="https://computo.sfds.asso.fr/">
<meta name="citation_doi" content="to complete">
<meta name="citation_issn" content="2824-7795">
<meta name="citation_language" content="en">
<meta name="citation_firstpage" content="undefined">
<meta name="citation_journal_title" content="Computo">
<meta name="citation_reference" content="citation_title=Sampling for plant disease incidence;,citation_author=LV Madden;,citation_author=G Hughes;,citation_publication_date=1999;,citation_cover_date=1999;,citation_year=1999;,citation_issue=11;,citation_volume=89;,citation_journal_title=Phytopathology;,citation_publisher=Am Phytopath Society;">
<meta name="citation_reference" content="citation_title=A framework based on generalised linear mixed models for analysing pest and disease surveys;,citation_author=Lucie Michel;,citation_author=Francois Brun;,citation_author=David Makowski;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_volume=94;,citation_journal_title=Crop Protection;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Assessment of non-neonicotinoid treatments against aphids on sugar beets;,citation_author=Anabelle Laurent;,citation_author=Armand Favrot;,citation_author=Fabienne Maupas;,citation_author=Cédric Royer;,citation_author=David Makowski;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0261219422002368;,citation_doi=10.1016/j.cropro.2022.106140;,citation_issn=0261-2194;,citation_volume=164;,citation_journal_title=Crop Protection;">
<meta name="citation_reference" content="citation_title=The environmental risks of neonicotinoid pesticides: A review of the evidence post 2013;,citation_author=Thomas James Wood;,citation_author=Dave Goulson;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_issue=21;,citation_volume=24;,citation_journal_title=Environmental Science and Pollution Research;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Effects of neonicotinoids and fipronil on non-target invertebrates;,citation_author=Lennard W Pisa;,citation_author=Vanessa Amaral-Rogers;,citation_author=Luc P Belzunces;,citation_author=Jean-Marc Bonmatin;,citation_author=Craig A Downs;,citation_author=Dave Goulson;,citation_author=David P Kreutzweiser;,citation_author=Christian Krupke;,citation_author=Matthias Liess;,citation_author=Melanie McField;,citation_author=others;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_issue=1;,citation_volume=22;,citation_journal_title=Environmental Science and Pollution Research;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Metrics matter: The effect of parasite richness, intensity and prevalence on the evolution of host migration;,citation_author=Allison K Shaw;,citation_author=Julie Sherman;,citation_author=F Keith Barker;,citation_author=Marlene Zuk;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1891;,citation_volume=285;,citation_journal_title=Proceedings of the Royal Society B;,citation_publisher=The Royal Society;">
<meta name="citation_reference" content="citation_title=Rjags: Bayesian graphical models using MCMC;,citation_author=Martyn Plummer;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://CRAN.R-project.org/package=rjags;">
<meta name="citation_reference" content="citation_title=Inference from iterative simulation using multiple sequences;,citation_author=Andrew Gelman;,citation_author=Donald B Rubin;,citation_publication_date=1992;,citation_cover_date=1992;,citation_year=1992;,citation_journal_title=Statistical science;,citation_publisher=JSTOR;">
<meta name="citation_reference" content="citation_title=Foundations of linear and generalized linear models;,citation_author=Alan Agresti;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;">
<meta name="citation_reference" content="citation_title=Using observation-level random effects to model overdispersion in count data in ecology and evolution;,citation_author=Xavier A Harrison;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_volume=2;,citation_journal_title=PeerJ;,citation_publisher=PeerJ Inc.;">
<meta name="citation_reference" content="citation_title=Multivariate poisson-lognormal models for jointly modeling crash frequency by severity;,citation_author=Eun Sug Park;,citation_author=Dominique Lord;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_issue=1;,citation_volume=2019;,citation_journal_title=Transportation Research Record;,citation_publisher=SAGE Publications Sage CA: Los Angeles, CA;">
<meta name="citation_reference" content="citation_title=Joint modelling of two count variables when one of them can be degenerate;,citation_author=Jacek Osiewalski;,citation_author=Jerzy Marzec;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_volume=34;,citation_journal_title=Computational Statistics;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Generalized bivariate count data regression models;,citation_author=Shiferaw Gurmu;,citation_author=John Elder;,citation_publication_date=2000;,citation_cover_date=2000;,citation_year=2000;,citation_issue=1;,citation_volume=68;,citation_journal_title=Economics Letters;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Bayesian data analysis;,citation_author=Andrew Gelman;,citation_author=John B Carlin;,citation_author=Hal S Stern;,citation_author=Donald B Rubin;,citation_publication_date=1995;,citation_cover_date=1995;,citation_year=1995;">
</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title"><a href="https://computo.sfds.asso.fr">
        <img src="https://computo.sfds.asso.fr/assets/img/logo_notext_white.png" height="60px">
      </a> &nbsp; A hierarchical model to evaluate pest treatments from prevalence and intensity data</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> source</button></div></div>
            <p><a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/80x15.png" alt="Creative Commons BY License"></a>
ISSN 2824-7795</p>
                </div>
  </div>
    
    <div class="quarto-title-meta-author">
      <div class="quarto-title-meta-heading">Authors</div>
      <div class="quarto-title-meta-heading">Affiliation</div>
          
          <div class="quarto-title-meta-contents">
        Armand Favrot 
      </div>
          
          <div class="quarto-title-meta-contents">
              <p class="affiliation">
                  <a href="https://mia-ps.inrae.fr/">
                  MIA Paris-Saclay, INRAE AgroParisTech Université Paris-Saclay, France
                  </a>
                </p>
            </div>
            <div class="quarto-title-meta-contents">
        David Makowski 
      </div>
          
          <div class="quarto-title-meta-contents">
              <p class="affiliation">
                  <a href="https://mia-ps.inrae.fr/">
                  MIA Paris-Saclay, INRAE AgroParisTech Université Paris-Saclay, France
                  </a>
                </p>
            </div>
        </div>
                    
  <div class="quarto-title-meta">
                                
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 6, 2023</p>
      </div>
    </div>
                                    
      
      <div>
      <div class="quarto-title-meta-heading">Doi</div>
      <div class="quarto-title-meta-contents">
        <p class="doi">
          <a href="https://doi.org/to complete">to complete</a>
        </p>
      </div>
    </div>
                  
      <div>
      <div class="quarto-title-meta-heading">Keywords</div>
      <div class="quarto-title-meta-contents">
        <p class="date">bayesian model, epidemiology, hierarchical model, pest control, trial, survey</p>
      </div>
    </div>
    
    <div>
      <div class="quarto-title-meta-heading">Status</div>
      <div class="quarto-title-meta-contents">
              <p class="date">draft</p>
                  </div>
    </div>

  </div>
                                                
  <div>
    <div class="abstract">
    <div class="abstract-title">Abstract</div>
      <p>In plant epidemiology, pest abundance is measured in field trials using metrics assessing either pest prevalence (fraction of the plant population infected) or pest intensity (average number of pest individuals present in infected plants). Some of these trials rely on prevalence, while others rely on intensity, depending on the protocols. In this paper, we present a hierarchical Bayesian model able to handle both types of data. In this model, the intensity and prevalence variables are derived from a latent variable representing the number of pest individuals on each host individual, assumed to follow a Poisson distribution. Effects of pest treaments, time trend, and between-trial variability are described using fixed and random effects. We apply the model to a real dataset in the context of aphid control in sugar beet fields. In this dataset, prevalence and intensity were derived from aphid counts observed on either factorial trials testing different types of pesticides treatments or field surveys monitoring aphid abundance. Next, we perform simulations to assess the impacts of using either prevalence or intensity data, or both types of data simultaneously, on the accuracy of the model parameter estimates and on the ranking of pesticide treatment efficacy. Our results show that, when pest prevalence and pest intensity data are collected separately in different trials, the model parameters are more accurately estimated using both types of trials than using one type of trials only. When prevalence data are collected in all trials and intensity data are collected in a subset of trials, estimations and pest treatment ranking are more accurate using both types of data than using prevalence data only. When only one type of observation can be collected in a pest survey or in an experimental trial, our analysis indicates that it is better to collect intensity data than prevalence data when all or most of the plants are expected to be infested, but that both types of data lead to similar results when the level of infestation is low to moderate. Finally, our simulations show that it is unlikely to obtain accurate results with fewer than 40 trials when assessing the efficacy of pest control treatments based on prevalence and intensity data. Because of its flexibility, our model can be used to evaluate and rank the efficacy of pest treatments using either prevalence or intensity data, or both types of data simultaneously. As it can be easily implemented using standard Bayesian packages, we hope that it will be useful to agronomists, plant pathologists, and applied statisticians to analyze pest surveys and field experiments conducted to assess the efficacy of pest treatments.</p>
    </div>
  </div>

  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#material-and-method" id="toc-material-and-method" class="nav-link" data-scroll-target="#material-and-method"><span class="header-section-number">2</span> Material and Method</a>
  <ul class="collapse">
  <li><a href="#desciption-of-the-data" id="toc-desciption-of-the-data" class="nav-link" data-scroll-target="#desciption-of-the-data"><span class="header-section-number">2.1</span> Desciption of the data</a></li>
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model"><span class="header-section-number">2.2</span> Model</a>
  <ul class="collapse">
  <li><a href="#specification" id="toc-specification" class="nav-link" data-scroll-target="#specification"><span class="header-section-number">2.2.1</span> Specification</a></li>
  <li><a href="#inference-on-real-data" id="toc-inference-on-real-data" class="nav-link" data-scroll-target="#inference-on-real-data"><span class="header-section-number">2.2.2</span> Inference on real data</a></li>
  <li><a href="#simulations" id="toc-simulations" class="nav-link" data-scroll-target="#simulations"><span class="header-section-number">2.2.3</span> Simulations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">3</span> Results</a>
  <ul class="collapse">
  <li><a href="#results-obtained-with-real-data" id="toc-results-obtained-with-real-data" class="nav-link" data-scroll-target="#results-obtained-with-real-data"><span class="header-section-number">3.1</span> Results obtained with real data</a>
  <ul class="collapse">
  <li><a href="#model-convergence-and-posterior-distributions" id="toc-model-convergence-and-posterior-distributions" class="nav-link" data-scroll-target="#model-convergence-and-posterior-distributions"><span class="header-section-number">3.1.1</span> Model convergence and posterior distributions</a></li>
  <li><a href="#estimated-values-of-pesticide-treatment-efficacies" id="toc-estimated-values-of-pesticide-treatment-efficacies" class="nav-link" data-scroll-target="#estimated-values-of-pesticide-treatment-efficacies"><span class="header-section-number">3.1.2</span> Estimated values of pesticide treatment efficacies</a></li>
  </ul></li>
  <li><a href="#results-obtained-by-simulation" id="toc-results-obtained-by-simulation" class="nav-link" data-scroll-target="#results-obtained-by-simulation"><span class="header-section-number">3.2</span> Results obtained by simulation</a>
  <ul class="collapse">
  <li><a href="#interest-of-combining-trials-with-prevalence-and-trials-with-intensity" id="toc-interest-of-combining-trials-with-prevalence-and-trials-with-intensity" class="nav-link" data-scroll-target="#interest-of-combining-trials-with-prevalence-and-trials-with-intensity"><span class="header-section-number">3.2.1</span> Interest of combining trials with prevalence and trials with intensity</a></li>
  <li><a href="#interest-of-adding-intensity-when-prevalence-is-measured-in-all-trials" id="toc-interest-of-adding-intensity-when-prevalence-is-measured-in-all-trials" class="nav-link" data-scroll-target="#interest-of-adding-intensity-when-prevalence-is-measured-in-all-trials"><span class="header-section-number">3.2.2</span> Interest of adding intensity when prevalence is measured in all trials</a></li>
  <li><a href="#is-it-better-to-measure-intensity-or-prevalence-in-new-pest-surveys" id="toc-is-it-better-to-measure-intensity-or-prevalence-in-new-pest-surveys" class="nav-link" data-scroll-target="#is-it-better-to-measure-intensity-or-prevalence-in-new-pest-surveys"><span class="header-section-number">3.2.3</span> Is it better to measure intensity or prevalence in new pest surveys?</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">4</span> Conclusion</a></li>
  <li><a href="#author-contributions" id="toc-author-contributions" class="nav-link" data-scroll-target="#author-contributions">Author contributions</a></li>
  <li><a href="#funding" id="toc-funding" class="nav-link" data-scroll-target="#funding">Funding</a></li>
  <li><a href="#data-availability" id="toc-data-availability" class="nav-link" data-scroll-target="#data-availability">Data availability</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements">Acknowledgements</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="submitted-202310-favrot-pest.pdf"><i class="bi bi-file-pdf"></i>PDF (computo)</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>In plant epidemiology, pest and disease presence can be measured in a host population using different metrics. A first metric measures the presence/absence of the pest in the individuals (plants) of the host population. This metric is often called prevalence or incidence (<span class="citation" data-cites="madden1999sampling">Madden and Hughes (<a href="#ref-madden1999sampling" role="doc-biblioref">1999</a>)</span>, <span class="citation" data-cites="shaw2018metrics">Shaw et al. (<a href="#ref-shaw2018metrics" role="doc-biblioref">2018</a>)</span>). The prevalence describes the proportion of the host population in which the pest is present. This metric is relevant and widely used, but it does not account for the number of pest individuals per host individual. With the prevalence, a plant infected by one single pest individual (e.g., an insect) and a plant infected by many pest individuals both represents one infected plant. For this reason, pest abundance is sometimes assessed using another metric representing the average number of pest individuals per host individual. This metric is called intensity or severity (<span class="citation" data-cites="madden1999sampling">Madden and Hughes (<a href="#ref-madden1999sampling" role="doc-biblioref">1999</a>)</span>, <span class="citation" data-cites="shaw2018metrics">Shaw et al. (<a href="#ref-shaw2018metrics" role="doc-biblioref">2018</a>)</span>), and describes the intensity of the disease in the target population. These two metrics do not generally have the same requirement in terms of working time; measuring intensity takes indeed much more time than measuring prevalence because it is very tedious to count all pest individuals, especially when individuals are small, numerous, and/or difficult to detect.</p>
<p>Pest prevalence and intensity are commonly measured in factorial field trials to test the efficacy of different treatments. In this paper, we place ourselves in an important application framework which is the evaluation of alternative pesticide treatments to neonicotinoids against aphids in sugar beet. Indeed, neonicotinoids had been a popular chemical treatment to control aphids for many years, especially in sugar beets, a major crop in Europe. Recently, neonicotinoids were recognized as presenting high risks for the environment with a negative impact on a wide range of non-target organisms, including bees (<span class="citation" data-cites="wood2017environmental">Wood and Goulson (<a href="#ref-wood2017environmental" role="doc-biblioref">2017</a>)</span>, <span class="citation" data-cites="pisa2015effects">Pisa et al. (<a href="#ref-pisa2015effects" role="doc-biblioref">2015</a>)</span>), and this familly of pesticides has been banned in several European countries. In order to find a substitute to neonicotinoids, a number of factorial field trials were conducted to compare the efficacy of different alternative treatments during several years in different countries. Each trial consists of a set of plots divided into several blocks, themselves divided into several strips on which different pesticide treatments are randomly allocated. One strip always remains untreated to serve as a control. In each strip, aphid prevalence, aphid intensity or both metrics are measured in a sample of plants (usually, 10-20 plants per strip). Depending on the protocol and on the working time constraint, either one type or both types of metrics are measured. Consequently, for a given pest treatment, some trials may report prevalence data while others report intensity data or both types of data. This heterogeneity raises several issues. A first issue concerns the statistical analysis of the trials reporting prevalence and intensity. Although it is easy to fit a generalized linear model to each type of data separately, it is less straightforward to fit a single model to the whole set of trials in order to obtain a single ranking of the pest treatements taking into account both types of data at the same time. Generally, factorial trials assessing treatment efficacy are analyzed with statistical models that take into account one of the two metrics but not both. Prevalence data are thus commonly analyzed using binomial generalized linear models and intensity data are frequently analyzed with Poisson generalized linear models (<span class="citation" data-cites="michel2017framework">Michel, Brun, and Makowski (<a href="#ref-michel2017framework" role="doc-biblioref">2017</a>)</span>, <span class="citation" data-cites="LAURENT2023106140">Laurent et al. (<a href="#ref-LAURENT2023106140" role="doc-biblioref">2023</a>)</span>, <span class="citation" data-cites="agresti2015foundations">Agresti (<a href="#ref-agresti2015foundations" role="doc-biblioref">2015</a>)</span>). As far as we know, no statistical model has been proposed to assess treatment efficacy based on the simultaneous analysis of prevalence and intensity data. In <span class="citation" data-cites="osiewalski2019joint">Osiewalski and Marzec (<a href="#ref-osiewalski2019joint" role="doc-biblioref">2019</a>)</span>, the authors introduced a switching model designed to handle two count variables, one of which may be degenerate. This model was employed to characterize the counts of cash payments and bank card payments in Poland, utilizing data from both cardholders and non-cardholders. A generalized form of the bivariate negative binomial regression model was developed in <span class="citation" data-cites="gurmu2000generalized">Gurmu and Elder (<a href="#ref-gurmu2000generalized" role="doc-biblioref">2000</a>)</span>, allowing for a more flexible representation of the correlation between the dependent variables. This model was applied to describe the number of visits to a doctor and the number of visits to non-doctor health professionals. It outperformed existing bivariate models across various model comparison criteria. In order to analyze data related to crash counts categorized by severity, <span class="citation" data-cites="park2007multivariate">Park and Lord (<a href="#ref-park2007multivariate" role="doc-biblioref">2007</a>)</span> employed a multivariate Poisson-lognormal model, effectively addressing both overdispersion and a fully generalized correlation structure within the dataset. However, it should be noted that these models did not include any binomial distribution and thus could not be used to deal with proportion data, such as pest prevalence. Another issue concerns the practical value of combining both prevalence and intensity data. It is unclear whether the simultaneous analysis of prevalence and intensity data may increase the accuracy of the estimated treatment efficacy compared to the use of a single type of data, and whether this may increase the probability of identifying the most efficient treatments. Finally, it is also unclear how future trials should be designed, in particular how many trials are required to obtain accurate estimations, and whether intensity data should be prefered to prevalence data.</p>
<p>In this paper, we propose a new flexible statistical model that can be used to rank pest treatments from trials including prevalence data, intensity data, or both. We apply it to a real dataset including trials testing the efficacy of pesticides against aphids infesting sugar beets, considering contrasted scenarios of data availability, and we show how the proposed model can be used to evaluate the efficacy of different treatments. Based on simulations, we then quantify the reduction of mean absolute errors in the estimated treatment efficacies resulting from the use of both prevalence and intensity data during the statistical inference, compared to the use of exclusively either prevalence or intensity data. The rest of the paper is organized as follows. First, we present the structure of the dataset including real prevalence and intensity data. Next, we describe in detail the proposed model, the inference method, and the simulation strategy. After checking the convergence of the fitting algorithm, we show how the model can be used to assess treatement efficacy. We finally present the results based on simulated data and we make several recommendations.</p>
</section>
<section id="material-and-method" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Material and Method</h1>
<section id="desciption-of-the-data" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="desciption-of-the-data"><span class="header-section-number">2.1</span> Desciption of the data</h2>
<p>Data were collected in 32 field trials conducted in France, Belgium and the Netherlands to compare several treatments against aphids in sugar beets. Each trial consists in a plot located in a given site at a given year (site-year) divided into one to four blocks. Each of these blocks is itself divided into strips where different treatments are tested, one of these treatments being an untreated control and the others corresponding to different types of insecticide. In each strip of each block, the number of aphids was counted on a sample of 10 beet plants (intensity). The number of infested plants (prevalence) was measured as well, but only in 15 trials out of 32. The total numbers of intensity and prevalence data are equal to 1128 and 561, respectively. Note that the number of aphids was not counted on each beet plant but in the whole plant sample. Intensity and prevalence were monitored at different times after treatments. As shown in <a href="#fig-one" class="quarto-xref">Figure&nbsp;1</a> A, the dataset is unbalanced as less data are available for the treatment Mavrik-jet compared to the others. Figure 1B shows that the intensity and prevalence tend to increase with time.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-one" class="quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-one-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="submitted-202310-favrot-pest_files/figure-html/fig-one-1.svg" class="img-fluid figure-img">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-one-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Description of the dataset. <strong>A</strong> Number of observations according to the type of insecticide. <strong>B</strong> Examples of observed number of aphids averaged over the blocks (intensity) and number of infested beets out of ten (prevalence) averaged over the blocks, at different dates for two trials.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="model" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="model"><span class="header-section-number">2.2</span> Model</h2>
<section id="specification" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="specification"><span class="header-section-number">2.2.1</span> Specification</h3>
<p>We introduce an unobserved variable representing the number of pest individuals (here, aphids) on each plant in a sample of <span class="math inline">N</span> plants (here, sugar beets). This variable is noted <span class="math inline">W</span> and is assumed to follow a Poisson probability distribution whose mean value is a function of time.</p>
<p>We use the following indexes: <span class="math inline">i</span> for the trial, <span class="math inline">j</span> for the treatment, <span class="math inline">k</span> for the block, <span class="math inline">t</span> for the time and <span class="math inline">s</span> for the plant number. The distribution of <span class="math inline">W_{ijkts}</span> is defined as:</p>
<p><span id="eq-model_W"><span class="math display">
    W_{ijkts}\sim\mathcal{P}(\lambda_{ijkt})
\tag{1}</span></span></p>
<p><span id="eq-model_lambda"><span class="math display">
    \log\ \lambda_{ijkt} = \alpha_0 + \beta_{0i} + \gamma_{0j}  + (\alpha_1 + \gamma_{1j})\ X_t + u_{ij} + \epsilon_{ijkt}
\tag{2}</span></span></p>
<p>with</p>
<ul>
<li><span class="math inline">\beta_{0i}\sim\mathcal{N}(0, \sigma_0^2)</span></li>
<li><span class="math inline">u_{ij}\sim\mathcal{N}(0, \chi^2)</span></li>
<li><span class="math inline">\epsilon_{ijkt}\sim\mathcal{N}(0,\eta^2)</span></li>
</ul>
<p>The random variables are all assumed independent. The parameters <span class="math inline">\alpha_0</span>, <span class="math inline">\alpha_1</span>, <span class="math inline">\gamma_{0j}</span>, and <span class="math inline">\gamma_{1j}</span> are considered as fixed. This model serves as a tool for conducting inference on a population of trials, from which the subset of trials comprising our dataset is assumed to constitute a random sample. In essence, the trials contained within our database are leveraged to estimate the parameter values that characterize a target population, where the tested pest control treatments will be actually implemented. Consequently, all parameters contingent on individual trials have been defined as random effects.</p>
<p>The observed variables (intensity and prevalence) can be expressed as a function of <span class="math inline">W</span>. We note:</p>
<ul>
<li><span class="math inline">Y_{ijkt}</span> the number of pest individuals (aphids) in the sample of <span class="math inline">N_i</span> plants collected in trial i, treatment j, block k, at time t</li>
<li><span class="math inline">Z_{ijkt}</span> the number of infested plants among the <span class="math inline">N_i</span> plants collected in trial i, treatment j, block k, at time t</li>
</ul>
<p>Then, assuming the <span class="math inline">W</span>s are independent, we have:</p>
<p><span id="eq-model_Y"><span class="math display">
    Y_{ijkt} = \sum\limits_{s = 1}^{N_i} W_{ijkts}\ \hspace{1cm}\ Y_{ijkt} \sim \mathcal{P}(N_{i}\lambda_{ijkt})
\tag{3}</span></span></p>
<p><span id="eq-model_Z"><span class="math display">
    Z_{ijkt} = \sum\limits_{s = 1}^{N_i} \boldsymbol{1}_{W_{ijkts}&gt;0}\ \hspace{1cm} \ Z_{ijkt} \sim \mathcal{B}(N_{i},\ \pi_{ijkt})
\tag{4}</span></span></p>
<p>where <span class="math inline">\pi_{ijkt} = 1-\text{exp}(-\lambda_{ijkt})</span>. The different quantities used in the model are defined in Table 1.</p>
<table class="table">
<caption>Description of the indices, inputs and parameters used in the model</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 85%">
</colgroup>
<tbody>
<tr class="odd">
<td>i</td>
<td>trial index</td>
</tr>
<tr class="even">
<td>j</td>
<td>treatment index</td>
</tr>
<tr class="odd">
<td>k</td>
<td>block index</td>
</tr>
<tr class="even">
<td>t</td>
<td>time index</td>
</tr>
<tr class="odd">
<td>s</td>
<td>plant index</td>
</tr>
<tr class="even">
<td><span class="math inline">N_i</span></td>
<td>sample size (number of plants)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\lambda_{ijkt}</span></td>
<td>mean number of pest individuals (aphids) on one plant</td>
</tr>
<tr class="even">
<td><span class="math inline">\pi_{ijkt}</span></td>
<td>probability for a plant to be infested</td>
</tr>
<tr class="odd">
<td><span class="math inline">\alpha_0</span></td>
<td>mean number of pest individuals (aphids) in the untreated group</td>
</tr>
<tr class="even">
<td><span class="math inline">\beta_{0i}</span></td>
<td>trial effect</td>
</tr>
<tr class="odd">
<td><span class="math inline">\gamma_{0j}</span></td>
<td>effect of treatment j at time 0 (time of treatment)</td>
</tr>
<tr class="even">
<td><span class="math inline">\alpha_1</span></td>
<td>growth parameter of the number of pest individuals for the untreated group</td>
</tr>
<tr class="odd">
<td><span class="math inline">\gamma_{1j}</span></td>
<td>effect of the treatment on the time effect (interaction between treatment j and time)</td>
</tr>
<tr class="even">
<td><span class="math inline">X_t</span></td>
<td>number of days post treatment</td>
</tr>
<tr class="odd">
<td><span class="math inline">u_{ij}</span></td>
<td>random interaction between trial and treatment</td>
</tr>
<tr class="even">
<td><span class="math inline">\epsilon_{ijkt}</span></td>
<td>residuals</td>
</tr>
</tbody>
</table>
<p>From this model we defined the efficacy of the <span class="math inline">j</span>th treatment at time <span class="math inline">t</span> (<span class="math inline">t</span> days after pesticide application) by the quantity (<span class="citation" data-cites="LAURENT2023106140">Laurent et al. (<a href="#ref-LAURENT2023106140" role="doc-biblioref">2023</a>)</span>):</p>
<p><span id="eq-Efficacy"><span class="math display">
    \text{Ef}_{jt} = \Big(1 - \text{exp}\big(\gamma_{0j}+\gamma_{1j} \times X_{t}\big)\Big) \times 100
\tag{5}</span></span></p>
<p>The quantity <span class="math inline">\text{Ef}_{jt}</span> corresponds to the expected percentage reduction of pest individuals (aphid numbers) for the jth treatment compared to the untreated group, over trials and blocks.</p>
<p>Our Poisson log linear model includes an additive random dispersion term associated to each individual observation (<span class="math inline">\epsilon_{ijkt}</span> in <a href="#eq-model_lambda" class="quarto-xref">Equation&nbsp;2</a>). This is a standard and well-recognized approach to deal with over-dispersion (<span class="citation" data-cites="harrison2014using">Harrison (<a href="#ref-harrison2014using" role="doc-biblioref">2014</a>)</span>). In order to check the model assumptions, we performed a posterior predictive check of our model to check that the data were compatible with the model assumptions. Posterior predictive check is frequently used to look for systematic discrepancies between real and simulated data (<span class="citation" data-cites="gelman1995bayesian">Gelman et al. (<a href="#ref-gelman1995bayesian" role="doc-biblioref">1995</a>)</span>). To do so, we computed the probability of exceeding each individual data with the fitted model (<a href="#eq-model_lambda" class="quarto-xref">Equation&nbsp;2</a>). The computed probabilities were all falling in the range 0.22-0.93 (except for the observations equal to 0, for which the probability of being greater was equal to 1), and were thus not extreme. This result indicates that the model specified is not incompatible with the observed data and that the over-dispersion was correctly taken into account. In addition, we fitted another model including a negative binomial distribution instead of a Poisson distribution. The results were almost identical between the two models.</p>
</section>
<section id="inference-on-real-data" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="inference-on-real-data"><span class="header-section-number">2.2.2</span> Inference on real data</h3>
<p>The model parameters were estimated using Bayesian inference with a Markov chain Monte-Carlo method. We performed the inference using R, with the package rjags (<span class="citation" data-cites="rjags">Plummer (<a href="#ref-rjags" role="doc-biblioref">2022</a>)</span>). For each of the six dataset listed in Table 2, we fitted the model (<a href="#eq-model_lambda" class="quarto-xref">Equation&nbsp;2</a> - <a href="#eq-model_Z" class="quarto-xref">Equation&nbsp;4</a>) with the following weakly informative priors: <span class="math inline">\mathcal{N}(0, 10^3)</span> for the parameters <span class="math inline">\alpha_0,\ \gamma_0,\ \alpha_1,\ \gamma_1</span> and <span class="math inline">\mathcal{U}([0, 10])</span> for the parameters <span class="math inline">\sigma_0, \chi, \eta</span>. We used two Markov chains with <span class="math inline">2 \times 10^5</span> iterations (after an adaptating phase of <span class="math inline">10^5</span> iterations), and we centered the time variable <span class="math inline">t</span> to facilitate convergence.</p>
<p>The convergence of the MCMC algorithm was checked by inspecting the mixing of the two Markov chains and monitoring the Gelman-Rubin diagnosis statistics (<span class="citation" data-cites="gelman1992inference">Gelman and Rubin (<a href="#ref-gelman1992inference" role="doc-biblioref">1992</a>)</span>). We then computed the posterior mean of the pesticide treatment efficacy (defined by <a href="#eq-Efficacy" class="quarto-xref">Equation&nbsp;5</a>) as well as its 95% credibility interval. The code used to fit the model is provided below.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following code presents the inference on an extract of the real dataset, which includes both trials of figure 1B (2020 - B1A97 ; 2020 - u1CwE). It is a demo for the “50% Y - 50% Z” scenario and we set here the number of adaptation and iteration to 2000 in order to reduce computation time.</p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jags code for the model  #################################################</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>modelstringYZ <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="st">    model {</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">        # Likelihood #####################################################</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="st">        for (i in 1:Q){</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">            Y[i] ~ dpois(N[i] * lb[i])</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">            Z[i] ~ dbinom(pi[i], N[i])</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="st">            log(lb[i]) = beta0[ID[i]] + gamma0[INSEC[i]] + (alpha1 + </span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="st">                         gamma1[INSEC[i]]) * TIME[i] + u[ST[i]] + epsi[i]</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="st">            pi[i] = 1 - exp(- lb[i])</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="st">            epsi[i] ~ dnorm(0, pi_eps)</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="st">        for (j in 1:K){</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="st">            beta0[j] ~ dnorm(alpha0, tau0)</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="st">        for (c in 1:M){</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="st">            u[c] ~ dnorm(0, invchi)</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="st">        gamma0[1] = 0</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="st">        gamma1[1] = 0</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="st">        # Priors #########################################################</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="st">        for (s in 2:L){</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="st">            gamma0[s] ~ dnorm(0, 0.001)</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="st">            gamma1[s] ~ dnorm(0, 0.001)</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="st">        alpha0 ~ dnorm(0, 0.001)</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="st">        alpha1 ~ dnorm(0, 0.001)</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="st">        sigma0 ~ dunif(0, 10)</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="st">        chi ~ dunif(0, 10)</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="st">        eta ~ dunif(0, 10)</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="st">        # Derived Quantities #############################################</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="st">        tau0 = pow(sigma0, -2)</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="st">        invchi = pow(chi, -2)</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="st">        pi_eps = pow(eta, -2)</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="st">        for (h in 2:L){</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="st">            for(t in 1 : T){</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="st">                Eff[h, t]  = (1 - exp(gamma0[h] + gamma1[h] * </span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="st">                             TIME_unique[t])) * 100</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="st">        }  </span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelstringYZ, <span class="at">con  =</span>  <span class="st">"Files_for_code/modelYZ.txt"</span>)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Inference example on the extract of the real dataset #####################</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>real_data_extract <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"data/real_data_extract.rds"</span>)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> real_data_extract <span class="sc">%&gt;%</span> </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tscaled =</span> <span class="fu">scale</span>(DPT), <span class="at">st =</span> <span class="fu">paste</span>(ID, Insecticide))</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Building scenarios -------------------------------------------------------</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>scenarioY <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Z =</span> <span class="cn">NA</span>)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>scenarioYhalfZhalf <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">ifelse</span>(ID <span class="sc">==</span> <span class="st">"2020 - B1A97"</span>, Y, <span class="cn">NA</span>), </span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Z =</span> <span class="fu">ifelse</span>(ID <span class="sc">==</span> <span class="st">"2020 - B1A97"</span>, <span class="cn">NA</span>, Z))</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>scenarioYhalf <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ID <span class="sc">==</span> <span class="st">"2020 - B1A97"</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Z =</span> <span class="cn">NA</span>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>scenarioZhalf <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ID <span class="sc">==</span> <span class="st">"2020 - u1CwE"</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="cn">NA</span>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------------------------------------------------------</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> scenarioYhalfZhalf</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> data<span class="sc">$</span>Y;   Q <span class="ot">=</span> <span class="fu">length</span>(Y);   N <span class="ot">=</span> data<span class="sc">$</span>N;   Z <span class="ot">=</span> data<span class="sc">$</span>Z</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>ID <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">as.character</span>(data<span class="sc">$</span>ID)));   </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>INSEC <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">as.character</span>(data<span class="sc">$</span>Insecticide)));   </span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>TIME <span class="ot">=</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>tscaled);   </span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>ST <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">as.character</span>(data<span class="sc">$</span>st)));   </span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>K <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(ID));   L <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(INSEC));   </span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(ST));   </span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>df_TIME <span class="ot">=</span> <span class="fu">suppressMessages</span>(data <span class="sc">%&gt;%</span> </span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">group_by</span>(DPT, tscaled) <span class="sc">%&gt;%</span> </span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> as.data.frame)</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>TIME_unique <span class="ot">=</span> <span class="fu">approx</span>(df_TIME<span class="sc">$</span>DPT, df_TIME<span class="sc">$</span>tscaled, <span class="at">xout =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">12</span>))<span class="sc">$</span>y;   </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>T <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(TIME_unique))</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>data_jags <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Y"</span> <span class="ot">=</span> Y, <span class="st">"Z"</span> <span class="ot">=</span> Z, <span class="st">"Q"</span> <span class="ot">=</span>  Q, <span class="st">"ID"</span> <span class="ot">=</span> ID, <span class="st">"INSEC"</span> <span class="ot">=</span> INSEC, </span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  <span class="st">"TIME"</span> <span class="ot">=</span> TIME, <span class="st">"ST"</span> <span class="ot">=</span> ST, <span class="st">"K"</span> <span class="ot">=</span> K, <span class="st">"L"</span> <span class="ot">=</span> L, <span class="st">"M"</span> <span class="ot">=</span> M, </span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  <span class="st">"N"</span> <span class="ot">=</span> N, <span class="st">"T"</span> <span class="ot">=</span> T, <span class="st">"TIME_unique"</span> <span class="ot">=</span> TIME_unique</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>nadapt <span class="ot">=</span> <span class="dv">2000</span>;   niter <span class="ot">=</span> <span class="dv">2000</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">jags.model</span>(<span class="st">"Files_for_code/modelYZ.txt"</span>, <span class="at">data =</span> data_jags, </span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>                    <span class="at">n.chains =</span> <span class="dv">2</span>, <span class="at">n.adapt =</span> nadapt)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">coda.samples</span>(model, </span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable.names =</span> <span class="fu">c</span>(<span class="st">"gamma0"</span>, <span class="st">"gamma1"</span>, <span class="st">"Eff"</span>), </span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n.iter =</span> niter, <span class="at">thin =</span> <span class="dv">10</span>)</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br>
In practice, it is common that only <span class="math inline">Y</span> or <span class="math inline">Z</span> data are available in some of the trials. In this case, the resulting dataset includes observations of <span class="math inline">Y</span> in some trials and observations of <span class="math inline">Z</span> in others. The dataset may even include one type of observations only, either <span class="math inline">Y</span> or <span class="math inline">Z</span>, in all trials. Here, we define four scenarios with contrasted levels of <span class="math inline">Y</span> and <span class="math inline">Z</span> availability in order to evaluate the consequences of using different types of datasets. We consider four data subsets defined from the real dataset including trials with observations of <span class="math inline">Y</span>, with observations of <span class="math inline">Z</span>, or with both types of observation in different proportions (Table 2). The data subset “100% Y - 0% Z” includes Y data collected in the 32 trials. The data subset “50% Y - 0% Z” includes Y data collected in the 17 trials for which no Z observation is available. The data subset “0% Y - 50% Z” includes the Z data collected in the 15 trials for which Z observations are available. The data subset “50% Y - 50% Z” includes <span class="math inline">Y</span> data collected in 17 trials and <span class="math inline">Z</span> data collected in the other 15 trials. The latter data subset does not include any trial reporting both <span class="math inline">Y</span> and <span class="math inline">Z</span> data. Throughout our analysis, missing data were assumed to be missing at random.</p>
<p>The hierarchical model defined above is fitted to each dataset in turn. Each fitted model is then used to compute the posterior mean and 95% credibility interval of <span class="math inline">Ef_{jt}</span> for each treatment at <span class="math inline">t</span>=6 and 12 days after pesticide application.</p>
<table class="table">
<caption>Four data subsets defined from the original dataset (real data).</caption>
<colgroup>
<col style="width: 35%">
<col style="width: 65%">
</colgroup>
<thead>
<tr class="header">
<th>Type of dataset</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>100% Y - 0% Z</td>
<td style="text-align: left;">Y observations available in the 32 trials and no Z</td>
</tr>
<tr class="even">
<td>50% Y - 0% Z</td>
<td style="text-align: left;">Y observations available in 17 trials and no Z</td>
</tr>
<tr class="odd">
<td>0% Y - 50% Z</td>
<td style="text-align: left;">Z observations available in 15 trials and no Y</td>
</tr>
<tr class="even">
<td>50% Y - 50% Z</td>
<td style="text-align: left;">Y observations available in 17 trials and Z observations available in the other 15 trials</td>
</tr>
</tbody>
</table>
</section>
<section id="simulations" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="simulations"><span class="header-section-number">2.2.3</span> Simulations</h3>
<p>Simulations are carried out to further investigate the impact of the type and amount of data available on the accuracy of the parameters and the ability of the model to identify the most and least effective treatments.</p>
<p>We define three numbers of trials, equal to 20, 40 and 80, successively. For data simulations, the model parameters are set equal to those estimated from the real dataset “100% Y - 0% Z” defined in Table 2 (posterior means). For each number of trials, we generate virtual data from the model (<a href="#eq-model_W" class="quarto-xref">Equation&nbsp;1</a> - <a href="#eq-model_Z" class="quarto-xref">Equation&nbsp;4</a>) and estimate the model parameters, according to the following procedure:</p>
<ul>
<li>Draw values of <span class="math inline">\beta_{0i},\ u_{ij}</span> and <span class="math inline">\epsilon_{ijkt}</span> in their distributions for each trial, 3 treatments (+ the untreated control), 3 dates (<span class="math inline">t</span>=0, 6, 12), and 4 blocks</li>
<li>Calculate <span class="math inline">\lambda_{ijkt}</span> from <a href="#eq-model_lambda" class="quarto-xref">Equation&nbsp;2</a>,</li>
<li>Draw values of <span class="math inline">W_{ijkts}</span> in its Poisson distribution for 10 plants (<span class="math inline">s</span>=1, …, 10)</li>
<li>Calculate <span class="math inline">Y_{ijkt}</span> and <span class="math inline">Z_{ijkt}</span> from the Ws for each trial, treatment, date, block.</li>
<li>Generate the eight data subsets corresponding to the scenarios defined in Table 3 (including all values of <span class="math inline">W</span>, the generated values of <span class="math inline">Y</span> only, the generated values of <span class="math inline">Z</span> only, both <span class="math inline">Y</span> and <span class="math inline">Z</span> values but not <span class="math inline">W</span>, the values of <span class="math inline">Y</span> in 50% of the trials, the values of <span class="math inline">Z</span> in 50% of the trials, the values of <span class="math inline">Y</span> in 50% of the trials and the values of <span class="math inline">Z</span> in the other 50%),</li>
<li>Fit the model (<a href="#eq-model_W" class="quarto-xref">Equation&nbsp;1</a> - <a href="#eq-model_Z" class="quarto-xref">Equation&nbsp;4</a>) to each of the data subsets according to the procedure described above based on MCMC.</li>
</ul>
<p>At the end of this procedure, we get eight sets of estimated parameters, corresponding to the eight scenarios defined in Table 3. This procedure is repeated 1000 times with each time a different seed between 0 and 999. However, the computations performed with jags failed for 26 replicates and thus 974 replicates were available for the analysis.</p>
<p>For each number of trials and each scenario defined in Table 3, the accuracy of the estimated parameters <span class="math inline">\gamma</span> (from which depend the treatment efficacies) is evaluated by computing an absolute error, averaged over the three treatments (<span class="math inline">j</span>=1 corresponding to the control) as:</p>
<p><span id="eq-E_gamma"><span class="math display">
    E_{\gamma} = \frac{1}{2 \times 3}\sum\limits_{j = 2}^{4} \Big( \frac{|\gamma_{0j} - \hat{\gamma}_{0j}|}{|\gamma_{0j}|} + \frac{|\gamma_{1j} - \hat{\gamma}_{1j}|}{|\gamma_{1j}|}\Big)
\tag{6}</span></span></p>
<p>where the true parameter values are set equal to the posterior means computed with the real dataset, and the parameter estimates (<span class="math inline">\hat{\gamma}_{0j}</span> and <span class="math inline">\hat{\gamma}_{1j}</span>) are the posterior means computed for the jth treatment. For each trial number and each scenario defined in Table 3, the 974 values of <span class="math inline">E_{\gamma}</span> obtained for the 974 generated data subsets are then averaged. The average values obtained for the eight scenarios are finally compared to determine the type of data leading to the most accurate estimated parameter values.</p>
<p>In addition, we compare the eight scenarios according to another criterion measuring the difference between the estimated efficacy values and the true efficacy value (averaged over the three pesticide treatments considered), as follows:</p>
<p><span id="eq-E_efficacy"><span class="math display">
    E_{\text{Ef}_{t}}\ = \frac{1}{3} \sum\limits_{j = 2}^4 \frac{|\text{Ef}_{jt} - \hat{\text{Ef}}_{jt}|} {|\text{Ef}_{jt}|}
\tag{7}</span></span></p>
<p>where the true treatment efficacy is defined by <a href="#eq-Efficacy" class="quarto-xref">Equation&nbsp;5</a> (setting the parameters <span class="math inline">\gamma</span>s to the posterior means obtained with the real dataset) and the estimated efficacy (<span class="math inline">\hat{\text{Ef}}_{jt}</span>) is the posterior mean computed with the simulated dataset. The 974 values of <span class="math inline">E_{\text{Eft}}</span> obtained from the 974 simulated datasets are then averaged for each trial number and each scenario. Finally, we evaluate the proportions of cases where the true best treatment (i.e., the treatment with the highest efficacy) is correctly identified.</p>
<p>In order to determine whether the difference of performance obtained with the types of data <span class="math inline">Y</span> and <span class="math inline">Z</span> depends on the pest abundance, we perform an additional series of simulations with three values for the model parameter <span class="math inline">\alpha_0</span>, equal to <span class="math inline">-1,\ 1</span> and <span class="math inline">2</span>, successively. These three values of <span class="math inline">\alpha_0</span> define three contrasted levels of pest abundance (the higher <span class="math inline">\alpha_0</span>, the higher the abundance). We used the procedure outlined above considering only two scenarios of data availability, namely “100% Y - 0% Z” and “0% Y - 100% Z”. This procedure is implemented with each value of <span class="math inline">\alpha_0</span> in turn. The results are used to compare the model performances using either <span class="math inline">Y</span> or <span class="math inline">Z</span> for parameter estimation, depending of the pest abundance specified by <span class="math inline">\alpha_0</span>.</p>
<table class="table">
<caption>Eight scenarios compared using simulated data.</caption>
<colgroup>
<col style="width: 35%">
<col style="width: 65%">
</colgroup>
<thead>
<tr class="header">
<th>Type of dataset</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>100% W</td>
<td>W observations available in all the trials</td>
</tr>
<tr class="even">
<td>100% Y - 0% Z</td>
<td>Y observations available in all the trials</td>
</tr>
<tr class="odd">
<td>0% Y - 100% Z</td>
<td>Z observations available in all the trials</td>
</tr>
<tr class="even">
<td>100% Y - 100% Z</td>
<td>Y and Z observations available in all the trials</td>
</tr>
<tr class="odd">
<td>50% Y - 0% Z</td>
<td>Y observations available in half of the trials</td>
</tr>
<tr class="even">
<td>0% Y - 50% Z</td>
<td>Z observations available in half of the trials</td>
</tr>
<tr class="odd">
<td>50% Y - 50% Z</td>
<td>Y observations available in half of the trials and Z observations available in the other half of the trials</td>
</tr>
<tr class="even">
<td>50% Y - 100% Z</td>
<td>Y observations available in half of the trials and Z observations available in all the trials</td>
</tr>
</tbody>
</table>
<p>These simulations required a significant amount of computation time and were conducted on the INRAE MIGALE server. For a single seed and 20 trials, the computations took 80 minutes on a computer with an Intel Core i7 processor running at 1.90 GHz and 32 GB of RAM. The code used to perform them is presented below.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>simu_data <span class="ot">&lt;-</span> <span class="cf">function</span>(seed, I){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">set.seed</span>(seed)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a> ID <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> I);   </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a> data <span class="ot">=</span> <span class="fu">expand_grid</span>(<span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> I),   <span class="at">Block =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> K),   <span class="at">Band =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> J), </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Beet =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> N),   <span class="at">DPT =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="at">length.out =</span> T))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a> data <span class="ot">=</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Insecticide =</span> <span class="fu">ifelse</span>(DPT <span class="sc">&lt;=</span> <span class="dv">0</span>, <span class="st">"T 1"</span>, <span class="fu">paste</span>(<span class="st">"T"</span>, Band)),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">tscaled =</span> <span class="fu">scale</span>(data<span class="sc">$</span>DPT)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st =</span> <span class="fu">paste</span>(ID, Insecticide), </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">sbit =</span> <span class="fu">paste</span>(ID, Block, Insecticide, DPT))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a> Insecticide <span class="ot">=</span> data<span class="sc">$</span>Insecticide <span class="sc">%&gt;%</span> unique <span class="sc">%&gt;%</span> sort</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(gamma0) <span class="ot">=</span> Insecticide</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(gamma1) <span class="ot">=</span> Insecticide</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a> beta0 <span class="ot">=</span> <span class="fu">rnorm</span>(I, <span class="at">sd =</span> sig0);   </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a> u <span class="ot">=</span> <span class="fu">rnorm</span>(I <span class="sc">*</span> J, <span class="at">sd =</span> chi);   </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a> epsi <span class="ot">=</span> <span class="fu">rnorm</span>(I <span class="sc">*</span> J <span class="sc">*</span> K <span class="sc">*</span> (T <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> I <span class="sc">*</span> K, <span class="at">sd =</span> eta);   </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(beta0) <span class="ot">=</span> data<span class="sc">$</span>ID <span class="sc">%&gt;%</span> unique;   </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(u) <span class="ot">=</span> data<span class="sc">$</span>st <span class="sc">%&gt;%</span> unique</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(epsi) <span class="ot">=</span> data<span class="sc">$</span>sbit <span class="sc">%&gt;%</span> unique</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a> data <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">alpha0 =</span> alpha0,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                        <span class="at">alpha1 =</span> alpha1,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                        <span class="at">N =</span> N,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                        <span class="at">beta0 =</span> <span class="fu">recode</span>(ID, <span class="sc">!!!</span>beta0),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>                        <span class="at">gamma0 =</span> <span class="fu">recode</span>(Insecticide, <span class="sc">!!!</span>gamma0), </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>                        <span class="at">gamma1 =</span> <span class="fu">recode</span>(Insecticide, <span class="sc">!!!</span>gamma1),</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>                        <span class="at">u =</span> <span class="fu">recode</span>(st, <span class="sc">!!!</span>u),</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>                        <span class="at">epsi =</span> <span class="fu">recode</span>(sbit, <span class="sc">!!!</span>epsi))</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a> data<span class="sc">$</span>lb <span class="ot">=</span> <span class="fu">exp</span>(data<span class="sc">$</span>alpha0 <span class="sc">+</span> data<span class="sc">$</span>beta0 <span class="sc">+</span> data<span class="sc">$</span>gamma0 <span class="sc">+</span> (data<span class="sc">$</span>alpha1 <span class="sc">+</span> </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>                                                          data<span class="sc">$</span>gamma1) <span class="sc">*</span> data<span class="sc">$</span>tscaled <span class="sc">+</span> data<span class="sc">$</span>u <span class="sc">+</span> data<span class="sc">$</span>epsi)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a> data<span class="sc">$</span>W <span class="ot">=</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> (I <span class="sc">*</span> J <span class="sc">*</span> K <span class="sc">*</span> T <span class="sc">*</span> N)), </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(x) <span class="fu">rpois</span>(<span class="dv">1</span>, data<span class="sc">$</span>lb[x]))</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a> dataYZ <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID, Block, Band, DPT) <span class="sc">%&gt;%</span> </span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Insecticide =</span> <span class="fu">unique</span>(Insecticide), </span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">tscaled =</span> <span class="fu">unique</span>(tscaled), <span class="at">st =</span> <span class="fu">unique</span>(st), <span class="at">N =</span> <span class="fu">unique</span>(N), </span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">Y =</span> <span class="fu">sum</span>(W), <span class="at">Z =</span> <span class="fu">sum</span>(W <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> as.data.frame </span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a> dataW <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span> alpha0, <span class="sc">-</span> alpha1, <span class="sc">-</span> beta0, <span class="sc">-</span> gamma0, <span class="sc">-</span> gamma1, </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">-</span> u, <span class="sc">-</span> epsi, <span class="sc">-</span> lb)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">"dataYZ"</span> <span class="ot">=</span> dataYZ, <span class="st">"dataW"</span> <span class="ot">=</span> dataW))</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>}                        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br>
</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following code presents the inference for one seed. As the computing time is growing fast with the number of trials and the number of sampled values, we set here the number of trials to 10 (I = 10) and the number of adaptations and iterations to 2000.</p>
<p>Our simulation results are obtained by running this code for I = 10, 20, 40, 80, for all seeds between 0 and 999, with a number of adaptations and iterations equal to 36000.</p>
<p>Scenarios “50% Y - 0% Z” and “0% Y - 50% Z” are obtained from scenarios “100% Y - 0% Z” and “0% Y - 100% Z”, respectively. For example “50% Y - 0% Z” scenario with 40 trials corresponds to “100% Y - 0% Z” with 20 trials.</p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>J <span class="ot">=</span> <span class="dv">4</span>;   T <span class="ot">=</span> <span class="dv">3</span>;   N <span class="ot">=</span> <span class="dv">10</span>;   K <span class="ot">=</span> <span class="dv">4</span>;</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Block <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> K);   Band <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> J);   </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Beet <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> N);   DPT <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="at">length.out =</span> T);     </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>alpha0 <span class="ot">=</span> <span class="fl">0.5</span>;   gamma0 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span> <span class="fl">0.13</span>, <span class="sc">-</span> <span class="fl">1.13</span>, <span class="sc">-</span> <span class="fl">1.24</span>);       </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>alpha1 <span class="ot">=</span> <span class="fl">0.16</span>;   gamma1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.24</span>, <span class="sc">-</span> <span class="fl">0.14</span>, <span class="sc">-</span> <span class="fl">0.15</span>);</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>sig0 <span class="ot">=</span> <span class="fl">1.87</span>;   chi <span class="ot">=</span> <span class="fl">0.27</span>;   eta <span class="ot">=</span> <span class="fl">0.98</span>      </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Building scenarios #######################################################</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>seed <span class="ot">=</span> <span class="dv">1</span>;   I <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">suppressMessages</span>(<span class="fu">simu_data</span>(<span class="at">seed =</span> seed, <span class="at">I =</span> I))</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>scenarios <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> data<span class="sc">$</span>dataYZ <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Z =</span> <span class="cn">NA</span>),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Z =</span> data<span class="sc">$</span>dataYZ <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="cn">NA</span>),</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">YhalfZhalf =</span> data<span class="sc">$</span>dataYZ <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">ifelse</span>(ID <span class="sc">&lt;=</span> (I <span class="sc">/</span> <span class="dv">2</span>), <span class="cn">NA</span>, Y), </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">Z =</span> <span class="fu">ifelse</span>(ID <span class="sc">&gt;</span> (I <span class="sc">/</span> <span class="dv">2</span>), <span class="cn">NA</span>, Z)),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">YhalfZ =</span> data<span class="sc">$</span>dataYZ <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">ifelse</span>(ID <span class="sc">&lt;=</span> (I <span class="sc">/</span> <span class="dv">2</span>), <span class="cn">NA</span>, Y)),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">YZ =</span> data<span class="sc">$</span>dataYZ,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">W =</span> data<span class="sc">$</span>dataW</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Inference #################################################################</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>nadapt <span class="ot">=</span> <span class="dv">2000</span>;   niter <span class="ot">=</span> <span class="dv">2000</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>res_inf <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Inference YZ --------------------------------------------------------------</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>ID <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">as.character</span>(scenarios<span class="sc">$</span>Y<span class="sc">$</span>ID)));   </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>INSEC <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">as.character</span>(scenarios<span class="sc">$</span>Y<span class="sc">$</span>Insecticide)));   </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>TIME <span class="ot">=</span> <span class="fu">as.numeric</span>(scenarios<span class="sc">$</span>Y<span class="sc">$</span>tscaled);   </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>ST <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">as.character</span>(scenarios<span class="sc">$</span>Y<span class="sc">$</span>st)));</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>K <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(ID));   </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(INSEC));   </span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(ST))</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>TIME_unique <span class="ot">=</span> <span class="fu">unique</span>(scenarios<span class="sc">$</span>Y<span class="sc">$</span>tscaled)[<span class="dv">2</span> <span class="sc">:</span> <span class="dv">3</span>]  </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>T <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(TIME_unique))</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> (<span class="dv">1</span> <span class="sc">:</span> <span class="dv">5</span>)){</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">=</span> scenarios[[i]]<span class="sc">$</span>Y;   Z <span class="ot">=</span> scenarios[[i]]<span class="sc">$</span>Z;   </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> scenarios[[i]]<span class="sc">$</span>N;   Q <span class="ot">=</span> <span class="fu">length</span>(Y)   </span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  data_jags <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Y"</span> <span class="ot">=</span> Y, <span class="st">"Z"</span> <span class="ot">=</span> Z, <span class="st">"Q"</span> <span class="ot">=</span>  Q, <span class="st">"ID"</span> <span class="ot">=</span> ID, <span class="st">"INSEC"</span> <span class="ot">=</span> INSEC, </span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"TIME"</span> <span class="ot">=</span> TIME, <span class="st">"ST"</span> <span class="ot">=</span> ST, <span class="st">"K"</span> <span class="ot">=</span> K, <span class="st">"L"</span> <span class="ot">=</span> L, <span class="st">"M"</span> <span class="ot">=</span> M, </span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"N"</span> <span class="ot">=</span> N, <span class="st">"T"</span> <span class="ot">=</span> T, <span class="st">"TIME_unique"</span> <span class="ot">=</span> TIME_unique</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">jags.model</span>(<span class="st">"Files_for_code/modelYZ.txt"</span>, <span class="at">data =</span> data_jags, </span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n.chains =</span> <span class="dv">2</span>, <span class="at">n.adapt =</span> nadapt)</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">coda.samples</span>(model, </span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>                          <span class="at">variable.names =</span> <span class="fu">c</span>(<span class="st">"gamma0"</span>, <span class="st">"gamma1"</span>, <span class="st">"Eff"</span>), </span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>                          <span class="at">n.iter =</span> niter, <span class="at">thin =</span> <span class="dv">10</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  bind <span class="ot">=</span> <span class="fu">list</span>(samples);   </span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(bind) <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">"samples"</span>, <span class="fu">names</span>(scenarios)[i], <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  res_inf <span class="ot">=</span> res_inf <span class="sc">%&gt;%</span> <span class="fu">append</span>(bind)</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Inference W ---------------------------------------------------------------</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>ID <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">as.character</span>(scenarios<span class="sc">$</span>W<span class="sc">$</span>ID)));   </span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>INSEC <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">as.character</span>(scenarios<span class="sc">$</span>W<span class="sc">$</span>Insecticide)));   </span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>TIME <span class="ot">=</span> <span class="fu">as.numeric</span>(scenarios<span class="sc">$</span>W<span class="sc">$</span>tscaled);   </span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>ST <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">as.character</span>(scenarios<span class="sc">$</span>W<span class="sc">$</span>st)));</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>SBIT <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">as.character</span>(scenarios<span class="sc">$</span>W<span class="sc">$</span>sbit)))</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>K <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(ID));   L <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(INSEC));   </span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(ST));   X <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(SBIT))</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>TIME_unique <span class="ot">=</span> <span class="fu">unique</span>(scenarios<span class="sc">$</span>W<span class="sc">$</span>tscaled)[<span class="dv">2</span> <span class="sc">:</span> <span class="dv">3</span>]  </span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>T <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(TIME_unique))</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>W <span class="ot">=</span> scenarios<span class="sc">$</span>W<span class="sc">$</span>W;   Q <span class="ot">=</span> <span class="fu">length</span>(W)</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>data_jags <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>  <span class="st">"W"</span> <span class="ot">=</span> W, <span class="st">"Q"</span> <span class="ot">=</span>  Q, <span class="st">"ID"</span> <span class="ot">=</span> ID, <span class="st">"INSEC"</span> <span class="ot">=</span> INSEC, </span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>  <span class="st">"TIME"</span> <span class="ot">=</span> TIME, <span class="st">"ST"</span> <span class="ot">=</span> ST,  <span class="st">"SBIT"</span> <span class="ot">=</span> SBIT, <span class="st">"K"</span> <span class="ot">=</span> K, <span class="st">"L"</span> <span class="ot">=</span> L, </span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>  <span class="st">"M"</span> <span class="ot">=</span> M, <span class="st">"X"</span> <span class="ot">=</span> X, <span class="st">"T"</span> <span class="ot">=</span> T, <span class="st">"TIME_unique"</span> <span class="ot">=</span> TIME_unique</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">jags.model</span>(<span class="st">"Files_for_code/modelW.txt"</span>, <span class="at">data =</span> data_jags, </span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>                    <span class="at">n.chains =</span> <span class="dv">2</span>, <span class="at">n.adapt =</span> nadapt)</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">coda.samples</span>(model, </span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable.names =</span> <span class="fu">c</span>(<span class="st">"gamma0"</span>, <span class="st">"gamma1"</span>, <span class="st">"Eff"</span>), </span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n.iter =</span> niter, <span class="at">thin =</span> <span class="dv">10</span>)</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>res_inf <span class="ot">=</span> res_inf <span class="sc">%&gt;%</span> <span class="fu">append</span>(<span class="fu">list</span>(<span class="st">"samples_W"</span> <span class="ot">=</span> samples))</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Formatting results #######################################################</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> scenarios<span class="sc">$</span>Y<span class="sc">$</span>tscaled <span class="sc">%&gt;%</span> unique</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>Eff_6_true <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(gamma0[<span class="dv">2</span> <span class="sc">:</span> J] <span class="sc">+</span> gamma1[<span class="dv">2</span> <span class="sc">:</span> J] <span class="sc">*</span> t[<span class="dv">2</span>])) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>Eff_12_true <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(gamma0[<span class="dv">2</span> <span class="sc">:</span> J] <span class="sc">+</span> gamma1[<span class="dv">2</span> <span class="sc">:</span> J] <span class="sc">*</span> t[<span class="dv">3</span>])) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>truth <span class="ot">=</span> <span class="fu">c</span>(Eff_6_true, Eff_12_true, gamma0[<span class="dv">2</span> <span class="sc">:</span> J], gamma1[<span class="dv">2</span> <span class="sc">:</span> J])</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>n_scenarios <span class="ot">=</span> <span class="fu">length</span>(scenarios)</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>esti <span class="ot">=</span> <span class="fu">lapply</span>(</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>  res_inf, <span class="cf">function</span>(x) <span class="fu">summary</span>(x)<span class="sc">$</span>statistics <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span> </span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>    rownames_to_column <span class="sc">%&gt;%</span> </span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"gamma"</span>, rowname) <span class="sc">&amp;</span> Mean <span class="sc">==</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Mean) <span class="sc">%&gt;%</span> as.matrix <span class="sc">%&gt;%</span> as.vector</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>)    </span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>b_inf <span class="ot">=</span> <span class="fu">lapply</span>(</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>  res_inf, <span class="cf">function</span>(x) <span class="fu">summary</span>(x)<span class="sc">$</span>quantiles <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span> </span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>    rownames_to_column <span class="sc">%&gt;%</span> </span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"gamma"</span>, rowname) <span class="sc">&amp;</span> <span class="st">`</span><span class="at">2.5%</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="st">`</span><span class="at">2.5%</span><span class="st">`</span>) <span class="sc">%&gt;%</span> as.matrix <span class="sc">%&gt;%</span> as.vector</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>)    </span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>b_sup <span class="ot">=</span> <span class="fu">lapply</span>(</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>  res_inf, <span class="cf">function</span>(x) <span class="fu">summary</span>(x)<span class="sc">$</span>quantiles <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span> </span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>    rownames_to_column <span class="sc">%&gt;%</span> </span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"gamma"</span>, rowname) <span class="sc">&amp;</span> <span class="st">`</span><span class="at">2.5%</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="st">`</span><span class="at">97.5%</span><span class="st">`</span>) <span class="sc">%&gt;%</span> as.matrix <span class="sc">%&gt;%</span> as.vector</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>)    </span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">=</span> <span class="fu">summary</span>(res_inf[[<span class="dv">1</span>]])<span class="sc">$</span>statistics <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span> </span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>  rownames_to_column <span class="sc">%&gt;%</span> </span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"gamma"</span>, rowname) <span class="sc">&amp;</span> Mean <span class="sc">==</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rowname) <span class="sc">%&gt;%</span> as.matrix <span class="sc">%&gt;%</span> as.vector   </span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">do.call</span>(rbind, </span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>              <span class="fu">lapply</span>(<span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> n_scenarios), </span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">function</span>(x) </span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">data.frame</span>(<span class="at">Truth =</span> truth, <span class="at">Scenario =</span> <span class="fu">names</span>(scenarios)[x], </span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">I =</span> I, <span class="at">seed =</span> seed, </span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">value =</span> esti[[x]], <span class="at">parameters =</span> parameters, </span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">b_inf =</span> b_inf[[x]], <span class="at">b_sup =</span> b_sup[[x]]</span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Results</h1>
<section id="results-obtained-with-real-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="results-obtained-with-real-data"><span class="header-section-number">3.1</span> Results obtained with real data</h2>
<p>We present here the results obtained with real data. First, we check the convergence of the model for the scenarios defined in Table 2. We then compare the estimated values and the credibility intervals of the treatment efficacy obtained in the different scenarios.</p>
<section id="model-convergence-and-posterior-distributions" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="model-convergence-and-posterior-distributions"><span class="header-section-number">3.1.1</span> Model convergence and posterior distributions</h3>
<p><a href="#fig-two" class="quarto-xref">Figure&nbsp;2</a> presents the Markov chains associated with the model parameters and treatment efficacies for the different scenarios. The x-axis presents the iteration number and the y-axis presents the sampled value. Results show that the chains are well mixed. <a href="#fig-three" class="quarto-xref">Figure&nbsp;3</a> presents the Gelman-Rubin statistics associated with the model parameters and treatement efficacies as a function of the iterations, for the different scenarios. We observe that this statistics converges to 1, which indicates the convergence of the algorithm.</p>
<p>Table 4 gives a summary of the posterior distributions of the model parameters and treatment efficacies obtained for the “100% Y - 0% Z” scenario. The significantly positive value of <span class="math inline">\alpha_1</span> indicates that the aphid numbers tend to increase with time in untreated plots. The relatively high value of <span class="math inline">\sigma_0</span> (posterior mean equal to 1.87) reveals a strong variability in aphid numbers between trials. The posterior mean value of <span class="math inline">\chi</span> (0.27) suggests that the treatment efficacy varies across trials. The <span class="math inline">\gamma_0</span> parameter is negative for all three treatments, indicating a negative effect of the treatments on the aphid numbers at the time of pesticide spray. The Movento and Teppeki treatments have a similar effect with a posterior mean for <span class="math inline">\gamma_0</span> equal to -1.13 and -1.24, and a standard deviation equal to 0.12 and 0.11, respectively. The effect of treatment Mavrik Jet is weaker as its posterior mean for <span class="math inline">\gamma_0</span> is equal to -0.13 and its standard deviation is equal to 0.16. The <span class="math inline">\gamma_1</span> posterior means are negative for Movento and Teppeki (-0.14 and -0.15), suggesting that the effect of these treatments tend to increase with time, but the posterior mean value is positive for Mavrik Jet (= 0.24), suggesting that the effect of this treatment may decrease with time. However, the 95% credibility intervals of <span class="math inline">\gamma_1</span> include zero and these parameters are not very accurately estimated.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-two" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-two-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="submitted-202310-favrot-pest_files/figure-html/fig-two-1.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-two-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Model convergence - Markov chain for the model parameters and treatment efficacies, in the scenarios ‘50% Y - 0% Z’ (<strong>A</strong>), ‘50% Y - 50% Z’ (<strong>B</strong>), ‘100% Y - 0% Z’ (<strong>C</strong>) and ‘0% Y - 50% Z’ (<strong>D</strong>). The x-axis presents the iteration number and the y-axis presents the sampled value.
</figcaption>
</figure>
</div>
</div>
</div>
<p><br>
</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-three" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-three-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="submitted-202310-favrot-pest_files/figure-html/fig-three-1.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-three-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Model convergence - Gelman-Rubin statistics for the parameters of the model (<a href="#eq-model_W" class="quarto-xref">Equation&nbsp;1</a> - <a href="#eq-model_Z" class="quarto-xref">Equation&nbsp;4</a>) and for treatment efficacies (<a href="#eq-Efficacy" class="quarto-xref">Equation&nbsp;5</a>), according to the scenarios ‘50% Y - 0% Z’ (<strong>A</strong>), ‘50% Y - 50% Z’ (<strong>B</strong>), ‘100% Y - 0% Z’ (<strong>C</strong>) and ‘0% Y - 50% Z’ (<strong>D</strong>). The x-axis presents the iteration number and the y-axis presents the Gelman-Rubin statistic.
</figcaption>
</figure>
</div>
</div>
</div>
<p><br>
</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Summary of the posterior distributions obtained with the 100\% Y - 0\% Z scenario for the model parameters and treatment efficacies: posterior mean, standard deviation, 2.5 and 97.5 quantiles.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Parameter</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5%</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">α₀</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">1.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">α₁</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">σ₀</td>
<td style="text-align: right;">1.87</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">2.46</td>
</tr>
<tr class="even">
<td style="text-align: left;">χ</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">η</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">1.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">γ₀ - untreated</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">γ₀ - Mavrik Jet</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">-0.46</td>
<td style="text-align: right;">0.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">γ₀ - Movento</td>
<td style="text-align: right;">-1.13</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-1.37</td>
<td style="text-align: right;">-0.88</td>
</tr>
<tr class="odd">
<td style="text-align: left;">γ₀ - Teppeki</td>
<td style="text-align: right;">-1.24</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-1.46</td>
<td style="text-align: right;">-1.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">γ₁ - untreated</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">γ₁ - Mavrik Jet</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">γ₁ - Movento</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">γ₁ - Teppeki</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">-0.32</td>
<td style="text-align: right;">0.02</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="estimated-values-of-pesticide-treatment-efficacies" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="estimated-values-of-pesticide-treatment-efficacies"><span class="header-section-number">3.1.2</span> Estimated values of pesticide treatment efficacies</h3>
<p><a href="#fig-four" class="quarto-xref">Figure&nbsp;4</a> presents the posterior means and the 95% credibility intervals of treatment efficacies at 6 days (A) and 12 days (B) after pesticide spray, for the “100% Y - 0% Z”, “50% Y - 50% Z”, “50% Y - 0% Z” and “0% Y - 50% Z” scenarios. Different scenarios are indicated by different colors. The x-axis presents the efficacy and the y-axis presents the treatments. Overall, the results obtained are consistent across scenarios; Teppeki and Movento show higher mean efficacies than Mavrik Jet, and the credibility intervals are narrower for Teppeki and Movento than for Mavrik Jet in all scenarios. The credibility interval of the “100% Y - 0% Z” scenario is narrower than that of the “50% Y - 50% Z” scenario, which is itself narrower than that of the “50% Y - 0% Z” and “0% Y - 50% Z” scenarios. Table 5 quantifies the differences in the sizes of the credibility intervals and present the reduction percentage in the credibility interval sizes of the “100% Y - 0% Z”, “50% Y - 50% Z” and “0% Y - 50% Z” scenarios, compared to the “50% Y - 0% Z” scenario, for all the treatment efficacies at 6 days (third column) and at 12 days (fourth column) after pesticide spray. A positive (negative) value corresponds to an increase (decrease) of the credibility interval size compared to “50% Y - 0% Z”. For example, the credibility interval size obtained for the efficacy of Movento at 6 days is 40.5% smaller with the “100% Y - 0% Z” scenario than with the “50% Y - 0% Z” scenario. Overall, the credibility interval sizes obtained with the “100% Y - 0% Z” scenario are 25 to 45% smaller than those obtained with the “50% Y - 0% Z” scenario. This indicates that the accuracy of the estimated treatment efficacies is improved by doubling the number of Y observations. Results show that the credibility intervals are often larger with “0% Y - 50% Z” than with “50% Y - 0% Z”, suggesting that better esimtations are obtained using Y than Z when only a limited number of data is available, at least in this case study. Interestingly, the sizes of the credibility intervals are smaller by about 25% with “50% Y - 50% Z” compared to “50% Y - 0% Z”, showing that the combination of Y and Z observations collected in different trials in beneficial and lead to a reduction of the uncertainty in the estimated treatment efficacy. The latter result illustrates how the estimation of treatment efficacy could be improved by combining trials with prevalence data and trials with intensity data.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-four" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-four-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="submitted-202310-favrot-pest_files/figure-html/fig-four-1.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-four-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Estimated treatment efficacies after 6 days (<strong>A</strong>) and after 12 days (<strong>B</strong>), with their credibility intervals. Colors correspond to the different scenarios.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|echo: false</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(df_len6, df_len12 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span> Data, <span class="sc">-</span> Insecticide)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">caption =</span> <span class="st">"Differences in the sizes of the 95 credibility intervals (CI) of the estimated treatment efficacies for the scenarios 50</span><span class="sc">\\</span><span class="st">% Y - 50</span><span class="sc">\\</span><span class="st">% Z, 0</span><span class="sc">\\</span><span class="st">% Y - 50</span><span class="sc">\\</span><span class="st">% Z and 100</span><span class="sc">\\</span><span class="st">% Y - 0</span><span class="sc">\\</span><span class="st">% Z, compared to 50</span><span class="sc">\\</span><span class="st">% Y - 0</span><span class="sc">\\</span><span class="st">% Z. The difference is given in percentage. A positive (negative) value indicates an increase (decrease) of the credibility interval size. The third column indicates differences for the efficacy at 6 days after pesticide spray, and the fourth column indicates the difference for the efficacy at 12 days."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Differences in the sizes of the 95 credibility intervals (CI) of the estimated treatment efficacies for the scenarios 50\% Y - 50\% Z, 0\% Y - 50\% Z and 100\% Y - 0\% Z, compared to 50\% Y - 0\% Z. The difference is given in percentage. A positive (negative) value indicates an increase (decrease) of the credibility interval size. The third column indicates differences for the efficacy at 6 days after pesticide spray, and the fourth column indicates the difference for the efficacy at 12 days.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Insecticide</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Data</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">For efficacy at 6 days</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">For efficacy at 12 days</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mavrik Jet</td>
<td style="text-align: left;">0% Y - 50% Z</td>
<td style="text-align: right;">26.7</td>
<td style="text-align: right;">-19.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Movento</td>
<td style="text-align: left;">0% Y - 50% Z</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">-9.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Teppeki</td>
<td style="text-align: left;">0% Y - 50% Z</td>
<td style="text-align: right;">44.4</td>
<td style="text-align: right;">16.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mavrik Jet</td>
<td style="text-align: left;">100% Y - 0% Z</td>
<td style="text-align: right;">-27.7</td>
<td style="text-align: right;">-41.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Movento</td>
<td style="text-align: left;">100% Y - 0% Z</td>
<td style="text-align: right;">-40.5</td>
<td style="text-align: right;">-46.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Teppeki</td>
<td style="text-align: left;">100% Y - 0% Z</td>
<td style="text-align: right;">-25.6</td>
<td style="text-align: right;">-37.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mavrik Jet</td>
<td style="text-align: left;">50% Y - 50% Z</td>
<td style="text-align: right;">-18.4</td>
<td style="text-align: right;">-31.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Movento</td>
<td style="text-align: left;">50% Y - 50% Z</td>
<td style="text-align: right;">-27.1</td>
<td style="text-align: right;">-31.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Teppeki</td>
<td style="text-align: left;">50% Y - 50% Z</td>
<td style="text-align: right;">-12.1</td>
<td style="text-align: right;">-22.4</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="results-obtained-by-simulation" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="results-obtained-by-simulation"><span class="header-section-number">3.2</span> Results obtained by simulation</h2>
<section id="interest-of-combining-trials-with-prevalence-and-trials-with-intensity" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="interest-of-combining-trials-with-prevalence-and-trials-with-intensity"><span class="header-section-number">3.2.1</span> Interest of combining trials with prevalence and trials with intensity</h3>
<p>In this section, we consider the situation where only one type of observation is available per trial - pest prevalence or pest intensity. We compare the accuracy of the estimated parameters and estimated levels of treatment efficacy obtained by combining both types of trials compared to the results obtained using each set of trials separately.</p>
<p>The parameters used to generate the data are given in table 6.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Parameters used to generate virtual data.</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Parameters</td>
<td style="text-align: left;">α₀</td>
<td style="text-align: left;">α₁</td>
<td style="text-align: left;">γ₀₀</td>
<td style="text-align: left;">γ₀₁</td>
<td style="text-align: left;">γ₀₂</td>
<td style="text-align: left;">γ₀₃</td>
<td style="text-align: left;">γ₁₀</td>
<td style="text-align: left;">γ₁₁</td>
<td style="text-align: left;">γ₁₂</td>
<td style="text-align: left;">γ₁₃</td>
<td style="text-align: left;">σ₀</td>
<td style="text-align: left;">η</td>
<td style="text-align: left;">χ</td>
</tr>
<tr class="even">
<td style="text-align: left;">Values</td>
<td style="text-align: left;">0.50</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">0.00</td>
<td style="text-align: left;">-0.13</td>
<td style="text-align: left;">-1.13</td>
<td style="text-align: left;">-1.24</td>
<td style="text-align: left;">0.00</td>
<td style="text-align: left;">0.24</td>
<td style="text-align: left;">-0.14</td>
<td style="text-align: left;">-0.15</td>
<td style="text-align: left;">1.87</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.27</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><a href="#fig-five" class="quarto-xref">Figure&nbsp;5</a> represents the <span class="math inline">E_{\gamma}</span> (<a href="#eq-E_gamma" class="quarto-xref">Equation&nbsp;6</a>) (<strong>A</strong>), <span class="math inline">E_{Ef_6}</span> (<a href="#eq-E_efficacy" class="quarto-xref">Equation&nbsp;7</a>) (<strong>B</strong>) and <span class="math inline">E_{Ef_{12}}</span> (<a href="#eq-E_efficacy" class="quarto-xref">Equation&nbsp;7</a>) (<strong>C</strong>) evaluation criteria for the “0% Y - 50% Z”, “50% Y - 0% Z” and “50% Y - 50% Z” scenarios (different scenarios are indicated by different colors. The x-axis presents the number of trials and the y-axis the value of the criterion, averaged over the simulated data sets. For each number of trials and for each criterion, we observe that scenario “50% Y - 50% Z” gives a more accurate estimate than scenario “50% Y - 0% Z” which itself gives a more accurate estimate than scenario “0% Y - 50% Z”. For example, for the efficacy at 6 days with 40 trials, the mean absolute error of scenario “50% Y - 0% Z” is 10% less than the mean absolute error of scenario “0% Y - 50% Z” (0.38 vs 0.42). The mean absolute error of scenario “50% Y - 50% Z” is 35% less than that of scenario “0% Y - 50% Z” (0.26 vs 0.42). The values of the three criteria decrease with the number of trials. The <span class="math inline">E_{\gamma}</span> criterion decreases from 0.62 with 20 trials to 0.32 with 80 trials for the “50% Y - 50% Z” scenario. A value of 20 trials is therefore not sufficient to obtain an accurate estimate of the parameters.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-five" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-five-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="submitted-202310-favrot-pest_files/figure-html/fig-five-1.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-five-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Values of the <span class="math inline">E_{\gamma}</span> (<a href="#eq-E_gamma" class="quarto-xref">Equation&nbsp;6</a>) (<strong>A</strong>), <span class="math inline">E_{Ef_6}</span> (<a href="#eq-E_efficacy" class="quarto-xref">Equation&nbsp;7</a>) (<strong>B</strong>) and <span class="math inline">E_{Ef_{12}}</span> (<a href="#eq-E_efficacy" class="quarto-xref">Equation&nbsp;7</a>) (<strong>C</strong>) mean absolute error criteria for the ‘0% Y - 50% Z’, ‘50% Y - 0% Z’ and ‘50% Y - 50% Z’ scenarios. The x-axis presents the number of trials and the y-axis presents the mean absolute error, averaged over the 974 simulated datasets. Different colors correspond to different scenarios.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-six" class="quarto-xref">Figure&nbsp;6</a> presents the percentages of cases where the best treatment at 6 days (A) and 12 days (B) has been correctly identified for the “50% Y - 0% Z”, “0% Y - 50% Z” and “50% Y - 50% Z” scenarios. The x-axis presents the number of trials and the y-axis the percentage of cases where the treatment identification is correct. In general, the best treatment is better identified when the number of trials increases. With the “50% Y - 50% Z” scenario, the best treatment at 6 days is well identified in 69% of cases with 20 trials and in 85% of cases with 80 trials. For each number of trials, the percentage of correctly identification is higher for the “50% Y - 50% Z” scenario than for the other two, and the scenario “50% Y - 0% Z” generally gives better results than the scenario “0% Y - 50% Z”, except at 6 days with 20 trials. For example, at 12 days after treatment and with 40 trials, the percentage of correct identification is 5% higher with scenario “50% Y - 50% Z” than with scenario “50% Y - 0% Z” (78 vs 73), and 4% higher with the scenario “50% Y - 0% Z” than with scenario “0% Y - 50% Z” (73 vs 69). These results show the interest of combining prevalence and intensity data for assessing the efficacy of treatments and identifying the best treatments.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-six" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-six-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="submitted-202310-favrot-pest_files/figure-html/fig-six-1.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-six-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Comparison of proportion cases where the best treatment is correctly identified in the ‘0% Y - 50% Z’, ‘50% Y - 0% Z’ and ‘50% Y - 50% Z’ scenarios. The x-axis represents the number of trials and the y-axis represents the percentage of cases where the best treatment has been correctly identified at 6 days (A) and 12 days (B), over the 974 simulated datasets. Different colors correspond to different scenarios.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="interest-of-adding-intensity-when-prevalence-is-measured-in-all-trials" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="interest-of-adding-intensity-when-prevalence-is-measured-in-all-trials"><span class="header-section-number">3.2.2</span> Interest of adding intensity when prevalence is measured in all trials</h3>
<p>We now consider a situation where prevalence is measured in each trial and intensity is measured in only some of these trials. We compare the results obtained when the data are combined and when they are used separately. As the prevalence data are usually more accessible in practice and the intensity data more costly, it is important to evaluate the interest of adding intensity data in the statistical analysis.</p>
<p>The parameters used to generate the data are the same as in 3.2.1.</p>
<p><a href="#fig-seven" class="quarto-xref">Figure&nbsp;7</a> presents the evaluation criteria <span class="math inline">E_{\gamma}</span> (Fig 7A), <span class="math inline">E_{Ef_6}</span> (Fig 7B) and <span class="math inline">E_{Ef_{12}}</span> (Fig. 7C) for the scenarios “0% Y - 100% Z”, “50% Y - 0% Z”, “50% Y - 100% Z” and “50% Y - 50% Z”. The x-axis presents the number of trials and the y-axis presents the value of the criterion, averaged over the number of simulated data sets. Results show that the mean absolute errors are lower in scenarios “50% Y - 100% Z” and “50% Y - 50% Z” than in “0% Y - 100% Z”, and that the mean absolute errors are lower in the “0% Y - 100% Z” scenario than in the “50% Y - 0% Z” scenario. For example, considering the treatment efficacy at 12 days with 40 trials (Fig. 7C), the mean absolute errors are 13% lower in scenarios “50% Y - 100% Z” and “50% Y - 50% Z” than in “0% Y - 100% Z” (0.30 vs 0.34), and the mean absolute error is 11% lower in “0% Y - 100% Z” than in “50% Y - 0% Z” (0.34 vs 0.38). Clearly, adding intensity data to prevalence data improves the accuracy of the estimations. The mean absolute errors decrease with the number of trials. For example, the <span class="math inline">E_{\gamma}</span> criterion decreases from 0.62 with 20 trials to 0.32 with 80 trials for the “50% Y - 50% Z” scenario. As noted above, 20 trials is clearly not sufficient to obtain accurate results.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-seven" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seven-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="submitted-202310-favrot-pest_files/figure-html/fig-seven-1.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-seven-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Values of <span class="math inline">E_{\gamma}</span> (<a href="#eq-E_gamma" class="quarto-xref">Equation&nbsp;6</a>) (<strong>A</strong>), <span class="math inline">E_{Ef_6}</span> (<a href="#eq-E_efficacy" class="quarto-xref">Equation&nbsp;7</a>) (<strong>B</strong>) and <span class="math inline">E_{Ef_{12}}</span> (<a href="#eq-E_efficacy" class="quarto-xref">Equation&nbsp;7</a>) (<strong>C</strong>) for the ‘0% Y - 100% Z’, ‘50% Y - 0% Z’, ‘50% Y - 100% Z’ and ‘50% Y - 50% Z’ scenarios. The x-axis presents the number of trials and the y-axis presents the absolute error averaged over the 974 simulated datasets. Different colors correspond to different scenarios.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="is-it-better-to-measure-intensity-or-prevalence-in-new-pest-surveys" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="is-it-better-to-measure-intensity-or-prevalence-in-new-pest-surveys"><span class="header-section-number">3.2.3</span> Is it better to measure intensity or prevalence in new pest surveys?</h3>
<p>In order to optimize the design of new pest surveys that might be conducted in the future, we determine which type of observations should be favored. For that purpose, we compare the results obtained with the “100% Y - 0% Z”, “0% Y - 100% Z”, “100% Y / 100% Z” and “100% W” scenarios, for different values of <span class="math inline">\alpha_0</span> that defines the average number of infested plants. With <span class="math inline">\alpha_0</span> = -1, the proportion of infested plants is generally much lower than one, while with <span class="math inline">\alpha_0 = 2</span>, 100% of plants are generally infested. The case <span class="math inline">\alpha_0</span> = 1 leads to intermediate levels of infestation.</p>
<p>The three parameter sets used to generate the data are given in Table 7 and are labeled A, B and C.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|echo: false</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>tab7 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Parameters =</span> <span class="fu">c</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># alpha_0 et alpha_1</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">"\u03B1\u2080"</span>, <span class="st">"\u03B1\u2081"</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># gamma_0</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">"\u03B3\u2080\u2080"</span>, <span class="st">"\u03B3\u2080\u2081"</span>, <span class="st">"\u03B3\u2080\u2082"</span>, <span class="st">"\u03B3\u2080\u2083"</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># gamma_1</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">"\u03B3\u2081\u2080"</span>, <span class="st">"\u03B3\u2081\u2081"</span>, <span class="st">"\u03B3\u2081\u2082"</span>, <span class="st">"\u03B3\u2081\u2083"</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># sigma_0, eta et chi</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">"\u03C3\u2080"</span>, <span class="st">"\u03B7"</span>, <span class="st">"\u03C7"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Values set A"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, alpha1, gamma0, gamma1, sig0, eta, chi),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Values set B"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, alpha1, gamma0, gamma1, sig0, eta, chi),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Values set C"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, alpha1, gamma0, gamma1, sig0, eta, chi)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>tab7 <span class="sc">%&gt;%</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    t <span class="sc">%&gt;%</span> </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">rownames&lt;-</span><span class="st">`</span>(<span class="fu">c</span>(<span class="st">"Set"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>(<span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">caption =</span> <span class="st">"Parameters considered for the design of future pest surveys."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Parameters considered for the design of future pest surveys.</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Set</td>
<td style="text-align: left; font-weight: bold;">α₀</td>
<td style="text-align: left;">α₁</td>
<td style="text-align: left;">γ₀₀</td>
<td style="text-align: left;">γ₀₁</td>
<td style="text-align: left;">γ₀₂</td>
<td style="text-align: left;">γ₀₃</td>
<td style="text-align: left;">γ₁₀</td>
<td style="text-align: left;">γ₁₁</td>
<td style="text-align: left;">γ₁₂</td>
<td style="text-align: left;">γ₁₃</td>
<td style="text-align: left;">σ₀</td>
<td style="text-align: left;">η</td>
<td style="text-align: left;">χ</td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: left; font-weight: bold;">-1.00</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">0.00</td>
<td style="text-align: left;">-0.13</td>
<td style="text-align: left;">-1.13</td>
<td style="text-align: left;">-1.24</td>
<td style="text-align: left;">0.00</td>
<td style="text-align: left;">0.24</td>
<td style="text-align: left;">-0.14</td>
<td style="text-align: left;">-0.15</td>
<td style="text-align: left;">1.87</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: left; font-weight: bold;">1.00</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">0.00</td>
<td style="text-align: left;">-0.13</td>
<td style="text-align: left;">-1.13</td>
<td style="text-align: left;">-1.24</td>
<td style="text-align: left;">0.00</td>
<td style="text-align: left;">0.24</td>
<td style="text-align: left;">-0.14</td>
<td style="text-align: left;">-0.15</td>
<td style="text-align: left;">1.87</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">C</td>
<td style="text-align: left; font-weight: bold;">2.00</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">0.00</td>
<td style="text-align: left;">-0.13</td>
<td style="text-align: left;">-1.13</td>
<td style="text-align: left;">-1.24</td>
<td style="text-align: left;">0.00</td>
<td style="text-align: left;">0.24</td>
<td style="text-align: left;">-0.14</td>
<td style="text-align: left;">-0.15</td>
<td style="text-align: left;">1.87</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.27</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><a href="#fig-height" class="quarto-xref">Figure&nbsp;8</a> (A.1, B.1 and C.1) shows the mean absolute error <span class="math inline">E_{\gamma}</span> (<a href="#eq-E_gamma" class="quarto-xref">Equation&nbsp;6</a>) as a function of the number of trials for the four scenarios “100% Y - 0% Z”, “0% Y - 100% Z”, “100% Y / 100% Z” and “100% W”. <a href="#fig-height" class="quarto-xref">Figure&nbsp;8</a> (A.2, B.2 and C.2) shows the distributions of infested plants with 40 trials corresponding to the three values of <span class="math inline">\alpha_0</span> reported in Table 7. In case A (Table 7), the distribution of Z is such that Z is rarely close to 1 and often lower than 0.5 (<a href="#fig-height" class="quarto-xref">Figure&nbsp;8</a> A.2). In case C, the distribution of Z is such that Z is often very close to 1 (100% of plants infested). Case B is intermediate. The accuracy of the estimated values of the model parameters <span class="math inline">\gamma</span> is better with scenario “100% Y - 0% Z” than with scenario “0% Y - 100% Z”, for all number of trials. The advantage of “100% Y - 0% Z” is stronger in case of high pest prevalence (i.e., cases B and C) but very small in case of low pest prevalence (case A). For example, with 20 trials, the mean absolute error is 27% lower in the scenario “100% Y - 0% Z” than in “0% Y - 100% Z” for parameter set C (0.55 vs.&nbsp;0.75), 10% lower for parameter set B (0.55 vs.&nbsp;0.62), and not different for parameter set A (0.64). The “100% W” scenario leads to similar results as “100% Y - 0% Z”, regardless of <span class="math inline">\alpha_0</span> and the number of trials. Results obtained with “100% Y / 100% Z” are generally similar to those obtained with “100% Y - 0% Z” and “100% W” but better than those obtained with the scenario “0% Y - 100% Z” in cases B and C. Here again, results show that 20 trials are not sufficient to obtain accurate parameter estimates.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-height" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-height-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="submitted-202310-favrot-pest_files/figure-html/fig-height-1.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-height-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Comparison of the ‘100% Y - 0% Z’, ‘0% Y - 100% Z’, ‘100% Y / 100% Z’ and ‘100% W’ scenarios according to the distribution of <span class="math inline">Z</span> and the number of trials, using the <span class="math inline">E_{\gamma}</span> criterion (<a href="#eq-E_gamma" class="quarto-xref">Equation&nbsp;6</a>). <strong>A</strong>, <strong>B</strong> and <strong>C</strong> correspond to different <span class="math inline">Z</span> distributions which are given by A.2, B.2 and C.2 (distribution for a number of trials equal to 40). A, B and C respectively correspond to <span class="math inline">\alpha_0 =</span> -1, 1 and 2. The details of the simulation parameters are given in table 7. A1, B1 and C1 represent the absolute error <span class="math inline">E_{\gamma}</span> averaged over the 974 simulated datasets as a function of the number of trials. Colors correspond to the different scenarios.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Conclusion</h1>
<p>In order to evaluate pest treatment efficacy, numerous trials are conducted to monitor pest prevalence and intensity. Quite often, only one type of data is available and, when both prevalence and intensity are available, they are usually analysed separately. In this paper, we proposed an alternative approach based on a hierarchical statistical model able to analyze intensity and prevalence data, simultaneously.</p>
<p>We successfully applied the model to a real dataset including prevalence and incidence data collected to evaluate three pesticide treatments against aphids in sugar beets. The model was fitted to this datased using a Markov chain Monte Carlo algorithm, and convergence was quickly achieved after a few thousands iterations. Results showed that the use of both prevalence and intensity data led to a substantial reduction of the uncertainty in the parameter estimates, compared to the use of a single type of data.</p>
<p>Results obtained from simulated data confirmed that, when pest prevalence and pest intensity are collected separately in different trials, the model parameters are more accurately estimated combining both prevalence and intensity trials than using one type of trials only. We also found that, when prevalence data are collected in all trials and intensity data are collected in a subset of trials, estimations and pest treatment ranking are more accurate using both types of data than using prevalence data only. Moreover, when only one type of observation can be collected in a pest survey or in an experimental trial, our analysis indicates that it is usually better to collect intensity data than prevalence data, especially in situations where all or most of the plants are expected to be infested. Finally, our simulations show that it is unlikely to obtain accurate results with fewer than 40 trials when assessing the efficacy of pest control treatments based on prevalence and intensity data.</p>
<p>Although our framework was illustrated to compare the efficacy of plant pest treatments, it could be applied to other areas of research in the future, in particular for optimizing designs used in animal and human epidemiology. It is imperative to note that the ultimate selection of a design should be contingent upon the consideration of localized constraints. As the model codes are made fully available, we believe that these codes could be used by different institutes to compare many different designs in the future, not only the types of designs considered in our paper. Of particular significance is the capability of our model to optimize sample sizes, with its impact contingent on the relative importance of within-trial variability compared to between-trial variability.</p>
</section>
<section id="author-contributions" class="level1 unnumbered">
<h1 class="unnumbered">Author contributions</h1>
<p>AF and DM designed the study. AF performed the computations. AF and DM wrote the paper.</p>
</section>
<section id="funding" class="level1 unnumbered">
<h1 class="unnumbered">Funding</h1>
<p>This work was partly funded by the project SEPIM (PNRI) and by the RMT SDMAA.</p>
</section>
<section id="data-availability" class="level1 unnumbered">
<h1 class="unnumbered">Data availability</h1>
<p>Simulated data and model parameters are available without restriction. The original experimental data may be available under request.</p>
</section>
<section id="acknowledgements" class="level1 unnumbered">
<h1 class="unnumbered">Acknowledgements</h1>
<p>We are grateful to Anabelle Laurent, Elma Raaijmakers, Kathleen Antoons and to the institute ITB (https://www.itbfr.org/) for their comments on this project.</p>
<p>We are grateful to the INRAE MIGALE bioinformatics facility (MIGALE, INRAE, 2020. Migale bioinformatics Facility, doi: 10.15454/1.5572390655343293E12) for providing help and/or computing and/or storage resources.</p>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-agresti2015foundations" class="csl-entry" role="listitem">
Agresti, Alan. 2015. <em>Foundations of Linear and Generalized Linear Models</em>. John Wiley &amp; Sons.
</div>
<div id="ref-gelman1995bayesian" class="csl-entry" role="listitem">
Gelman, Andrew, John B Carlin, Hal S Stern, and Donald B Rubin. 1995. <em>Bayesian Data Analysis</em>. Chapman; Hall/CRC.
</div>
<div id="ref-gelman1992inference" class="csl-entry" role="listitem">
Gelman, Andrew, and Donald B Rubin. 1992. <span>“Inference from Iterative Simulation Using Multiple Sequences.”</span> <em>Statistical Science</em>, 457–72.
</div>
<div id="ref-gurmu2000generalized" class="csl-entry" role="listitem">
Gurmu, Shiferaw, and John Elder. 2000. <span>“Generalized Bivariate Count Data Regression Models.”</span> <em>Economics Letters</em> 68 (1): 31–36.
</div>
<div id="ref-harrison2014using" class="csl-entry" role="listitem">
Harrison, Xavier A. 2014. <span>“Using Observation-Level Random Effects to Model Overdispersion in Count Data in Ecology and Evolution.”</span> <em>PeerJ</em> 2: e616.
</div>
<div id="ref-LAURENT2023106140" class="csl-entry" role="listitem">
Laurent, Anabelle, Armand Favrot, Fabienne Maupas, Cédric Royer, and David Makowski. 2023. <span>“Assessment of Non-Neonicotinoid Treatments Against Aphids on Sugar Beets.”</span> <em>Crop Protection</em> 164: 106140. <a href="https://doi.org/10.1016/j.cropro.2022.106140">https://doi.org/10.1016/j.cropro.2022.106140</a>.
</div>
<div id="ref-madden1999sampling" class="csl-entry" role="listitem">
Madden, LV, and G Hughes. 1999. <span>“Sampling for Plant Disease Incidence.”</span> <em>Phytopathology</em> 89 (11): 1088–1103.
</div>
<div id="ref-michel2017framework" class="csl-entry" role="listitem">
Michel, Lucie, Francois Brun, and David Makowski. 2017. <span>“A Framework Based on Generalised Linear Mixed Models for Analysing Pest and Disease Surveys.”</span> <em>Crop Protection</em> 94: 1–12.
</div>
<div id="ref-osiewalski2019joint" class="csl-entry" role="listitem">
Osiewalski, Jacek, and Jerzy Marzec. 2019. <span>“Joint Modelling of Two Count Variables When One of Them Can Be Degenerate.”</span> <em>Computational Statistics</em> 34: 153–71.
</div>
<div id="ref-park2007multivariate" class="csl-entry" role="listitem">
Park, Eun Sug, and Dominique Lord. 2007. <span>“Multivariate Poisson-Lognormal Models for Jointly Modeling Crash Frequency by Severity.”</span> <em>Transportation Research Record</em> 2019 (1): 1–6.
</div>
<div id="ref-pisa2015effects" class="csl-entry" role="listitem">
Pisa, Lennard W, Vanessa Amaral-Rogers, Luc P Belzunces, Jean-Marc Bonmatin, Craig A Downs, Dave Goulson, David P Kreutzweiser, et al. 2015. <span>“Effects of Neonicotinoids and Fipronil on Non-Target Invertebrates.”</span> <em>Environmental Science and Pollution Research</em> 22 (1): 68–102.
</div>
<div id="ref-rjags" class="csl-entry" role="listitem">
Plummer, Martyn. 2022. <em>Rjags: Bayesian Graphical Models Using MCMC</em>. <a href="https://CRAN.R-project.org/package=rjags">https://CRAN.R-project.org/package=rjags</a>.
</div>
<div id="ref-shaw2018metrics" class="csl-entry" role="listitem">
Shaw, Allison K, Julie Sherman, F Keith Barker, and Marlene Zuk. 2018. <span>“Metrics Matter: The Effect of Parasite Richness, Intensity and Prevalence on the Evolution of Host Migration.”</span> <em>Proceedings of the Royal Society B</em> 285 (1891): 20182147.
</div>
<div id="ref-wood2017environmental" class="csl-entry" role="listitem">
Wood, Thomas James, and Dave Goulson. 2017. <span>“The Environmental Risks of Neonicotinoid Pesticides: A Review of the Evidence Post 2013.”</span> <em>Environmental Science and Pollution Research</em> 24 (21): 17285–325.
</div>
</div>
</section>


<div id="quarto-appendix" class="default"><section id="session-information" class="level1 appendix unnumbered"><h2 class="anchored quarto-appendix-heading">Session information</h2><div class="quarto-appendix-contents">

<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] grid      stats     graphics  grDevices datasets  utils     methods  
[8] base     

other attached packages:
 [1] kableExtra_1.3.4 latex2exp_0.9.4  rjags_4-13       coda_0.19-4     
 [5] gridExtra_2.3    forcats_0.5.1    stringr_1.4.0    dplyr_1.1.2     
 [9] purrr_1.0.1      readr_2.1.2      tidyr_1.2.0      tibble_3.2.1    
[13] tidyverse_1.3.1  ggplot2_3.3.6   

loaded via a namespace (and not attached):
 [1] gtable_0.3.0      xfun_0.30         lattice_0.20-45   tzdb_0.3.0       
 [5] vctrs_0.6.3       tools_4.3.1       generics_0.1.2    fansi_1.0.3      
 [9] highr_0.9         pkgconfig_2.0.3   dbplyr_2.1.1      webshot_0.5.3    
[13] readxl_1.4.0      assertthat_0.2.1  lifecycle_1.0.3   farver_2.1.0     
[17] compiler_4.3.1    munsell_0.5.0     htmltools_0.5.2   yaml_2.3.5       
[21] pillar_1.9.0      crayon_1.5.1      ellipsis_0.3.2    tidyselect_1.2.0 
[25] rvest_1.0.2       digest_0.6.29     stringi_1.7.6     labeling_0.4.2   
[29] cowplot_1.1.1     fastmap_1.1.0     colorspace_2.1-0  cli_3.6.0        
[33] magrittr_2.0.3    utf8_1.2.2        broom_0.8.0       withr_2.5.0      
[37] scales_1.2.0      backports_1.4.1   lubridate_1.8.0   rmarkdown_2.14   
[41] modelr_0.1.8      httr_1.4.3        cellranger_1.1.0  hms_1.1.1        
[45] evaluate_0.15     knitr_1.39        haven_2.5.0       viridisLite_0.4.0
[49] rlang_1.1.1       glue_1.6.2        DBI_1.1.2         xml2_1.3.3       
[53] renv_1.0.2        reprex_2.0.1      svglite_2.1.0     rstudioapi_0.13  
[57] jsonlite_1.8.0    R6_2.5.1          systemfonts_1.0.4 fs_1.5.2         </code></pre>
</div>
</div>


<!-- -->

</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@article{favrot2023,
  author = {Favrot, Armand and Makowski, David},
  title = {A Hierarchical Model to Evaluate Pest Treatments from
    Prevalence and Intensity Data},
  journal = {Computo},
  pages = {undefined},
  date = {},
  url = {https://computo.sfds.asso.fr/},
  doi = {to complete},
  issn = {2824-7795},
  langid = {en},
  abstract = {In plant epidemiology, pest abundance is measured in field
    trials using metrics assessing either pest prevalence (fraction of
    the plant population infected) or pest intensity (average number of
    pest individuals present in infected plants). Some of these trials
    rely on prevalence, while others rely on intensity, depending on the
    protocols. In this paper, we present a hierarchical Bayesian model
    able to handle both types of data. In this model, the intensity and
    prevalence variables are derived from a latent variable representing
    the number of pest individuals on each host individual, assumed to
    follow a Poisson distribution. Effects of pest treaments, time
    trend, and between-trial variability are described using fixed and
    random effects. We apply the model to a real dataset in the context
    of aphid control in sugar beet fields. In this dataset, prevalence
    and intensity were derived from aphid counts observed on either
    factorial trials testing different types of pesticides treatments or
    field surveys monitoring aphid abundance. Next, we perform
    simulations to assess the impacts of using either prevalence or
    intensity data, or both types of data simultaneously, on the
    accuracy of the model parameter estimates and on the ranking of
    pesticide treatment efficacy. Our results show that, when pest
    prevalence and pest intensity data are collected separately in
    different trials, the model parameters are more accurately estimated
    using both types of trials than using one type of trials only. When
    prevalence data are collected in all trials and intensity data are
    collected in a subset of trials, estimations and pest treatment
    ranking are more accurate using both types of data than using
    prevalence data only. When only one type of observation can be
    collected in a pest survey or in an experimental trial, our analysis
    indicates that it is better to collect intensity data than
    prevalence data when all or most of the plants are expected to be
    infested, but that both types of data lead to similar results when
    the level of infestation is low to moderate. Finally, our
    simulations show that it is unlikely to obtain accurate results with
    fewer than 40 trials when assessing the efficacy of pest control
    treatments based on prevalence and intensity data. Because of its
    flexibility, our model can be used to evaluate and rank the efficacy
    of pest treatments using either prevalence or intensity data, or
    both types of data simultaneously. As it can be easily implemented
    using standard Bayesian packages, we hope that it will be useful to
    agronomists, plant pathologists, and applied statisticians to
    analyze pest surveys and field experiments conducted to assess the
    efficacy of pest treatments.}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-favrot2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Favrot, Armand, and David Makowski. n.d. <span>“A Hierarchical Model to
Evaluate Pest Treatments from Prevalence and Intensity Data.”</span>
<em>Computo</em>, undefined. <a href="https://doi.org/to complete">https://doi.org/to complete</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/jchiquet\.github\.io\/computo_mysubmission_favrot\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb8" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "A hierarchical model to evaluate pest treatments from prevalence and intensity data"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Armand Favrot"</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">    corresponding: true</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">    email: armand.favrot@inrae.fr</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">      - name: MIA Paris-Saclay, INRAE AgroParisTech Université Paris-Saclay, France</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">        url: https://mia-ps.inrae.fr/</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "David Makowski"</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">    corresponding: true</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">    email: david.makowski@inrae.fr</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">      - name: MIA Paris-Saclay, INRAE AgroParisTech Université Paris-Saclay, France</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">        url: https://mia-ps.inrae.fr/</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> last-modified</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="an">abstract:</span><span class="co"> &gt;+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">  In plant epidemiology, pest abundance is measured in field trials using metrics assessing either pest prevalence (fraction of the plant population infected) or pest intensity (average number of pest individuals present in infected plants). Some of these trials rely on prevalence, while others rely on intensity, depending on the protocols.</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">  In this paper, we present a hierarchical Bayesian model able to handle both types of data. In this model, the intensity and prevalence variables are derived from a latent variable representing the number of pest individuals on each host individual, assumed to follow a Poisson distribution. Effects of pest treaments, time trend, and between-trial variability are described using fixed and random effects.</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co">  We apply the model to a real dataset in the context of aphid control in sugar beet fields. In this dataset, prevalence and intensity were derived from aphid counts observed on either factorial trials testing different types of pesticides treatments or field surveys monitoring aphid abundance. </span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co">  Next, we perform simulations to assess the impacts of using either prevalence or intensity data, or both types of data simultaneously, on the accuracy of the model parameter estimates and on the ranking of pesticide treatment efficacy.</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co">  Our results show that, when pest prevalence and pest intensity data are collected separately in different trials, the model parameters are more accurately estimated using both types of trials than using one type of trials only. When prevalence data are collected in all trials and intensity data are collected in a subset of trials, estimations and pest treatment ranking are more accurate using both types of data than using prevalence data only. When only one type of observation can be collected in a pest survey or in an experimental trial, our analysis indicates that it is better to collect intensity data than prevalence data when all or most of the plants are expected to be infested, but that both types of data lead to similar results when the level of infestation is low to moderate. Finally, our simulations show that it is unlikely to obtain accurate results with fewer than 40 trials when assessing the efficacy of pest control treatments based on prevalence and intensity data.</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co">  Because of its flexibility, our model can be used to evaluate and rank the efficacy of pest treatments using either prevalence or intensity data, or both types of data simultaneously. As it can be easily implemented using standard Bayesian packages, we hope that it will be useful to agronomists, plant pathologists, and applied statisticians to analyze pest surveys and field experiments conducted to assess the efficacy of pest treatments.</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="an">keywords:</span><span class="co"> [bayesian model, epidemiology, hierarchical model, pest control, trial, survey]</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="an">doi:</span><span class="co"> "to complete"</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="co">  type: article-journal</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co">  container-title: "Computo"</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co">  issued: "2023/01/25"</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co">  url: https://computo.sfds.asso.fr/</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co">  issn: "2824-7795"</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="an">google-scholar:</span><span class="co"> true</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="an">github-user:</span><span class="co"> computorg</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="an">repo:</span><span class="co"> "To complete"</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> true </span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="an">published:</span><span class="co"> false</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="co">  computo-html: default</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="co">  computo-pdf: default</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="in">```{r dependencies, cache = FALSE, include = FALSE}</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2);</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse);</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="in">library(gridExtra);</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="in">library(rjags);</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="in">library(latex2exp);</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="in">library(grid);</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr);</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr);</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="in">library(tibble)</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a><span class="in">library(kableExtra)</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a><span class="in">library(coda)</span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a><span class="in">x = 6;   y = 8;   z = 7</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="in">theme_replace(axis.text = element_text(size = x),   axis.title.x = element_text(size = y), </span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a><span class="in">              axis.title.y = element_text(size = y, angle = 90, margin = margin(r = 5)),</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a><span class="in">              strip.text = element_text(size = z, face = "bold", color = "white"),</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="in">              legend.text = element_text(size = y), legend.title = element_text(size = y, face = "bold"),</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a><span class="in">              plot.title = element_text(size = z, hjust = 0.5, face = "bold"),</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a><span class="in">              strip.background = element_rect(fill = "#4345a1"), panel.background = element_rect(fill = "#f3faff"), panel.grid.major = element_line(colour = "white"))</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="in">options(ggplot2.discrete.fill = list("#67c5a7"))</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>\linenumbers</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>In plant epidemiology, pest and disease presence can be measured in a host population using different metrics. A first metric measures the presence/absence of the pest in the individuals (plants) of the host population. This metric is often called prevalence or incidence (@madden1999sampling, @shaw2018metrics). The prevalence describes the proportion of the host population in which the pest is present. This metric is relevant and widely used, but it does not account for the number of pest individuals per host individual. With the prevalence, a plant infected by one single pest individual (e.g., an insect) and a plant infected by many pest individuals both represents one infected plant. For this reason, pest abundance is sometimes assessed using another metric representing the average number of pest individuals per host individual. This metric is called intensity or severity (@madden1999sampling, @shaw2018metrics), and describes the intensity of the disease in the target population. These two metrics do not generally have the same requirement in terms of working time; measuring intensity takes indeed much more time than measuring prevalence because it is very tedious to count all pest individuals, especially when individuals are small, numerous, and/or difficult to detect.</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>Pest prevalence and intensity are commonly measured in factorial field trials to test the efficacy of different treatments. In this paper, we place ourselves in an important application framework which is the evaluation of alternative pesticide treatments to neonicotinoids against aphids in sugar beet. Indeed, neonicotinoids had been a popular chemical treatment to control aphids for many years, especially in sugar beets, a major crop in Europe. Recently, neonicotinoids were recognized as presenting high risks for the environment with a negative impact on a wide range of non-target organisms, including bees (@wood2017environmental, @pisa2015effects), and this familly of pesticides has been banned in several European countries. In order to find a substitute to neonicotinoids, a number of factorial field trials were conducted to compare the efficacy of different alternative treatments during several years in different countries. Each trial consists of a set of plots divided into several blocks, themselves divided into several strips on which different pesticide treatments are randomly allocated. One strip always remains untreated to serve as a control. In each strip, aphid prevalence, aphid intensity or both metrics are measured in a sample of plants (usually, 10-20 plants per strip).  Depending on the protocol and on the working time constraint, either one type or both types of metrics are measured. Consequently, for a given pest treatment, some trials may report prevalence data while others report intensity data or both types of data. </span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>    This heterogeneity raises several issues. A first issue concerns the statistical analysis of the trials reporting prevalence and intensity. Although it is easy to fit a generalized linear model to each type of data separately, it is less straightforward to fit a single model to the whole set of trials in order to obtain a single ranking of the pest treatements taking into account both types of data at the same time. Generally, factorial trials assessing treatment efficacy are analyzed with statistical models that take into account one of the two metrics but not both. Prevalence data are thus commonly analyzed using binomial generalized linear models and intensity data are frequently analyzed with Poisson generalized linear models (@michel2017framework, @LAURENT2023106140, @agresti2015foundations). As far as we know, no statistical model has been proposed to assess treatment efficacy based on the simultaneous analysis of prevalence and intensity data. In @osiewalski2019joint, the authors introduced a switching model designed to handle two count variables, one of which may be degenerate. This model was employed to characterize the counts of cash payments and bank card payments in Poland, utilizing data from both cardholders and non-cardholders. A generalized form of the bivariate negative binomial regression model was developed in @gurmu2000generalized, allowing for a more flexible representation of the correlation between the dependent variables. This model was applied to describe the number of visits to a doctor and the number of visits to non-doctor health professionals. It outperformed existing bivariate models across various model comparison criteria. In order to analyze data related to crash counts categorized by severity, @park2007multivariate  employed a multivariate Poisson-lognormal model, effectively addressing both overdispersion and a fully generalized correlation structure within the dataset. However, it should be noted that these models did not include any binomial distribution and thus could not be used to deal with proportion data, such as pest prevalence.</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>    Another issue concerns the practical value of combining both prevalence and intensity data. It is unclear whether the simultaneous analysis of prevalence and intensity data may increase the accuracy of the estimated treatment efficacy compared to the use of a single type of data, and whether this may increase the probability of identifying the most efficient treatments. Finally, it is also unclear how future trials should be designed, in particular how many trials are required to obtain accurate estimations, and whether intensity data should be prefered to prevalence data.</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a> In this paper, we propose a new flexible statistical model that can be used to rank pest treatments from trials including prevalence data, intensity data, or both. We apply it to a real dataset including trials testing the efficacy of pesticides against aphids infesting sugar beets, considering contrasted scenarios of data availability, and we show how the proposed model can be used to evaluate the efficacy of different treatments. Based on simulations, we then quantify the reduction of mean absolute errors in the estimated treatment efficacies resulting from the use of both prevalence and intensity data during the statistical inference, compared to the use of exclusively either prevalence or intensity data. The rest of the paper is organized as follows. First, we present the structure of the dataset including real prevalence and intensity data. Next, we describe in detail the proposed model, the inference method, and the simulation strategy. After checking the convergence of the fitting algorithm, we show how the model can be used to assess treatement efficacy. We finally present the results based on simulated data and we make several recommendations.</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a><span class="fu"># Material and Method</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a><span class="fu">## Desciption of the data</span></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>Data were collected in 32 field trials conducted in France, Belgium and the Netherlands to compare several treatments against aphids in sugar beets. Each trial consists in a plot located in a given site at a given year (site-year) divided into one to four blocks. Each of these blocks is itself divided into strips where different treatments are tested, one of these treatments being an untreated control and the others corresponding to different types of insecticide. In each strip of each block, the number of aphids was counted on a sample of 10 beet plants (intensity). The number of infested plants (prevalence) was measured as well, but only in 15 trials out of 32. The total numbers of intensity and prevalence data are equal to 1128 and 561, respectively. Note that the number of aphids was not counted on each beet plant but in the whole plant sample. Intensity and prevalence were monitored at different times after treatments. As shown in @fig-one A, the dataset is unbalanced as less data are available for the treatment Mavrik-jet compared to the others. Figure 1B shows that the intensity and prevalence tend to increase with time. </span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r figure1, cache = FALSE, fig.width=12, fig.height=14}</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-one </span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Description of the dataset. **A** Number of observations according to the type of insecticide. **B** Examples of observed number of aphids averaged over the blocks (intensity) and number of infested beets out of ten (prevalence) averaged over the blocks, at different dates for two trials."</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a><span class="in">data_figure_1A = readRDS(file = "data/data_figure_1A.rds")</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a><span class="in">data_figure_1B = readRDS(file = "data/data_figure_1B.rds")</span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a><span class="in">rectangle_fig1A &lt;- grobTree(rectGrob(gp = gpar(fill = "#e9e9e9")), textGrob("A", x = 0.5, hjust = 0.5, gp = gpar(cex = 2.5, fontface = "bold")))</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a><span class="in">fig1A = ggplot(data_figure_1A) + </span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_bar(aes(x = Insecticide, y = n, fill = Insecticide), stat = "Identity") + </span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a><span class="in">    xlab("Insecticide") + </span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a><span class="in">    ylab("Number of observations") +</span></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_fill_manual(values = c('#df626c', '#893f3d', '#ff842e', '#188038')) + </span></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_discrete(limits = c("Untreated", "Mavrik Jet", "Movento", "Teppeki")) + </span></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(legend.position = "none", </span></span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.title.x = element_text(margin = margin(b = 50, t = 20), size = 18),</span></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.title.y = element_text(size = 18, margin = margin(r = 20)),</span></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.text = element_text(size = 16))</span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a><span class="in">rectangle_fig1B &lt;- grobTree(rectGrob(gp = gpar(fill = "#e9e9e9")), textGrob("B", x = 0.5, hjust = 0.5, gp = gpar(cex = 2.5, fontface = "bold")))</span></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a><span class="in">fig1B_aphid_intensity = ggplot(data_figure_1B) + </span></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(aes(x = DPT, y = Ymean, col = Insecticide), size = 2.5) + </span></span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_line(aes(x = DPT, y = Ymean, col = Insecticide), size = 0.2) +</span></span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values = c('#893f3d', '#ff842e', '#188038')) + </span></span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(~ ID, scales = "free", ncol = 2) + </span></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(legend.position = "bottom") + </span></span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a><span class="in">    xlab("") + </span></span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a><span class="in">    ylab("Number of aphids") +</span></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(plot.margin = margin(t = 40, r = 40, b = 0, l = 10), </span></span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.title.x = element_text(size = 18),</span></span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.title.y = element_text(size = 18, margin = margin(r = 20)),</span></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.text = element_text(size = 16),</span></span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a><span class="in">          strip.text = element_text(size = 20),</span></span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a><span class="in">          legend.title = element_text(size = 18),</span></span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a><span class="in">          legend.text = element_text(size = 18))</span></span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a><span class="in">fig1B_aphid_prevalence = ggplot(data_figure_1B) + geom_point(aes(x = DPT, y = Zmean, col = Insecticide), size = 2.5) + </span></span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_line(aes(x = DPT, y = Zmean, col = Insecticide), size = 0.2) +</span></span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values = c('#893f3d', '#ff842e', '#188038')) + </span></span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(~ ID, ncol = 2, scales = "free_x") + theme(legend.position = "none") + </span></span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a><span class="in">    xlab("Days post treatment") + </span></span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a><span class="in">    ylab("Number of infested beets") +</span></span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(panel.spacing = unit(1, "cm")) +</span></span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(plot.margin = margin(t = 0, r = 40, b = 0, l = 10), </span></span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.title.y = element_text(size = 18, margin = margin(r = 20)),</span></span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.text = element_text(size = 16),</span></span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.title.x = element_text(margin = margin(b = 20, t = 20), size = 18),</span></span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a><span class="in">          strip.text = element_text(size = 20))</span></span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a><span class="in">legend &lt;- cowplot::get_legend(fig1B_aphid_intensity)</span></span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a><span class="in">do.call("grid.arrange", </span></span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a><span class="in">        c(list(rectangle_fig1A, </span></span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a><span class="in">               fig1A + theme(plot.margin = margin(t = 30, r = 20)), </span></span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a><span class="in">               rectangle_fig1B, </span></span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a><span class="in">               fig1B_aphid_intensity + theme(legend.position = "none"),</span></span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a><span class="in">               fig1B_aphid_prevalence), list(legend), list(ncol = 1, </span></span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a><span class="in">             layout_matrix = rbind(c(1), c(2), c(3), c(4), c(5), c(6)), heights = c(0.12, 1.2, 0.12, 1, 1, 0.12))))</span></span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model</span></span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a><span class="fu">### Specification</span></span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a>We introduce an unobserved variable representing the number of pest individuals (here, aphids) on each plant in a sample of $N$ plants (here, sugar beets). This variable is noted $W$ and is assumed to follow a Poisson probability distribution whose mean value is a function of time. </span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a>We use the following indexes: $i$ for the trial, $j$ for the treatment, $k$ for the block, $t$ for the time and $s$ for the plant number. The distribution of $W_{ijkts}$ is defined as:</span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a>    W_{ijkts}\sim\mathcal{P}(\lambda_{ijkt})</span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a>$$ {#eq-model_W}</span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a>    \log\ \lambda_{ijkt} = \alpha_0 + \beta_{0i} + \gamma_{0j}  + (\alpha_1 + \gamma_{1j})\ X_t + u_{ij} + \epsilon_{ijkt} </span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a>$$ {#eq-model_lambda}</span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a>with </span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta_{0i}\sim\mathcal{N}(0, \sigma_0^2)$</span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$u_{ij}\sim\mathcal{N}(0, \chi^2)$</span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\epsilon_{ijkt}\sim\mathcal{N}(0,\eta^2)$</span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a>The random variables are all assumed independent. The parameters $\alpha_0$, $\alpha_1$, $\gamma_{0j}$, and $\gamma_{1j}$ are considered as fixed. This model serves as a tool for conducting inference on a population of trials, from which the subset of trials comprising our dataset is assumed to constitute a random sample. In essence, the trials contained within our database are leveraged to estimate the parameter values that characterize a target population, where the tested pest control treatments will be actually implemented. Consequently, all parameters contingent on individual trials have been defined as random effects.</span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a>The observed variables (intensity and prevalence) can be expressed as a function of $W$. We note:</span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$Y_{ijkt}$ the number of pest individuals (aphids) in the sample of $N_i$ plants collected in trial i, treatment j, block k, at time t </span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$Z_{ijkt}$ the number of infested plants among the $N_i$ plants collected in trial i, treatment j, block k, at time t </span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a>Then, assuming the $W$s are independent, we have: </span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a>    Y_{ijkt} = \sum\limits_{s = 1}^{N_i} W_{ijkts}\ \hspace{1cm}\ Y_{ijkt} \sim \mathcal{P}(N_{i}\lambda_{ijkt})</span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a>$$ {#eq-model_Y}</span>
<span id="cb8-195"><a href="#cb8-195" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-196"><a href="#cb8-196" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb8-197"><a href="#cb8-197" aria-hidden="true" tabindex="-1"></a>    Z_{ijkt} = \sum\limits_{s = 1}^{N_i} \boldsymbol{1}_{W_{ijkts}&gt;0}\ \hspace{1cm} \ Z_{ijkt} \sim \mathcal{B}(N_{i},\ \pi_{ijkt})</span>
<span id="cb8-198"><a href="#cb8-198" aria-hidden="true" tabindex="-1"></a>$$ {#eq-model_Z}</span>
<span id="cb8-199"><a href="#cb8-199" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-200"><a href="#cb8-200" aria-hidden="true" tabindex="-1"></a>where $\pi_{ijkt} = 1-\text{exp}(-\lambda_{ijkt})$. The different quantities used in the model are defined in Table 1. </span>
<span id="cb8-201"><a href="#cb8-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-202"><a href="#cb8-202" aria-hidden="true" tabindex="-1"></a>| | |</span>
<span id="cb8-203"><a href="#cb8-203" aria-hidden="true" tabindex="-1"></a>--|--</span>
<span id="cb8-204"><a href="#cb8-204" aria-hidden="true" tabindex="-1"></a>i | trial index</span>
<span id="cb8-205"><a href="#cb8-205" aria-hidden="true" tabindex="-1"></a>j | treatment index</span>
<span id="cb8-206"><a href="#cb8-206" aria-hidden="true" tabindex="-1"></a>k | block index</span>
<span id="cb8-207"><a href="#cb8-207" aria-hidden="true" tabindex="-1"></a>t | time index</span>
<span id="cb8-208"><a href="#cb8-208" aria-hidden="true" tabindex="-1"></a>s | plant index</span>
<span id="cb8-209"><a href="#cb8-209" aria-hidden="true" tabindex="-1"></a>$N_i$ | sample size (number of plants)</span>
<span id="cb8-210"><a href="#cb8-210" aria-hidden="true" tabindex="-1"></a>$\lambda_{ijkt}$ | mean number of pest individuals (aphids) on one plant</span>
<span id="cb8-211"><a href="#cb8-211" aria-hidden="true" tabindex="-1"></a>$\pi_{ijkt}$ | probability for a plant to be infested</span>
<span id="cb8-212"><a href="#cb8-212" aria-hidden="true" tabindex="-1"></a>$\alpha_0$ | mean number of pest individuals (aphids) in the untreated group</span>
<span id="cb8-213"><a href="#cb8-213" aria-hidden="true" tabindex="-1"></a>$\beta_{0i}$ | trial effect</span>
<span id="cb8-214"><a href="#cb8-214" aria-hidden="true" tabindex="-1"></a>$\gamma_{0j}$ | effect of treatment j at time 0 (time of treatment)</span>
<span id="cb8-215"><a href="#cb8-215" aria-hidden="true" tabindex="-1"></a>$\alpha_1$ | growth parameter of the number of pest individuals for the untreated group</span>
<span id="cb8-216"><a href="#cb8-216" aria-hidden="true" tabindex="-1"></a>$\gamma_{1j}$ | effect of the treatment on the time effect (interaction between treatment j and time)</span>
<span id="cb8-217"><a href="#cb8-217" aria-hidden="true" tabindex="-1"></a>$X_t$ | number of days post treatment</span>
<span id="cb8-218"><a href="#cb8-218" aria-hidden="true" tabindex="-1"></a>$u_{ij}$ | random interaction between trial and treatment</span>
<span id="cb8-219"><a href="#cb8-219" aria-hidden="true" tabindex="-1"></a>$\epsilon_{ijkt}$ | residuals</span>
<span id="cb8-220"><a href="#cb8-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-221"><a href="#cb8-221" aria-hidden="true" tabindex="-1"></a>:  Description of the indices, inputs and parameters used in the model {tbl-colwidths="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>"}</span>
<span id="cb8-222"><a href="#cb8-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-223"><a href="#cb8-223" aria-hidden="true" tabindex="-1"></a>From this model we defined the efficacy of the $j$th treatment at time $t$ ($t$ days after pesticide application) by the quantity (@LAURENT2023106140): </span>
<span id="cb8-224"><a href="#cb8-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-225"><a href="#cb8-225" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb8-226"><a href="#cb8-226" aria-hidden="true" tabindex="-1"></a>    \text{Ef}_{jt} = \Big(1 - \text{exp}\big(\gamma_{0j}+\gamma_{1j} \times X_{t}\big)\Big) \times 100</span>
<span id="cb8-227"><a href="#cb8-227" aria-hidden="true" tabindex="-1"></a>$$ {#eq-Efficacy}</span>
<span id="cb8-228"><a href="#cb8-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-229"><a href="#cb8-229" aria-hidden="true" tabindex="-1"></a>The quantity $\text{Ef}_{jt}$ corresponds to the expected percentage reduction of pest individuals (aphid numbers) for the jth treatment compared to the untreated group, over trials and blocks. </span>
<span id="cb8-230"><a href="#cb8-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-231"><a href="#cb8-231" aria-hidden="true" tabindex="-1"></a>Our Poisson log linear model includes an additive random dispersion term associated to each individual observation ($\epsilon_{ijkt}$ in @eq-model_lambda). This is a standard and well-recognized approach to deal with over-dispersion (@harrison2014using). In order to check the model assumptions, we performed a posterior predictive check of our model to check that the data were compatible with the model assumptions. Posterior predictive check is frequently used to look for systematic discrepancies between real and simulated data (@gelman1995bayesian). To do so, we computed the probability of exceeding each individual data with the fitted model (@eq-model_lambda). The computed probabilities were all falling in the range 0.22-0.93 (except for the observations equal to 0, for which the probability of being greater was equal to 1), and were thus not extreme. This result indicates that the model specified is not incompatible with the observed data and that the over-dispersion was correctly taken into account. In addition, we fitted another model including a negative binomial distribution instead of a Poisson distribution. The results were almost identical between the two models.</span>
<span id="cb8-232"><a href="#cb8-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-233"><a href="#cb8-233" aria-hidden="true" tabindex="-1"></a><span class="fu">### Inference on real data</span></span>
<span id="cb8-234"><a href="#cb8-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-235"><a href="#cb8-235" aria-hidden="true" tabindex="-1"></a>The model parameters were estimated using Bayesian inference with a Markov chain Monte-Carlo method. We performed the inference using R, with the package rjags (@rjags). For each of the six dataset listed in Table 2, we fitted the model (@eq-model_lambda - @eq-model_Z) with the following weakly informative priors: $\mathcal{N}(0, 10^3)$ for the parameters $\alpha_0,\ \gamma_0,\ \alpha_1,\ \gamma_1$ and $\mathcal{U}(<span class="co">[</span><span class="ot">0, 10</span><span class="co">]</span>)$ for the parameters $\sigma_0, \chi, \eta$. We used two Markov chains with $2 \times 10^5$ iterations (after an adaptating phase of $10^5$ iterations), and we centered the time variable $t$ to facilitate convergence.</span>
<span id="cb8-236"><a href="#cb8-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-237"><a href="#cb8-237" aria-hidden="true" tabindex="-1"></a>The convergence of the MCMC algorithm was checked by inspecting the mixing of the two Markov chains and monitoring the Gelman-Rubin diagnosis statistics (@gelman1992inference). We then computed the posterior mean of the pesticide treatment efficacy (defined by @eq-Efficacy) as well as its 95% credibility interval. The code used to fit the model is provided below.</span>
<span id="cb8-238"><a href="#cb8-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-239"><a href="#cb8-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-240"><a href="#cb8-240" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb8-241"><a href="#cb8-241" aria-hidden="true" tabindex="-1"></a>The following code presents the inference on an extract of the real dataset, which includes both trials of figure 1B (2020 - B1A97 ; 2020 - u1CwE). It is  a demo for the "50% Y - 50% Z" scenario and we set here the number of adaptation and iteration to 2000 in order to reduce computation time.</span>
<span id="cb8-242"><a href="#cb8-242" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb8-243"><a href="#cb8-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-244"><a href="#cb8-244" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb8-245"><a href="#cb8-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r inference_example_real_data, cache = FALSE, results = 'hide'}</span></span>
<span id="cb8-246"><a href="#cb8-246" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb8-247"><a href="#cb8-247" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb8-248"><a href="#cb8-248" aria-hidden="true" tabindex="-1"></a><span class="in">#| file: scripts/inference_example_real_data.R</span></span>
<span id="cb8-249"><a href="#cb8-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-250"><a href="#cb8-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-251"><a href="#cb8-251" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb8-252"><a href="#cb8-252" aria-hidden="true" tabindex="-1"></a>In practice, it is common that only $Y$ or $Z$ data are available in some of the trials. In this case, the resulting dataset includes observations of $Y$ in some trials and observations of $Z$ in others. The dataset may even include one type of observations only, either $Y$ or $Z$, in all trials. Here, we define four scenarios with contrasted levels of $Y$ and $Z$ availability in order to evaluate the consequences of using different types of datasets. We consider four data subsets defined from the real dataset including trials with observations of $Y$, with observations of $Z$, or with both types of observation in different proportions (Table 2). The data subset "100% Y - 0% Z" includes Y data collected in the 32 trials. The data subset "50% Y - 0% Z" includes Y data collected in the 17 trials for which no Z observation is available. The data subset "0% Y - 50% Z" includes the Z data collected in the 15 trials for which Z observations are available. The data subset "50% Y - 50% Z" includes $Y$ data collected in 17 trials and $Z$ data collected in the other 15 trials. The latter data subset does not include any trial reporting both $Y$ and $Z$ data. Throughout our analysis, missing data were assumed to be missing at random.</span>
<span id="cb8-253"><a href="#cb8-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-254"><a href="#cb8-254" aria-hidden="true" tabindex="-1"></a>The hierarchical model defined above is fitted to each dataset in turn. Each fitted model is then used to compute the posterior mean and 95% credibility interval of $Ef_{jt}$ for each treatment at $t$=6 and 12 days after pesticide application. </span>
<span id="cb8-255"><a href="#cb8-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-256"><a href="#cb8-256" aria-hidden="true" tabindex="-1"></a>| Type of dataset | Description |</span>
<span id="cb8-257"><a href="#cb8-257" aria-hidden="true" tabindex="-1"></a>|---------|:-----|</span>
<span id="cb8-258"><a href="#cb8-258" aria-hidden="true" tabindex="-1"></a>| 100% Y - 0% Z      | Y observations available in the 32 trials and no Z  |</span>
<span id="cb8-259"><a href="#cb8-259" aria-hidden="true" tabindex="-1"></a>| 50% Y - 0% Z     | Y observations available in 17 trials and no Z  | </span>
<span id="cb8-260"><a href="#cb8-260" aria-hidden="true" tabindex="-1"></a>| 0% Y - 50% Z       | Z observations available in 15 trials and no Y    | </span>
<span id="cb8-261"><a href="#cb8-261" aria-hidden="true" tabindex="-1"></a>| 50% Y - 50% Z       | Y observations available in 17 trials and Z observations available in the other 15 trials   | </span>
<span id="cb8-262"><a href="#cb8-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-263"><a href="#cb8-263" aria-hidden="true" tabindex="-1"></a>: Four data subsets defined from the original dataset (real data). {tbl-colwidths="<span class="co">[</span><span class="ot">35,65</span><span class="co">]</span>"}</span>
<span id="cb8-264"><a href="#cb8-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-265"><a href="#cb8-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-266"><a href="#cb8-266" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simulations</span></span>
<span id="cb8-267"><a href="#cb8-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-268"><a href="#cb8-268" aria-hidden="true" tabindex="-1"></a>Simulations are carried out to further investigate the impact of the type and amount of data available on the accuracy of the parameters and the ability of the model to identify the most and least effective treatments. </span>
<span id="cb8-269"><a href="#cb8-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-270"><a href="#cb8-270" aria-hidden="true" tabindex="-1"></a>We define three numbers of trials, equal to 20, 40 and 80, successively. For data simulations, the model parameters are set equal to those estimated from the real dataset "100% Y - 0% Z" defined in Table 2 (posterior means). For each number of trials, we generate virtual data from the model (@eq-model_W - @eq-model_Z) and estimate the model parameters, according to the following procedure:</span>
<span id="cb8-271"><a href="#cb8-271" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb8-272"><a href="#cb8-272" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Draw values of $\beta_{0i},\ u_{ij}$ and $\epsilon_{ijkt}$ in their distributions for each trial, 3 treatments (+ the untreated control), 3 dates ($t$=0, 6, 12), and 4 blocks</span>
<span id="cb8-273"><a href="#cb8-273" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate $\lambda_{ijkt}$ from @eq-model_lambda,</span>
<span id="cb8-274"><a href="#cb8-274" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Draw values of $W_{ijkts}$ in its Poisson distribution for 10 plants ($s$=1, ..., 10)</span>
<span id="cb8-275"><a href="#cb8-275" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate $Y_{ijkt}$ and $Z_{ijkt}$ from the Ws for each trial, treatment, date, block.</span>
<span id="cb8-276"><a href="#cb8-276" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generate the eight data subsets corresponding to the scenarios defined in Table 3 (including all values of $W$, the generated values of $Y$ only, the generated values of $Z$ only, both $Y$ and $Z$ values but not $W$, the values of $Y$ in 50% of the trials, the values of $Z$ in 50% of the trials, the values of $Y$ in 50% of the trials and the values of $Z$ in the other 50%), </span>
<span id="cb8-277"><a href="#cb8-277" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fit the model (@eq-model_W - @eq-model_Z) to each of the data subsets according to the procedure described above based on MCMC. </span>
<span id="cb8-278"><a href="#cb8-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-279"><a href="#cb8-279" aria-hidden="true" tabindex="-1"></a>At the end of this procedure, we get eight sets of estimated parameters, corresponding to the eight scenarios defined in Table 3. </span>
<span id="cb8-280"><a href="#cb8-280" aria-hidden="true" tabindex="-1"></a>This procedure is repeated 1000 times with each time a different seed between 0 and 999. However, the computations performed with jags failed for 26 replicates and thus 974 replicates were available for the analysis.</span>
<span id="cb8-281"><a href="#cb8-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-282"><a href="#cb8-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-283"><a href="#cb8-283" aria-hidden="true" tabindex="-1"></a>For each number of trials and each scenario defined in Table 3, the accuracy of the estimated parameters $\gamma$ (from which depend the treatment efficacies) is evaluated by computing an absolute error, averaged over the three treatments ($j$=1 corresponding to the control) as:</span>
<span id="cb8-284"><a href="#cb8-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-285"><a href="#cb8-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-286"><a href="#cb8-286" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb8-287"><a href="#cb8-287" aria-hidden="true" tabindex="-1"></a>    E_{\gamma} = \frac{1}{2 \times 3}\sum\limits_{j = 2}^{4} \Big( \frac{|\gamma_{0j} - \hat{\gamma}_{0j}|}{|\gamma_{0j}|} + \frac{|\gamma_{1j} - \hat{\gamma}_{1j}|}{|\gamma_{1j}|}\Big)</span>
<span id="cb8-288"><a href="#cb8-288" aria-hidden="true" tabindex="-1"></a>$$ {#eq-E_gamma}</span>
<span id="cb8-289"><a href="#cb8-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-290"><a href="#cb8-290" aria-hidden="true" tabindex="-1"></a>where the true parameter values are set equal to the posterior means computed with the real dataset, and the parameter estimates ($\hat{\gamma}_{0j}$ and $\hat{\gamma}_{1j}$) are the posterior means computed for the jth treatment. For each trial number and each scenario defined in Table 3, the 974 values of $E_{\gamma}$ obtained for the 974 generated data subsets are then averaged. The average values obtained for the eight scenarios are finally compared to determine the type of data leading to the most accurate estimated parameter values. </span>
<span id="cb8-291"><a href="#cb8-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-292"><a href="#cb8-292" aria-hidden="true" tabindex="-1"></a>In addition, we compare the eight scenarios according to another criterion measuring the difference between the estimated efficacy values and the true efficacy value (averaged over the three pesticide treatments considered), as follows:</span>
<span id="cb8-293"><a href="#cb8-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-294"><a href="#cb8-294" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb8-295"><a href="#cb8-295" aria-hidden="true" tabindex="-1"></a>    E_{\text{Ef}_{t}}\ = \frac{1}{3} \sum\limits_{j = 2}^4 \frac{|\text{Ef}_{jt} - \hat{\text{Ef}}_{jt}|} {|\text{Ef}_{jt}|}</span>
<span id="cb8-296"><a href="#cb8-296" aria-hidden="true" tabindex="-1"></a>$$ {#eq-E_efficacy}  </span>
<span id="cb8-297"><a href="#cb8-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-298"><a href="#cb8-298" aria-hidden="true" tabindex="-1"></a>where the true treatment efficacy is defined by @eq-Efficacy (setting the parameters $\gamma$s to the posterior means obtained with the real dataset) and the estimated efficacy ($\hat{\text{Ef}}_{jt}$) is the posterior mean computed with the simulated dataset. The 974 values of $E_{\text{Eft}}$ obtained from the 974 simulated datasets are then averaged for each trial number and each scenario. Finally, we evaluate the proportions of cases where the true best treatment (i.e., the treatment with the highest efficacy) is correctly identified.</span>
<span id="cb8-299"><a href="#cb8-299" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-300"><a href="#cb8-300" aria-hidden="true" tabindex="-1"></a>In order to determine whether the difference of performance obtained with the types of data $Y$ and $Z$ depends on the pest abundance, we perform an additional series of simulations with three values for the model parameter $\alpha_0$, equal to $-1,\ 1$ and $2$, successively. These three values of $\alpha_0$ define three contrasted levels of pest abundance (the higher $\alpha_0$, the higher the abundance). We used the procedure outlined above considering only two scenarios of data availability, namely "100% Y - 0% Z" and "0% Y - 100% Z". This procedure is implemented with each value of $\alpha_0$ in turn. The results are used to compare the model performances using either $Y$ or $Z$ for parameter estimation, depending of the pest abundance specified by $\alpha_0$. </span>
<span id="cb8-301"><a href="#cb8-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-302"><a href="#cb8-302" aria-hidden="true" tabindex="-1"></a>|Type of dataset| Description|</span>
<span id="cb8-303"><a href="#cb8-303" aria-hidden="true" tabindex="-1"></a>|---|---|</span>
<span id="cb8-304"><a href="#cb8-304" aria-hidden="true" tabindex="-1"></a>|100% W | W observations available in all the trials| </span>
<span id="cb8-305"><a href="#cb8-305" aria-hidden="true" tabindex="-1"></a>|100% Y - 0% Z | Y observations available in all the trials|</span>
<span id="cb8-306"><a href="#cb8-306" aria-hidden="true" tabindex="-1"></a>|0% Y - 100% Z | Z observations available in all the trials|</span>
<span id="cb8-307"><a href="#cb8-307" aria-hidden="true" tabindex="-1"></a>|100% Y - 100% Z | Y and Z observations available in all the trials|</span>
<span id="cb8-308"><a href="#cb8-308" aria-hidden="true" tabindex="-1"></a>|50% Y - 0% Z | Y observations available in half of the trials|</span>
<span id="cb8-309"><a href="#cb8-309" aria-hidden="true" tabindex="-1"></a>|0% Y - 50% Z | Z observations available in half of the trials|</span>
<span id="cb8-310"><a href="#cb8-310" aria-hidden="true" tabindex="-1"></a>|50% Y - 50% Z | Y observations available in half of the trials and Z observations available in the other half of the trials|</span>
<span id="cb8-311"><a href="#cb8-311" aria-hidden="true" tabindex="-1"></a>|50% Y - 100% Z | Y observations available in half of the trials and Z observations available in all the trials|</span>
<span id="cb8-312"><a href="#cb8-312" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb8-313"><a href="#cb8-313" aria-hidden="true" tabindex="-1"></a>: Eight scenarios compared using simulated data. {tbl-colwidths="<span class="co">[</span><span class="ot">35,65</span><span class="co">]</span>"}</span>
<span id="cb8-314"><a href="#cb8-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-315"><a href="#cb8-315" aria-hidden="true" tabindex="-1"></a>These simulations required a significant amount of computation time and were conducted on the INRAE MIGALE server. For a single seed and 20 trials, the computations took 80 minutes on a computer with an Intel Core i7 processor running at 1.90 GHz and 32 GB of RAM. The code used to perform them is presented below.</span>
<span id="cb8-316"><a href="#cb8-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-317"><a href="#cb8-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r simulation-function, cache = FALSE}</span></span>
<span id="cb8-318"><a href="#cb8-318" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb8-319"><a href="#cb8-319" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true </span></span>
<span id="cb8-320"><a href="#cb8-320" aria-hidden="true" tabindex="-1"></a><span class="in">#| file: functions/simu_data.R </span></span>
<span id="cb8-321"><a href="#cb8-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-322"><a href="#cb8-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-323"><a href="#cb8-323" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb8-324"><a href="#cb8-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-325"><a href="#cb8-325" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb8-326"><a href="#cb8-326" aria-hidden="true" tabindex="-1"></a>The following code presents the inference for one seed. As the computing time is growing fast with the number of trials and the number of sampled values, we set here the number of trials to 10 (I = 10) and the number of adaptations and iterations to 2000.</span>
<span id="cb8-327"><a href="#cb8-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-328"><a href="#cb8-328" aria-hidden="true" tabindex="-1"></a>Our simulation results are obtained by running this code for I = 10, 20, 40, 80, for all seeds between 0 and 999, with a number of adaptations and iterations equal to 36000.</span>
<span id="cb8-329"><a href="#cb8-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-330"><a href="#cb8-330" aria-hidden="true" tabindex="-1"></a>Scenarios "50% Y - 0% Z" and "0% Y - 50% Z" are obtained from scenarios "100% Y - 0% Z" and "0% Y - 100% Z", respectively. For example "50% Y - 0% Z" scenario with 40 trials corresponds to "100% Y - 0% Z" with 20 trials.</span>
<span id="cb8-331"><a href="#cb8-331" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb8-332"><a href="#cb8-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-333"><a href="#cb8-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-334"><a href="#cb8-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-335"><a href="#cb8-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-336"><a href="#cb8-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r simulations, results = 'hide', cache = FALSE}</span></span>
<span id="cb8-337"><a href="#cb8-337" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb8-338"><a href="#cb8-338" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb8-339"><a href="#cb8-339" aria-hidden="true" tabindex="-1"></a><span class="in">#| file: scripts/simulations.R</span></span>
<span id="cb8-340"><a href="#cb8-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-341"><a href="#cb8-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-342"><a href="#cb8-342" aria-hidden="true" tabindex="-1"></a><span class="fu"># Results</span></span>
<span id="cb8-343"><a href="#cb8-343" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results obtained with real data</span></span>
<span id="cb8-344"><a href="#cb8-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-345"><a href="#cb8-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load_res_real_data, cache = FALSE, echo = FALSE}</span></span>
<span id="cb8-346"><a href="#cb8-346" aria-hidden="true" tabindex="-1"></a><span class="in">resY = readRDS(file = "Files_for_code/Results/Real_data/res.Y.nadapt.150000.niter.3e+05.rds")</span></span>
<span id="cb8-347"><a href="#cb8-347" aria-hidden="true" tabindex="-1"></a><span class="in">resYZ = readRDS(file = "Files_for_code/Results/Real_data/res.YhalfZhalf.nadapt.150000.niter.3e+05.rds") </span></span>
<span id="cb8-348"><a href="#cb8-348" aria-hidden="true" tabindex="-1"></a><span class="in">resYhalf = readRDS(file = "Files_for_code/Results/Real_data/res.Yhalf.nadapt.150000.niter.3e+05.rds")  </span></span>
<span id="cb8-349"><a href="#cb8-349" aria-hidden="true" tabindex="-1"></a><span class="in">resZhalf = readRDS(file = "Files_for_code/Results/Real_data/res.Zhalf.nadapt.150000.niter.3e+05.rds") </span></span>
<span id="cb8-350"><a href="#cb8-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-351"><a href="#cb8-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-352"><a href="#cb8-352" aria-hidden="true" tabindex="-1"></a>We present here the results obtained with real data. First, we check the convergence of the model for the scenarios defined in Table 2. We then compare the estimated values and the credibility intervals of the treatment efficacy obtained in the different scenarios.</span>
<span id="cb8-353"><a href="#cb8-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-354"><a href="#cb8-354" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model convergence and posterior distributions</span></span>
<span id="cb8-355"><a href="#cb8-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-356"><a href="#cb8-356" aria-hidden="true" tabindex="-1"></a>@fig-two presents the Markov chains associated with the model parameters and treatment efficacies for the different scenarios. The x-axis presents the iteration number and the y-axis presents the sampled value. Results show that the chains are well mixed. @fig-three presents the Gelman-Rubin statistics associated with the model parameters and treatement efficacies as a function of the iterations, for the different scenarios. We observe that this statistics converges to 1, which indicates the convergence of the algorithm.</span>
<span id="cb8-357"><a href="#cb8-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-358"><a href="#cb8-358" aria-hidden="true" tabindex="-1"></a>Table 4 gives a summary of the posterior distributions of the model parameters and treatment efficacies obtained for the "100% Y - 0% Z" scenario. The significantly positive value of $\alpha_1$ indicates that the aphid numbers tend to increase with time in untreated plots. The relatively high value of $\sigma_0$ (posterior mean equal to 1.87) reveals a strong variability in aphid numbers between trials. The posterior mean value of $\chi$ (0.27) suggests that the treatment efficacy varies across trials. The $\gamma_0$ parameter is negative for all three treatments, indicating a negative effect of the treatments on the aphid numbers at the time of pesticide spray. The Movento and Teppeki treatments have a similar effect with a posterior mean for $\gamma_0$ equal to -1.13 and -1.24, and a standard deviation equal to 0.12 and 0.11, respectively. The effect of treatment Mavrik Jet is weaker as its posterior mean for $\gamma_0$ is equal to -0.13 and its standard deviation is equal to 0.16. The $\gamma_1$ posterior means are negative for Movento and Teppeki (-0.14 and -0.15), suggesting that the effect of these treatments tend to increase with time, but the posterior mean value is positive for Mavrik Jet (= 0.24), suggesting that the effect of this treatment may decrease with time. However, the 95% credibility intervals of $\gamma_1$ include zero and these parameters are not very accurately estimated.</span>
<span id="cb8-359"><a href="#cb8-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-360"><a href="#cb8-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-361"><a href="#cb8-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-362"><a href="#cb8-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r figure2, cache = FALSE, out.width="100%", fig.height = 7, echo = FALSE}</span></span>
<span id="cb8-363"><a href="#cb8-363" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-two</span></span>
<span id="cb8-364"><a href="#cb8-364" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Model convergence - Markov chain for the model parameters and treatment efficacies, in the scenarios '50% Y - 0% Z' (**A**),  '50% Y - 50% Z' (**B**), '100% Y - 0% Z' (**C**) and '0% Y - 50% Z' (**D**). The x-axis presents the iteration number and the y-axis presents the sampled value."</span></span>
<span id="cb8-365"><a href="#cb8-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-366"><a href="#cb8-366" aria-hidden="true" tabindex="-1"></a><span class="in">source(file = "functions/plot_chains.R")</span></span>
<span id="cb8-367"><a href="#cb8-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-368"><a href="#cb8-368" aria-hidden="true" tabindex="-1"></a><span class="in">options(warn = - 1)</span></span>
<span id="cb8-369"><a href="#cb8-369" aria-hidden="true" tabindex="-1"></a><span class="in">col_background = "#e9e9e9";   col_text = "black"</span></span>
<span id="cb8-370"><a href="#cb8-370" aria-hidden="true" tabindex="-1"></a><span class="in">cex = 0.85</span></span>
<span id="cb8-371"><a href="#cb8-371" aria-hidden="true" tabindex="-1"></a><span class="in">nrow = 3</span></span>
<span id="cb8-372"><a href="#cb8-372" aria-hidden="true" tabindex="-1"></a><span class="in">nbreaks = 3</span></span>
<span id="cb8-373"><a href="#cb8-373" aria-hidden="true" tabindex="-1"></a><span class="in">strip_size = 5</span></span>
<span id="cb8-374"><a href="#cb8-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-375"><a href="#cb8-375" aria-hidden="true" tabindex="-1"></a><span class="in">fig2A = suppressMessages(plot_chains(resYhalf, nrow = nrow) + ylab("Sampled value") + scale_x_continuous(breaks = c(0, 1.5e4, 3e4))) + xlab("") +</span></span>
<span id="cb8-376"><a href="#cb8-376" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(n.breaks = nbreaks) + theme(strip.text = element_text(size = strip_size))</span></span>
<span id="cb8-377"><a href="#cb8-377" aria-hidden="true" tabindex="-1"></a><span class="in">my_g2A &lt;- grobTree(rectGrob(gp = gpar(fill = col_background)), textGrob("A", x = 0.5, hjust = 0.5, gp = gpar(col = col_text, cex = cex, fontface = "bold")))</span></span>
<span id="cb8-378"><a href="#cb8-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-379"><a href="#cb8-379" aria-hidden="true" tabindex="-1"></a><span class="in">fig2B = suppressMessages(plot_chains(resYZ, nrow = nrow) + ylab("Sampled value") + scale_x_continuous(breaks = c(0, 1.5e4, 3e4))) + xlab("") +</span></span>
<span id="cb8-380"><a href="#cb8-380" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(n.breaks = nbreaks) + theme(strip.text = element_text(size = strip_size))</span></span>
<span id="cb8-381"><a href="#cb8-381" aria-hidden="true" tabindex="-1"></a><span class="in">my_g2B &lt;- grobTree(rectGrob(gp = gpar(fill = col_background)), textGrob("B", x = 0.5, hjust = 0.5, gp = gpar(col = col_text, cex = cex, fontface = "bold")))</span></span>
<span id="cb8-382"><a href="#cb8-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-383"><a href="#cb8-383" aria-hidden="true" tabindex="-1"></a><span class="in">fig2C = suppressMessages(plot_chains(resY, nrow = nrow) + ylab("Sampled value") + scale_x_continuous(breaks = c(0, 1.5e4, 3e4))) + xlab("") +</span></span>
<span id="cb8-384"><a href="#cb8-384" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(n.breaks = nbreaks) + theme(strip.text = element_text(size = strip_size))</span></span>
<span id="cb8-385"><a href="#cb8-385" aria-hidden="true" tabindex="-1"></a><span class="in">my_g2C &lt;- grobTree(rectGrob(gp = gpar(fill = col_background)), textGrob("C", x = 0.5, hjust = 0.5, gp = gpar(col = col_text, cex = cex, fontface = "bold")))</span></span>
<span id="cb8-386"><a href="#cb8-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-387"><a href="#cb8-387" aria-hidden="true" tabindex="-1"></a><span class="in">fig2D = suppressMessages(plot_chains(resZhalf, nrow = nrow) + ylab("Sampled value") + scale_x_continuous(breaks = c(0, 1.5e4, 3e4))) +</span></span>
<span id="cb8-388"><a href="#cb8-388" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(n.breaks = nbreaks) + theme(strip.text = element_text(size = strip_size), axis.title.x = element_text(margin = margin(t = 5)))</span></span>
<span id="cb8-389"><a href="#cb8-389" aria-hidden="true" tabindex="-1"></a><span class="in">my_g2D &lt;- grobTree(rectGrob(gp = gpar(fill = col_background)), textGrob("D", x = 0.5, hjust = 0.5, gp = gpar(col = col_text, cex = cex, fontface = "bold")))</span></span>
<span id="cb8-390"><a href="#cb8-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-391"><a href="#cb8-391" aria-hidden="true" tabindex="-1"></a><span class="in">grid.arrange(my_g2A, fig2A, my_g2B, fig2B, my_g2C, fig2C, my_g2D, fig2D, heights = c(1,9,1,9,1,9,1,10))</span></span>
<span id="cb8-392"><a href="#cb8-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-393"><a href="#cb8-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-394"><a href="#cb8-394" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb8-395"><a href="#cb8-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-396"><a href="#cb8-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r figure3, cache = FALSE, out.width="100%", fig.height = 7, echo = FALSE}</span></span>
<span id="cb8-397"><a href="#cb8-397" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-three</span></span>
<span id="cb8-398"><a href="#cb8-398" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Model convergence - Gelman-Rubin statistics for the parameters of the model (@eq-model_W - @eq-model_Z) and for treatment efficacies (@eq-Efficacy), according to the scenarios '50% Y - 0% Z' (**A**),  '50% Y - 50% Z' (**B**), '100% Y - 0% Z' (**C**) and '0% Y - 50% Z' (**D**). The x-axis presents the iteration number and the y-axis presents the Gelman-Rubin statistic."</span></span>
<span id="cb8-399"><a href="#cb8-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-400"><a href="#cb8-400" aria-hidden="true" tabindex="-1"></a><span class="in">source(file = "functions/gelman.plot2.R")</span></span>
<span id="cb8-401"><a href="#cb8-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-402"><a href="#cb8-402" aria-hidden="true" tabindex="-1"></a><span class="in">margey = 5</span></span>
<span id="cb8-403"><a href="#cb8-403" aria-hidden="true" tabindex="-1"></a><span class="in">margex = 10</span></span>
<span id="cb8-404"><a href="#cb8-404" aria-hidden="true" tabindex="-1"></a><span class="in">ncol = 9</span></span>
<span id="cb8-405"><a href="#cb8-405" aria-hidden="true" tabindex="-1"></a><span class="in">strip_size = 5</span></span>
<span id="cb8-406"><a href="#cb8-406" aria-hidden="true" tabindex="-1"></a><span class="in">breaks = c(1, 3, 5);   limits = c(1, 5)</span></span>
<span id="cb8-407"><a href="#cb8-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-408"><a href="#cb8-408" aria-hidden="true" tabindex="-1"></a><span class="in">fig3A = gelman.plot2(resYhalf, ncol = ncol) + </span></span>
<span id="cb8-409"><a href="#cb8-409" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_continuous(breaks = c(2e5, 4e5)) + xlab("") +</span></span>
<span id="cb8-410"><a href="#cb8-410" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(limits = limits, breaks = breaks) +</span></span>
<span id="cb8-411"><a href="#cb8-411" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(axis.title.y = element_text(margin = margin(l = - margey, r = margey)), legend.position = "none", strip.text = element_text(size = strip_size))</span></span>
<span id="cb8-412"><a href="#cb8-412" aria-hidden="true" tabindex="-1"></a><span class="in">my_g3A &lt;- grobTree(rectGrob(gp = gpar(fill = col_background)), textGrob("A", x = 0.5, hjust = 0.5, gp = gpar(col = col_text, cex = cex, fontface = "bold")))</span></span>
<span id="cb8-413"><a href="#cb8-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-414"><a href="#cb8-414" aria-hidden="true" tabindex="-1"></a><span class="in">fig3B = gelman.plot2(resYZ, ncol = ncol) + </span></span>
<span id="cb8-415"><a href="#cb8-415" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_continuous(breaks = c(2e5, 4e5)) + xlab("") +   </span></span>
<span id="cb8-416"><a href="#cb8-416" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(limits = limits, breaks = breaks) +</span></span>
<span id="cb8-417"><a href="#cb8-417" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(axis.title.y = element_text(margin = margin(l = - margey, r = margey)), legend.position = "none", strip.text = element_text(size = strip_size))</span></span>
<span id="cb8-418"><a href="#cb8-418" aria-hidden="true" tabindex="-1"></a><span class="in">my_g3B &lt;- grobTree(rectGrob(gp = gpar(fill = col_background)), textGrob("B", x = 0.5, hjust = 0.5, gp = gpar(col = col_text, cex = cex, fontface = "bold")))</span></span>
<span id="cb8-419"><a href="#cb8-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-420"><a href="#cb8-420" aria-hidden="true" tabindex="-1"></a><span class="in">fig3C = gelman.plot2(resY, ncol = ncol) + </span></span>
<span id="cb8-421"><a href="#cb8-421" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_continuous(breaks = c(2e5, 4e5)) + xlab("") +    </span></span>
<span id="cb8-422"><a href="#cb8-422" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(limits = limits, breaks = breaks) +</span></span>
<span id="cb8-423"><a href="#cb8-423" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(axis.title.y = element_text(margin = margin(l = - margey, r = margey)), legend.position = "none", strip.text = element_text(size = strip_size)) </span></span>
<span id="cb8-424"><a href="#cb8-424" aria-hidden="true" tabindex="-1"></a><span class="in">my_g3C &lt;- grobTree(rectGrob(gp = gpar(fill = col_background)), textGrob("C", x = 0.5, hjust = 0.5, gp = gpar(col = col_text, cex = cex, fontface = "bold")))</span></span>
<span id="cb8-425"><a href="#cb8-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-426"><a href="#cb8-426" aria-hidden="true" tabindex="-1"></a><span class="in">fig3D = gelman.plot2(resZhalf, ncol = ncol) + </span></span>
<span id="cb8-427"><a href="#cb8-427" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_continuous(breaks = c(2e5, 4e5))  + xlab("") +       </span></span>
<span id="cb8-428"><a href="#cb8-428" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(limits = limits, breaks = breaks) +</span></span>
<span id="cb8-429"><a href="#cb8-429" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(axis.title.y = element_text(margin = margin(l = - margey, r = margey)), strip.text = element_text(size = strip_size), plot.margin = margin(b = - 5, t = 6, r = 6, l = 6)) </span></span>
<span id="cb8-430"><a href="#cb8-430" aria-hidden="true" tabindex="-1"></a><span class="in">my_g3D &lt;- grobTree(rectGrob(gp = gpar(fill = col_background)), textGrob("D", x = 0.5, hjust = 0.5, gp = gpar(col = col_text, cex = cex, fontface = "bold")))</span></span>
<span id="cb8-431"><a href="#cb8-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-432"><a href="#cb8-432" aria-hidden="true" tabindex="-1"></a><span class="in">x_axis &lt;- grobTree(textGrob("Last iteration in chain", x = 0.5, hjust = 0.5, gp = gpar(cex = 0.7)))</span></span>
<span id="cb8-433"><a href="#cb8-433" aria-hidden="true" tabindex="-1"></a><span class="in">legend = cowplot::get_legend(fig3D)</span></span>
<span id="cb8-434"><a href="#cb8-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-435"><a href="#cb8-435" aria-hidden="true" tabindex="-1"></a><span class="in">grid.arrange(my_g3A, fig3A, my_g3B, fig3B, my_g3C, fig3C, my_g3D, fig3D + theme(legend.position = "none"), x_axis, legend, heights = c(1,9,1,9,1,9,1,9, 1, 2))</span></span>
<span id="cb8-436"><a href="#cb8-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-437"><a href="#cb8-437" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb8-438"><a href="#cb8-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-439"><a href="#cb8-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-440"><a href="#cb8-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r table4, cache = FALSE}</span></span>
<span id="cb8-441"><a href="#cb8-441" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb8-442"><a href="#cb8-442" aria-hidden="true" tabindex="-1"></a><span class="in">tab4 = cbind(summary(resY)$statistics, summary(resY)$quantiles) %&gt;% </span></span>
<span id="cb8-443"><a href="#cb8-443" aria-hidden="true" tabindex="-1"></a><span class="in">    as.data.frame %&gt;%</span></span>
<span id="cb8-444"><a href="#cb8-444" aria-hidden="true" tabindex="-1"></a><span class="in">    rownames_to_column(var = "Parameter") %&gt;% select(- c(4, 5, c(7 : 9))) %&gt;%</span></span>
<span id="cb8-445"><a href="#cb8-445" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Parameter = recode(Parameter, "gamma0[1]" = "gamma0 - untreated", "gamma0[2]" = "gamma0 - Mavrik Jet",</span></span>
<span id="cb8-446"><a href="#cb8-446" aria-hidden="true" tabindex="-1"></a><span class="in">                                         "gamma0[3]" = "gamma0 - Movento", "gamma0[4]" = "gamma0 - Teppeki",</span></span>
<span id="cb8-447"><a href="#cb8-447" aria-hidden="true" tabindex="-1"></a><span class="in">                                          "gamma1[1]" = "gamma1 - untreated", "gamma1[2]" = "gamma1 - Mavrik Jet",</span></span>
<span id="cb8-448"><a href="#cb8-448" aria-hidden="true" tabindex="-1"></a><span class="in">                                         "gamma1[3]" = "gamma1 - Movento", "gamma1[4]" = "gamma1 - Teppeki"  )) %&gt;%</span></span>
<span id="cb8-449"><a href="#cb8-449" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(!grepl("Eff", Parameter)) %&gt;%</span></span>
<span id="cb8-450"><a href="#cb8-450" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb8-451"><a href="#cb8-451" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Parameter = recode(Parameter, "alpha0" = "\u03B1\u2080",</span></span>
<span id="cb8-452"><a href="#cb8-452" aria-hidden="true" tabindex="-1"></a><span class="in">                                         "alpha1" = "\u03B1\u2081",</span></span>
<span id="cb8-453"><a href="#cb8-453" aria-hidden="true" tabindex="-1"></a><span class="in">                                         "chi" = "\u03C7",</span></span>
<span id="cb8-454"><a href="#cb8-454" aria-hidden="true" tabindex="-1"></a><span class="in">                                         "eta" = "\u03B7",</span></span>
<span id="cb8-455"><a href="#cb8-455" aria-hidden="true" tabindex="-1"></a><span class="in">                                         "sigma0" = "\u03C3\u2080")) %&gt;%</span></span>
<span id="cb8-456"><a href="#cb8-456" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Parameter = gsub(x = Parameter, pattern = "gamma0", replacement = "\u03B3\u2080")) %&gt;%</span></span>
<span id="cb8-457"><a href="#cb8-457" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Parameter = gsub(x = Parameter, pattern = "gamma1", replacement = "\u03B3\u2081")) %&gt;%</span></span>
<span id="cb8-458"><a href="#cb8-458" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate_if(is.numeric, round, 2)</span></span>
<span id="cb8-459"><a href="#cb8-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-460"><a href="#cb8-460" aria-hidden="true" tabindex="-1"></a><span class="in"># re-ordering the parameters</span></span>
<span id="cb8-461"><a href="#cb8-461" aria-hidden="true" tabindex="-1"></a><span class="in">tab4 = tab4[c(c(1 : 2), 13, c(3 : 12)), ]</span></span>
<span id="cb8-462"><a href="#cb8-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-463"><a href="#cb8-463" aria-hidden="true" tabindex="-1"></a><span class="in">rownames(tab4) = NULL</span></span>
<span id="cb8-464"><a href="#cb8-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-465"><a href="#cb8-465" aria-hidden="true" tabindex="-1"></a><span class="in">tab4 %&gt;% </span></span>
<span id="cb8-466"><a href="#cb8-466" aria-hidden="true" tabindex="-1"></a><span class="in">  kbl(booktabs = TRUE, caption = "Summary of the posterior distributions obtained with the 100\\% Y - 0\\% Z scenario for the model parameters and treatment efficacies: posterior mean, standard deviation, 2.5 and 97.5 quantiles.") %&gt;%</span></span>
<span id="cb8-467"><a href="#cb8-467" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling()</span></span>
<span id="cb8-468"><a href="#cb8-468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-469"><a href="#cb8-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-470"><a href="#cb8-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-471"><a href="#cb8-471" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimated values of pesticide treatment efficacies</span></span>
<span id="cb8-472"><a href="#cb8-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-473"><a href="#cb8-473" aria-hidden="true" tabindex="-1"></a>@fig-four presents the posterior means and the 95% credibility intervals of treatment efficacies at 6 days (A) and 12 days (B) after pesticide spray, for the "100% Y - 0% Z", "50% Y - 50% Z", "50% Y - 0% Z" and "0% Y - 50% Z" scenarios. Different scenarios are indicated by different colors. The x-axis presents the efficacy and the y-axis presents the treatments. Overall, the results obtained are consistent across scenarios; Teppeki and Movento show higher mean efficacies than Mavrik Jet, and the credibility intervals are narrower for Teppeki and Movento than for Mavrik Jet in all scenarios. The credibility interval of the "100% Y - 0% Z" scenario is narrower than that of the "50% Y - 50% Z" scenario, which is itself narrower than that of the "50% Y - 0% Z" and "0% Y - 50% Z" scenarios. Table 5 quantifies the differences in the sizes of the credibility intervals and present the reduction percentage in the credibility interval sizes of the "100% Y - 0% Z", "50% Y - 50% Z" and "0% Y - 50% Z" scenarios, compared to the "50% Y - 0% Z" scenario, for all the treatment efficacies at 6 days (third column) and at 12 days (fourth column) after pesticide spray. A positive (negative) value corresponds to an increase (decrease) of the credibility interval size compared to "50% Y - 0% Z". For example, the credibility interval size obtained for the efficacy of Movento at 6 days is 40.5% smaller with the "100% Y - 0% Z" scenario than with the "50% Y - 0% Z" scenario. Overall, the credibility interval sizes obtained with the "100% Y - 0% Z" scenario are 25 to 45% smaller than those obtained with the "50% Y - 0% Z" scenario. This indicates that the accuracy of the estimated treatment efficacies is improved by doubling the number of Y observations. Results show that the credibility intervals are often larger with "0% Y - 50% Z" than with "50% Y - 0% Z", suggesting that better esimtations are obtained using Y than Z when only a limited number of data is available, at least in this case study. Interestingly, the sizes of the credibility intervals are smaller by about 25% with "50% Y - 50% Z" compared to "50% Y - 0% Z", showing that the combination of Y and Z observations collected in different trials in beneficial and lead to a reduction of the uncertainty in the estimated treatment efficacy. The latter result illustrates how the estimation of treatment efficacy could be improved by combining trials with prevalence data and trials with intensity data.</span>
<span id="cb8-474"><a href="#cb8-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-475"><a href="#cb8-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r figure4, cache = FALSE, echo=FALSE, out.width = "100%", fig.height = 2.6}</span></span>
<span id="cb8-476"><a href="#cb8-476" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-four</span></span>
<span id="cb8-477"><a href="#cb8-477" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Estimated treatment efficacies after 6 days (**A**) and after 12 days (**B**), with their credibility intervals. Colors correspond to the different scenarios."</span></span>
<span id="cb8-478"><a href="#cb8-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-479"><a href="#cb8-479" aria-hidden="true" tabindex="-1"></a><span class="in">#######################################################################################################################################################</span></span>
<span id="cb8-480"><a href="#cb8-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-481"><a href="#cb8-481" aria-hidden="true" tabindex="-1"></a><span class="in">y1 = 0.075;   y2 = 0.225</span></span>
<span id="cb8-482"><a href="#cb8-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-483"><a href="#cb8-483" aria-hidden="true" tabindex="-1"></a><span class="in"># PR à 6 jours</span></span>
<span id="cb8-484"><a href="#cb8-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-485"><a href="#cb8-485" aria-hidden="true" tabindex="-1"></a><span class="in">df_resY = cbind(summary(resY)$statistics[1 : 3, ], summary(resY)$quantiles[1 : 3, ]) %&gt;%</span></span>
<span id="cb8-486"><a href="#cb8-486" aria-hidden="true" tabindex="-1"></a><span class="in">    as.data.frame %&gt;% select(Mean, `2.5%`, `97.5%`) %&gt;% rownames_to_column("Insecticide") %&gt;%</span></span>
<span id="cb8-487"><a href="#cb8-487" aria-hidden="true" tabindex="-1"></a><span class="in">    pivot_longer(cols = c(3, 4)) %&gt;% rename(P = Mean) %&gt;%</span></span>
<span id="cb8-488"><a href="#cb8-488" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(name = recode(name, `2.5%` = "b_inf", `97.5%` = "b_sup")) %&gt;%</span></span>
<span id="cb8-489"><a href="#cb8-489" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Insecticide = recode(Insecticide, "Eff[2,1]" = "Mavrik Jet", "Eff[3,1]" = "Movento", "Eff[4,1]" = "Teppeki"))</span></span>
<span id="cb8-490"><a href="#cb8-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-491"><a href="#cb8-491" aria-hidden="true" tabindex="-1"></a><span class="in">df_resYZ = cbind(summary(resYZ)$statistics[1 : 3, ], summary(resYZ)$quantiles[1 : 3, ]) %&gt;%</span></span>
<span id="cb8-492"><a href="#cb8-492" aria-hidden="true" tabindex="-1"></a><span class="in">    as.data.frame %&gt;% select(Mean, `2.5%`, `97.5%`) %&gt;% rownames_to_column("Insecticide") %&gt;%</span></span>
<span id="cb8-493"><a href="#cb8-493" aria-hidden="true" tabindex="-1"></a><span class="in">    pivot_longer(cols = c(3, 4)) %&gt;% rename(P = Mean) %&gt;%</span></span>
<span id="cb8-494"><a href="#cb8-494" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(name = recode(name, `2.5%` = "b_inf", `97.5%` = "b_sup")) %&gt;%</span></span>
<span id="cb8-495"><a href="#cb8-495" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Insecticide = recode(Insecticide, "Eff[2,1]" = "Mavrik Jet", "Eff[3,1]" = "Movento", "Eff[4,1]" = "Teppeki"))</span></span>
<span id="cb8-496"><a href="#cb8-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-497"><a href="#cb8-497" aria-hidden="true" tabindex="-1"></a><span class="in">df_resYhalf = cbind(summary(resYhalf)$statistics[1 : 3, ], summary(resYhalf)$quantiles[1 : 3, ]) %&gt;%</span></span>
<span id="cb8-498"><a href="#cb8-498" aria-hidden="true" tabindex="-1"></a><span class="in">    as.data.frame %&gt;% select(Mean, `2.5%`, `97.5%`) %&gt;% rownames_to_column("Insecticide") %&gt;%</span></span>
<span id="cb8-499"><a href="#cb8-499" aria-hidden="true" tabindex="-1"></a><span class="in">    pivot_longer(cols = c(3, 4)) %&gt;% rename(P = Mean) %&gt;%</span></span>
<span id="cb8-500"><a href="#cb8-500" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(name = recode(name, `2.5%` = "b_inf", `97.5%` = "b_sup")) %&gt;%</span></span>
<span id="cb8-501"><a href="#cb8-501" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Insecticide = recode(Insecticide, "Eff[2,1]" = "Mavrik Jet", "Eff[3,1]" = "Movento", "Eff[4,1]" = "Teppeki"))</span></span>
<span id="cb8-502"><a href="#cb8-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-503"><a href="#cb8-503" aria-hidden="true" tabindex="-1"></a><span class="in">df_resZhalf = cbind(summary(resZhalf)$statistics[1 : 3, ], summary(resZhalf)$quantiles[1 : 3, ]) %&gt;%</span></span>
<span id="cb8-504"><a href="#cb8-504" aria-hidden="true" tabindex="-1"></a><span class="in">    as.data.frame %&gt;% select(Mean, `2.5%`, `97.5%`) %&gt;% rownames_to_column("Insecticide") %&gt;%</span></span>
<span id="cb8-505"><a href="#cb8-505" aria-hidden="true" tabindex="-1"></a><span class="in">    pivot_longer(cols = c(3, 4)) %&gt;% rename(P = Mean) %&gt;%</span></span>
<span id="cb8-506"><a href="#cb8-506" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(name = recode(name, `2.5%` = "b_inf", `97.5%` = "b_sup")) %&gt;%</span></span>
<span id="cb8-507"><a href="#cb8-507" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Insecticide = recode(Insecticide, "Eff[2,1]" = "Mavrik Jet", "Eff[3,1]" = "Movento", "Eff[4,1]" = "Teppeki")) </span></span>
<span id="cb8-508"><a href="#cb8-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-509"><a href="#cb8-509" aria-hidden="true" tabindex="-1"></a><span class="in">Order = "binf"</span></span>
<span id="cb8-510"><a href="#cb8-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-511"><a href="#cb8-511" aria-hidden="true" tabindex="-1"></a><span class="in">df_IC = rbind(df_resYhalf %&gt;% mutate(Data = "50% Y - 0% Z"), </span></span>
<span id="cb8-512"><a href="#cb8-512" aria-hidden="true" tabindex="-1"></a><span class="in">              df_resYZ %&gt;% mutate(Data = "50% Y - 50% Z"),</span></span>
<span id="cb8-513"><a href="#cb8-513" aria-hidden="true" tabindex="-1"></a><span class="in">              df_resY %&gt;% mutate(Data = "100% Y - 0% Z"),</span></span>
<span id="cb8-514"><a href="#cb8-514" aria-hidden="true" tabindex="-1"></a><span class="in">              df_resZhalf %&gt;% mutate(Data = "0% Y - 50% Z"))</span></span>
<span id="cb8-515"><a href="#cb8-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-516"><a href="#cb8-516" aria-hidden="true" tabindex="-1"></a><span class="in">prod_rescale = df_resY %&gt;% group_by(Insecticide) %&gt;% summarise(P = ifelse(Order == "moyenne", max(P), min(value))) %&gt;%</span></span>
<span id="cb8-517"><a href="#cb8-517" aria-hidden="true" tabindex="-1"></a><span class="in">                           as.data.frame %&gt;% arrange(P) %&gt;% select(Insecticide) %&gt;% as.matrix %&gt;% as.vector</span></span>
<span id="cb8-518"><a href="#cb8-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-519"><a href="#cb8-519" aria-hidden="true" tabindex="-1"></a><span class="in">x = c(1 : length(prod_rescale));   names(x) = prod_rescale</span></span>
<span id="cb8-520"><a href="#cb8-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-521"><a href="#cb8-521" aria-hidden="true" tabindex="-1"></a><span class="in">df_IC_6 = df_IC %&gt;% mutate(Ordonnee = recode(Insecticide, !!!x)) %&gt;%</span></span>
<span id="cb8-522"><a href="#cb8-522" aria-hidden="true" tabindex="-1"></a><span class="in">                      mutate(Ordonnee = ifelse(Data == "100% Y - 0% Z", Ordonnee + y2, </span></span>
<span id="cb8-523"><a href="#cb8-523" aria-hidden="true" tabindex="-1"></a><span class="in">                                               ifelse(Data == "50% Y - 50% Z", Ordonnee + y1,</span></span>
<span id="cb8-524"><a href="#cb8-524" aria-hidden="true" tabindex="-1"></a><span class="in">                                                      ifelse(Data == "50% Y - 0% Z", Ordonnee - y1, Ordonnee - y2))),</span></span>
<span id="cb8-525"><a href="#cb8-525" aria-hidden="true" tabindex="-1"></a><span class="in">                             jour = "6")     </span></span>
<span id="cb8-526"><a href="#cb8-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-527"><a href="#cb8-527" aria-hidden="true" tabindex="-1"></a><span class="in"># calcul du pourcentage de réduction de l'IC par rapport au scenario 50% Y - 0% Z</span></span>
<span id="cb8-528"><a href="#cb8-528" aria-hidden="true" tabindex="-1"></a><span class="in">df_len = df_IC %&gt;% select(Insecticide, name, value, Data) %&gt;% pivot_wider(names_from =  c(name)) %&gt;% as.data.frame %&gt;%</span></span>
<span id="cb8-529"><a href="#cb8-529" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(IC_length = b_sup - b_inf) %&gt;% arrange(Insecticide)</span></span>
<span id="cb8-530"><a href="#cb8-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-531"><a href="#cb8-531" aria-hidden="true" tabindex="-1"></a><span class="in">df_remp = df_len %&gt;% filter(Data == "50% Y - 0% Z") %&gt;% select(Insecticide, IC_length)</span></span>
<span id="cb8-532"><a href="#cb8-532" aria-hidden="true" tabindex="-1"></a><span class="in">x  = df_remp$IC_length;   names(x) = df_remp$Insecticide</span></span>
<span id="cb8-533"><a href="#cb8-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-534"><a href="#cb8-534" aria-hidden="true" tabindex="-1"></a><span class="in">df_len = df_len %&gt;% mutate(length50pcY = recode(Insecticide, !!!x)) %&gt;%</span></span>
<span id="cb8-535"><a href="#cb8-535" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(`For efficacy at 6 days` = (1 - (IC_length / length50pcY)) * (- 100));   </span></span>
<span id="cb8-536"><a href="#cb8-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-537"><a href="#cb8-537" aria-hidden="true" tabindex="-1"></a><span class="in">df_len6 = df_len %&gt;% rename(Insecticide = Insecticide) %&gt;% select(Insecticide, Data, `For efficacy at 6 days`) %&gt;% </span></span>
<span id="cb8-538"><a href="#cb8-538" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(Data != "50% Y - 0% Z") %&gt;% arrange(Data) %&gt;% mutate_if(is.numeric, round, digits = 1) </span></span>
<span id="cb8-539"><a href="#cb8-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-540"><a href="#cb8-540" aria-hidden="true" tabindex="-1"></a><span class="in">#######################################################################################################################################################</span></span>
<span id="cb8-541"><a href="#cb8-541" aria-hidden="true" tabindex="-1"></a><span class="in"># PR à 12 jours</span></span>
<span id="cb8-542"><a href="#cb8-542" aria-hidden="true" tabindex="-1"></a><span class="in">df_resY = cbind(summary(resY)$statistics[4 : 6, ], summary(resY)$quantiles[4 : 6, ]) %&gt;%</span></span>
<span id="cb8-543"><a href="#cb8-543" aria-hidden="true" tabindex="-1"></a><span class="in">    as.data.frame %&gt;% select(Mean, `2.5%`, `97.5%`) %&gt;% rownames_to_column("Insecticide") %&gt;%</span></span>
<span id="cb8-544"><a href="#cb8-544" aria-hidden="true" tabindex="-1"></a><span class="in">    pivot_longer(cols = c(3, 4)) %&gt;% rename(P = Mean) %&gt;%</span></span>
<span id="cb8-545"><a href="#cb8-545" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(name = recode(name, `2.5%` = "b_inf", `97.5%` = "b_sup")) %&gt;%</span></span>
<span id="cb8-546"><a href="#cb8-546" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Insecticide = recode(Insecticide, "Eff[2,2]" = "Mavrik Jet", "Eff[3,2]" = "Movento", "Eff[4,2]" = "Teppeki"))</span></span>
<span id="cb8-547"><a href="#cb8-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-548"><a href="#cb8-548" aria-hidden="true" tabindex="-1"></a><span class="in">df_resYZ = cbind(summary(resYZ)$statistics[4 : 6, ], summary(resYZ)$quantiles[4 : 6, ]) %&gt;%</span></span>
<span id="cb8-549"><a href="#cb8-549" aria-hidden="true" tabindex="-1"></a><span class="in">    as.data.frame %&gt;% select(Mean, `2.5%`, `97.5%`) %&gt;% rownames_to_column("Insecticide") %&gt;%</span></span>
<span id="cb8-550"><a href="#cb8-550" aria-hidden="true" tabindex="-1"></a><span class="in">    pivot_longer(cols = c(3, 4)) %&gt;% rename(P = Mean) %&gt;%</span></span>
<span id="cb8-551"><a href="#cb8-551" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(name = recode(name, `2.5%` = "b_inf", `97.5%` = "b_sup")) %&gt;%</span></span>
<span id="cb8-552"><a href="#cb8-552" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Insecticide = recode(Insecticide, "Eff[2,2]" = "Mavrik Jet", "Eff[3,2]" = "Movento", "Eff[4,2]" = "Teppeki"))</span></span>
<span id="cb8-553"><a href="#cb8-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-554"><a href="#cb8-554" aria-hidden="true" tabindex="-1"></a><span class="in">df_resYhalf = cbind(summary(resYhalf)$statistics[4 : 6, ], summary(resYhalf)$quantiles[4 : 6, ]) %&gt;%</span></span>
<span id="cb8-555"><a href="#cb8-555" aria-hidden="true" tabindex="-1"></a><span class="in">    as.data.frame %&gt;% select(Mean, `2.5%`, `97.5%`) %&gt;% rownames_to_column("Insecticide") %&gt;%</span></span>
<span id="cb8-556"><a href="#cb8-556" aria-hidden="true" tabindex="-1"></a><span class="in">    pivot_longer(cols = c(3, 4)) %&gt;% rename(P = Mean) %&gt;%</span></span>
<span id="cb8-557"><a href="#cb8-557" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(name = recode(name, `2.5%` = "b_inf", `97.5%` = "b_sup")) %&gt;%</span></span>
<span id="cb8-558"><a href="#cb8-558" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Insecticide = recode(Insecticide, "Eff[2,2]" = "Mavrik Jet", "Eff[3,2]" = "Movento", "Eff[4,2]" = "Teppeki"))</span></span>
<span id="cb8-559"><a href="#cb8-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-560"><a href="#cb8-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-561"><a href="#cb8-561" aria-hidden="true" tabindex="-1"></a><span class="in">df_resZhalf = cbind(summary(resZhalf)$statistics[4 : 6, ], summary(resZhalf)$quantiles[4 : 6, ]) %&gt;%</span></span>
<span id="cb8-562"><a href="#cb8-562" aria-hidden="true" tabindex="-1"></a><span class="in">    as.data.frame %&gt;% select(Mean, `2.5%`, `97.5%`) %&gt;% rownames_to_column("Insecticide") %&gt;%</span></span>
<span id="cb8-563"><a href="#cb8-563" aria-hidden="true" tabindex="-1"></a><span class="in">    pivot_longer(cols = c(3, 4)) %&gt;% rename(P = Mean) %&gt;%</span></span>
<span id="cb8-564"><a href="#cb8-564" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(name = recode(name, `2.5%` = "b_inf", `97.5%` = "b_sup")) %&gt;%</span></span>
<span id="cb8-565"><a href="#cb8-565" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Insecticide = recode(Insecticide, "Eff[2,2]" = "Mavrik Jet", "Eff[3,2]" = "Movento", "Eff[4,2]" = "Teppeki"))</span></span>
<span id="cb8-566"><a href="#cb8-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-567"><a href="#cb8-567" aria-hidden="true" tabindex="-1"></a><span class="in">Order = "binf"</span></span>
<span id="cb8-568"><a href="#cb8-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-569"><a href="#cb8-569" aria-hidden="true" tabindex="-1"></a><span class="in">df_IC = rbind(df_resYhalf %&gt;% mutate(Data = "50% Y - 0% Z"), </span></span>
<span id="cb8-570"><a href="#cb8-570" aria-hidden="true" tabindex="-1"></a><span class="in">              df_resYZ %&gt;% mutate(Data = "50% Y - 50% Z"),</span></span>
<span id="cb8-571"><a href="#cb8-571" aria-hidden="true" tabindex="-1"></a><span class="in">              df_resY %&gt;% mutate(Data = "100% Y - 0% Z"),</span></span>
<span id="cb8-572"><a href="#cb8-572" aria-hidden="true" tabindex="-1"></a><span class="in">              df_resZhalf %&gt;% mutate(Data = "0% Y - 50% Z"))</span></span>
<span id="cb8-573"><a href="#cb8-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-574"><a href="#cb8-574" aria-hidden="true" tabindex="-1"></a><span class="in">prod_rescale = df_resY %&gt;% group_by(Insecticide) %&gt;% summarise(P = ifelse(Order == "moyenne", max(P), min(value))) %&gt;%</span></span>
<span id="cb8-575"><a href="#cb8-575" aria-hidden="true" tabindex="-1"></a><span class="in">                           as.data.frame %&gt;% arrange(P) %&gt;% select(Insecticide) %&gt;% as.matrix %&gt;% as.vector</span></span>
<span id="cb8-576"><a href="#cb8-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-577"><a href="#cb8-577" aria-hidden="true" tabindex="-1"></a><span class="in">x = c(1 : length(prod_rescale));   names(x) = prod_rescale</span></span>
<span id="cb8-578"><a href="#cb8-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-579"><a href="#cb8-579" aria-hidden="true" tabindex="-1"></a><span class="in">df_IC_12 = df_IC %&gt;% mutate(Ordonnee = recode(Insecticide, !!!x)) %&gt;%</span></span>
<span id="cb8-580"><a href="#cb8-580" aria-hidden="true" tabindex="-1"></a><span class="in">                      mutate(Ordonnee = ifelse(Data == "100% Y - 0% Z", Ordonnee + y2, </span></span>
<span id="cb8-581"><a href="#cb8-581" aria-hidden="true" tabindex="-1"></a><span class="in">                                               ifelse(Data == "50% Y - 50% Z", Ordonnee + y1,</span></span>
<span id="cb8-582"><a href="#cb8-582" aria-hidden="true" tabindex="-1"></a><span class="in">                                                      ifelse(Data == "50% Y - 0% Z", Ordonnee - y1, Ordonnee - y2))),</span></span>
<span id="cb8-583"><a href="#cb8-583" aria-hidden="true" tabindex="-1"></a><span class="in">                             jour = "12")     </span></span>
<span id="cb8-584"><a href="#cb8-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-585"><a href="#cb8-585" aria-hidden="true" tabindex="-1"></a><span class="in"># calcul du pourcentage de réduction de l'IC par rapport au scenario 50% Y - 0% Z</span></span>
<span id="cb8-586"><a href="#cb8-586" aria-hidden="true" tabindex="-1"></a><span class="in">df_len = df_IC %&gt;% select(Insecticide, name, value, Data) %&gt;% pivot_wider(names_from =  c(name)) %&gt;% as.data.frame %&gt;%</span></span>
<span id="cb8-587"><a href="#cb8-587" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(IC_length = b_sup - b_inf) %&gt;% arrange(Insecticide)</span></span>
<span id="cb8-588"><a href="#cb8-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-589"><a href="#cb8-589" aria-hidden="true" tabindex="-1"></a><span class="in">df_remp = df_len %&gt;% filter(Data == "50% Y - 0% Z") %&gt;% select(Insecticide, IC_length)</span></span>
<span id="cb8-590"><a href="#cb8-590" aria-hidden="true" tabindex="-1"></a><span class="in">x  = df_remp$IC_length;   names(x) = df_remp$Insecticide</span></span>
<span id="cb8-591"><a href="#cb8-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-592"><a href="#cb8-592" aria-hidden="true" tabindex="-1"></a><span class="in">df_len = df_len %&gt;% mutate(length50pcY = recode(Insecticide, !!!x)) %&gt;%</span></span>
<span id="cb8-593"><a href="#cb8-593" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(`For efficacy at 12 days` = (1 - (IC_length / length50pcY)) * (- 100));   </span></span>
<span id="cb8-594"><a href="#cb8-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-595"><a href="#cb8-595" aria-hidden="true" tabindex="-1"></a><span class="in">df_len12 = df_len %&gt;% rename(Insecticide = Insecticide) %&gt;% select(Insecticide, Data, `For efficacy at 12 days`) %&gt;% </span></span>
<span id="cb8-596"><a href="#cb8-596" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(Data != "50% Y - 0% Z") %&gt;% arrange(Data) %&gt;% mutate_if(is.numeric, round, digits = 1) </span></span>
<span id="cb8-597"><a href="#cb8-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-598"><a href="#cb8-598" aria-hidden="true" tabindex="-1"></a><span class="in">#######################################################################################################################################################</span></span>
<span id="cb8-599"><a href="#cb8-599" aria-hidden="true" tabindex="-1"></a><span class="in">df_IC = rbind(df_IC_6, df_IC_12) %&gt;% mutate(jour = recode(jour, "6" = "A", "12" = "B")); </span></span>
<span id="cb8-600"><a href="#cb8-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-601"><a href="#cb8-601" aria-hidden="true" tabindex="-1"></a><span class="in">col = c("#9F248FFF", "#017A4AFF", "#F9791EFF", "#244579FF")   # c(paletteer_d("awtools::spalette", n = 5))[- c(2)]</span></span>
<span id="cb8-602"><a href="#cb8-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-603"><a href="#cb8-603" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(df_IC) + geom_point(aes(x = P, y = Ordonnee, color = Data), size = 1) +</span></span>
<span id="cb8-604"><a href="#cb8-604" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_line(aes(x = value, y = Ordonnee, group = Ordonnee, color = Data), size = 0.4) + </span></span>
<span id="cb8-605"><a href="#cb8-605" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values = col, limits = c("100% Y - 0% Z", "50% Y - 50% Z", "50% Y - 0% Z", "0% Y - 50% Z")) + </span></span>
<span id="cb8-606"><a href="#cb8-606" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_discrete(limits = prod_rescale) + </span></span>
<span id="cb8-607"><a href="#cb8-607" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(legend.position = "bottom", legend.key.width = unit(1, 'cm'), legend.key.size = unit(0.4, "cm"))  + ylab("") +</span></span>
<span id="cb8-608"><a href="#cb8-608" aria-hidden="true" tabindex="-1"></a><span class="in">    xlab("Treatment efficacy") + geom_vline(xintercept = 0, col = "#990033", size = 0.5, linetype = "dashed") +</span></span>
<span id="cb8-609"><a href="#cb8-609" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(axis.title.x = element_text(margin = margin(b = - 7, t = 5))) +</span></span>
<span id="cb8-610"><a href="#cb8-610" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(~ jour, ncol = 2, scales = "free_x")</span></span>
<span id="cb8-611"><a href="#cb8-611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-612"><a href="#cb8-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-613"><a href="#cb8-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-614"><a href="#cb8-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-615"><a href="#cb8-615" aria-hidden="true" tabindex="-1"></a><span class="in">```{r table5, cache = FALSE}</span></span>
<span id="cb8-616"><a href="#cb8-616" aria-hidden="true" tabindex="-1"></a><span class="in">#|echo: false</span></span>
<span id="cb8-617"><a href="#cb8-617" aria-hidden="true" tabindex="-1"></a><span class="in">cbind(df_len6, df_len12 %&gt;% select(- Data, - Insecticide)) %&gt;% </span></span>
<span id="cb8-618"><a href="#cb8-618" aria-hidden="true" tabindex="-1"></a><span class="in">  kbl(booktabs = TRUE, caption = "Differences in the sizes of the 95 credibility intervals (CI) of the estimated treatment efficacies for the scenarios 50\\% Y - 50\\% Z, 0\\% Y - 50\\% Z and 100\\% Y - 0\\% Z, compared to 50\\% Y - 0\\% Z. The difference is given in percentage. A positive (negative) value indicates an increase (decrease) of the credibility interval size. The third column indicates differences for the efficacy at 6 days after pesticide spray, and the fourth column indicates the difference for the efficacy at 12 days.") %&gt;% </span></span>
<span id="cb8-619"><a href="#cb8-619" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling()</span></span>
<span id="cb8-620"><a href="#cb8-620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-621"><a href="#cb8-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-622"><a href="#cb8-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-623"><a href="#cb8-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-624"><a href="#cb8-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-625"><a href="#cb8-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-626"><a href="#cb8-626" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results obtained by simulation</span></span>
<span id="cb8-627"><a href="#cb8-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-628"><a href="#cb8-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load_res_simulations, cache = FALSE, echo = FALSE}</span></span>
<span id="cb8-629"><a href="#cb8-629" aria-hidden="true" tabindex="-1"></a><span class="in">df_col_simu = readRDS(file = "Files_for_code/Results/Simulations/df_col_simu.rds")</span></span>
<span id="cb8-630"><a href="#cb8-630" aria-hidden="true" tabindex="-1"></a><span class="in">res_simu_sigma_1.87 = readRDS(file = "Files_for_code/Results/Simulations/res_simu_sigma_1.87.rds")</span></span>
<span id="cb8-631"><a href="#cb8-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-632"><a href="#cb8-632" aria-hidden="true" tabindex="-1"></a><span class="in">res_simu = res_simu_sigma_1.87</span></span>
<span id="cb8-633"><a href="#cb8-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-634"><a href="#cb8-634" aria-hidden="true" tabindex="-1"></a><span class="in">res_simu = res_simu %&gt;% mutate(Type = recode(Type, "Y" = "100% Y - 0% Z", "Z" = "0% Y - 100% Z", "Zdemi" = "0% Y - 50% Z",</span></span>
<span id="cb8-635"><a href="#cb8-635" aria-hidden="true" tabindex="-1"></a><span class="in">                                                                  "Ydemi" = "50% Y - 0% Z", "YdemiZdemi" = "50% Y - 50% Z", "ZYdemi" = "50% Y - 100% Z"),</span></span>
<span id="cb8-636"><a href="#cb8-636" aria-hidden="true" tabindex="-1"></a><span class="in">                                         Erreur = recode(name, "MEgamma" = "A", "MEEf6" = "B", "MEEf12" = "C", "MEbest6" = "A", "MEbest12" = "B"),</span></span>
<span id="cb8-637"><a href="#cb8-637" aria-hidden="true" tabindex="-1"></a><span class="in">                                         value = ifelse(grepl("best", name), value * 100, value))</span></span>
<span id="cb8-638"><a href="#cb8-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-639"><a href="#cb8-639" aria-hidden="true" tabindex="-1"></a><span class="in">df_col = df_col_simu</span></span>
<span id="cb8-640"><a href="#cb8-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-641"><a href="#cb8-641" aria-hidden="true" tabindex="-1"></a><span class="in">types = res_simu$Type %&gt;% unique</span></span>
<span id="cb8-642"><a href="#cb8-642" aria-hidden="true" tabindex="-1"></a><span class="in">x = df_col %&gt;% filter(type %in% types) %&gt;% select(col) %&gt;% as.matrix %&gt;% as.vector;   names(x) = types</span></span>
<span id="cb8-643"><a href="#cb8-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-644"><a href="#cb8-644" aria-hidden="true" tabindex="-1"></a><span class="in">res_simu = res_simu %&gt;% mutate(Col = recode(Type, !!!x))</span></span>
<span id="cb8-645"><a href="#cb8-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-646"><a href="#cb8-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-647"><a href="#cb8-647" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interest of combining trials with prevalence and trials with intensity</span></span>
<span id="cb8-648"><a href="#cb8-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-649"><a href="#cb8-649" aria-hidden="true" tabindex="-1"></a>In this section, we consider the situation where only one type of observation is available per trial - pest prevalence or pest intensity. We compare the accuracy of the estimated parameters and estimated levels of treatment efficacy obtained by combining both types of trials compared to the results obtained using each set of trials separately.</span>
<span id="cb8-650"><a href="#cb8-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-651"><a href="#cb8-651" aria-hidden="true" tabindex="-1"></a>The parameters used to generate the data are given in table 6.</span>
<span id="cb8-652"><a href="#cb8-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-653"><a href="#cb8-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-654"><a href="#cb8-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r table6, cache = FALSE, echo = FALSE}</span></span>
<span id="cb8-655"><a href="#cb8-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-656"><a href="#cb8-656" aria-hidden="true" tabindex="-1"></a><span class="in">tab6 = data.frame(Parameters = c(</span></span>
<span id="cb8-657"><a href="#cb8-657" aria-hidden="true" tabindex="-1"></a><span class="in">                    </span></span>
<span id="cb8-658"><a href="#cb8-658" aria-hidden="true" tabindex="-1"></a><span class="in">                    # alpha_0 et alpha_1</span></span>
<span id="cb8-659"><a href="#cb8-659" aria-hidden="true" tabindex="-1"></a><span class="in">                    c("\u03B1\u2080", "\u03B1\u2081"),</span></span>
<span id="cb8-660"><a href="#cb8-660" aria-hidden="true" tabindex="-1"></a><span class="in">                    </span></span>
<span id="cb8-661"><a href="#cb8-661" aria-hidden="true" tabindex="-1"></a><span class="in">                    # gamma_0</span></span>
<span id="cb8-662"><a href="#cb8-662" aria-hidden="true" tabindex="-1"></a><span class="in">                    c("\u03B3\u2080\u2080", "\u03B3\u2080\u2081", "\u03B3\u2080\u2082", "\u03B3\u2080\u2083"),</span></span>
<span id="cb8-663"><a href="#cb8-663" aria-hidden="true" tabindex="-1"></a><span class="in">                    </span></span>
<span id="cb8-664"><a href="#cb8-664" aria-hidden="true" tabindex="-1"></a><span class="in">                    # gamma_1</span></span>
<span id="cb8-665"><a href="#cb8-665" aria-hidden="true" tabindex="-1"></a><span class="in">                    c("\u03B3\u2081\u2080", "\u03B3\u2081\u2081", "\u03B3\u2081\u2082", "\u03B3\u2081\u2083"),</span></span>
<span id="cb8-666"><a href="#cb8-666" aria-hidden="true" tabindex="-1"></a><span class="in">                    </span></span>
<span id="cb8-667"><a href="#cb8-667" aria-hidden="true" tabindex="-1"></a><span class="in">                    # sigma_0, eta et chi</span></span>
<span id="cb8-668"><a href="#cb8-668" aria-hidden="true" tabindex="-1"></a><span class="in">                    c("\u03C3\u2080", "\u03B7", "\u03C7")</span></span>
<span id="cb8-669"><a href="#cb8-669" aria-hidden="true" tabindex="-1"></a><span class="in">                    ),</span></span>
<span id="cb8-670"><a href="#cb8-670" aria-hidden="true" tabindex="-1"></a><span class="in">                  Values = c(alpha0, alpha1, gamma0, gamma1, sig0, eta, chi))</span></span>
<span id="cb8-671"><a href="#cb8-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-672"><a href="#cb8-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-673"><a href="#cb8-673" aria-hidden="true" tabindex="-1"></a><span class="in">tab6 %&gt;%</span></span>
<span id="cb8-674"><a href="#cb8-674" aria-hidden="true" tabindex="-1"></a><span class="in">    t %&gt;%</span></span>
<span id="cb8-675"><a href="#cb8-675" aria-hidden="true" tabindex="-1"></a><span class="in">    kbl(booktabs = TRUE, caption = "Parameters used to generate virtual data.") %&gt;%</span></span>
<span id="cb8-676"><a href="#cb8-676" aria-hidden="true" tabindex="-1"></a><span class="in">    kable_styling()</span></span>
<span id="cb8-677"><a href="#cb8-677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-678"><a href="#cb8-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-679"><a href="#cb8-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-680"><a href="#cb8-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-681"><a href="#cb8-681" aria-hidden="true" tabindex="-1"></a>@fig-five represents the $E_{\gamma}$ (@eq-E_gamma) (**A**), $E_{Ef_6}$ (@eq-E_efficacy) (**B**) and $E_{Ef_{12}}$ (@eq-E_efficacy) (**C**) evaluation criteria for the "0% Y - 50% Z", "50% Y - 0% Z" and "50% Y - 50% Z" scenarios (different scenarios are indicated by different colors. The x-axis presents the number of trials and the y-axis the value of the criterion, averaged over the simulated data sets. For each number of trials and for each criterion, we observe that scenario "50% Y - 50% Z" gives a more accurate estimate than scenario "50% Y - 0% Z" which itself gives a more accurate estimate than scenario "0% Y - 50% Z". For example, for the efficacy at 6 days with 40 trials, the mean absolute error of scenario "50% Y - 0% Z" is 10% less than the mean absolute error of scenario "0% Y - 50% Z" (0.38 vs 0.42). The mean absolute error of scenario "50% Y - 50% Z" is 35% less than that of scenario "0% Y - 50% Z" (0.26 vs 0.42). The values of the three criteria decrease with the number of trials. The $E_{\gamma}$ criterion decreases from 0.62 with 20 trials to 0.32 with 80 trials for the "50% Y - 50% Z" scenario. A value of 20 trials is therefore not sufficient to obtain an accurate estimate of the parameters.</span>
<span id="cb8-682"><a href="#cb8-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-683"><a href="#cb8-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-684"><a href="#cb8-684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r figure5, cache = FALSE, out.width="100%", fig.height = 2.5, echo = FALSE}</span></span>
<span id="cb8-685"><a href="#cb8-685" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-five</span></span>
<span id="cb8-686"><a href="#cb8-686" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Values of the $E_{\\gamma}$ (@eq-E_gamma) (**A**), $E_{Ef_6}$ (@eq-E_efficacy) (**B**) and $E_{Ef_{12}}$ (@eq-E_efficacy) (**C**) mean absolute error criteria for the '0% Y - 50% Z', '50% Y - 0% Z' and '50% Y - 50% Z' scenarios. The x-axis presents the number of trials and the y-axis presents the mean absolute error, averaged over the 974 simulated datasets. Different colors correspond to different scenarios."</span></span>
<span id="cb8-687"><a href="#cb8-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-688"><a href="#cb8-688" aria-hidden="true" tabindex="-1"></a><span class="in">types = c("50% Y - 0% Z", "50% Y - 50% Z", "0% Y - 50% Z")</span></span>
<span id="cb8-689"><a href="#cb8-689" aria-hidden="true" tabindex="-1"></a><span class="in">res_temp = res_simu %&gt;% filter(Type %in% types)</span></span>
<span id="cb8-690"><a href="#cb8-690" aria-hidden="true" tabindex="-1"></a><span class="in">col_temp = df_col %&gt;% arrange(type) %&gt;% filter(type %in% types) %&gt;% select(col) %&gt;% as.matrix %&gt;% as.vector </span></span>
<span id="cb8-691"><a href="#cb8-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-692"><a href="#cb8-692" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(res_temp %&gt;% filter(!grepl("best", name))) + geom_point(aes(x = I, y = value, color = Type), size = 1) +</span></span>
<span id="cb8-693"><a href="#cb8-693" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_line(aes(x = I, y = value, color = Type), size = 0.2) + xlab("Number of trials") +</span></span>
<span id="cb8-694"><a href="#cb8-694" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(~ Erreur, nrow = 1, scales = "free") + theme(legend.position = "bottom") +</span></span>
<span id="cb8-695"><a href="#cb8-695" aria-hidden="true" tabindex="-1"></a><span class="in">    ylab("Mean absolute error") + theme(legend.title = element_blank(), axis.title.x = element_text(margin = margin(t = 5, b = -8))) +</span></span>
<span id="cb8-696"><a href="#cb8-696" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values = col_temp)</span></span>
<span id="cb8-697"><a href="#cb8-697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-698"><a href="#cb8-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-699"><a href="#cb8-699" aria-hidden="true" tabindex="-1"></a>@fig-six presents the percentages of cases where the best treatment at 6 days (A) and 12 days (B) has been correctly identified for the "50% Y - 0% Z", "0% Y - 50% Z" and "50% Y - 50% Z" scenarios. The x-axis presents the number of trials and the y-axis the percentage of cases where the treatment identification is correct. In general, the best treatment is better identified when the number of trials increases. With the "50% Y - 50% Z" scenario, the best treatment at 6 days is well identified in 69% of cases with 20 trials and in 85% of cases with 80 trials. For each number of trials, the percentage of correctly identification is higher for the "50% Y - 50% Z" scenario than for the other two, and the scenario "50% Y - 0% Z" generally gives better results than the scenario "0% Y - 50% Z", except at 6 days with 20 trials. For example, at 12 days after treatment and with 40 trials, the percentage of correct identification is 5% higher with scenario "50% Y - 50% Z" than with scenario "50% Y - 0% Z" (78 vs 73), and 4% higher with the scenario "50% Y - 0% Z" than with scenario "0% Y - 50% Z" (73 vs 69). These results show the interest of combining prevalence and intensity data for assessing the efficacy of treatments and identifying the best treatments.</span>
<span id="cb8-700"><a href="#cb8-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-701"><a href="#cb8-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-702"><a href="#cb8-702" aria-hidden="true" tabindex="-1"></a><span class="in">```{r figure6, cache = FALSE, out.width="100%", fig.height = 3, echo = FALSE}</span></span>
<span id="cb8-703"><a href="#cb8-703" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-six</span></span>
<span id="cb8-704"><a href="#cb8-704" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Comparison of proportion cases where the best treatment is correctly identified in the '0% Y - 50% Z', '50% Y - 0% Z' and '50% Y - 50% Z' scenarios. The x-axis represents the number of trials and the y-axis represents the percentage of cases where the best treatment has been correctly identified at 6 days (A) and 12 days (B), over the 974 simulated datasets. Different colors correspond to different scenarios."</span></span>
<span id="cb8-705"><a href="#cb8-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-706"><a href="#cb8-706" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(res_temp %&gt;% filter(grepl("best", name))) + geom_point(aes(x = I, y = value, color = Type), size = 1) +</span></span>
<span id="cb8-707"><a href="#cb8-707" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_line(aes(x = I, y = value, color = Type), size = 0.2) + xlab("Number of trials") +</span></span>
<span id="cb8-708"><a href="#cb8-708" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(~ Erreur, nrow = 1, scales = "free") + theme(legend.position = "bottom") +</span></span>
<span id="cb8-709"><a href="#cb8-709" aria-hidden="true" tabindex="-1"></a><span class="in">    ylab("Best treatment identification percentage") + theme(legend.title = element_blank(), axis.title.x = element_text(margin = margin(t = 5, b = - 8))) +</span></span>
<span id="cb8-710"><a href="#cb8-710" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values = col_temp)</span></span>
<span id="cb8-711"><a href="#cb8-711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-712"><a href="#cb8-712" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb8-713"><a href="#cb8-713" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interest of adding intensity when prevalence is measured in all trials</span></span>
<span id="cb8-714"><a href="#cb8-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-715"><a href="#cb8-715" aria-hidden="true" tabindex="-1"></a>We now consider a situation where prevalence is measured in each trial and intensity is measured in only some of these trials. We compare the results obtained when the data are combined and when they are used separately. As the prevalence data are usually more accessible in practice and the intensity data more costly, it is important to evaluate the interest of adding intensity data in the statistical analysis.</span>
<span id="cb8-716"><a href="#cb8-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-717"><a href="#cb8-717" aria-hidden="true" tabindex="-1"></a> The parameters used to generate the data are the same as in 3.2.1.</span>
<span id="cb8-718"><a href="#cb8-718" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb8-719"><a href="#cb8-719" aria-hidden="true" tabindex="-1"></a> @fig-seven presents the evaluation criteria $E_{\gamma}$ (Fig 7A), $E_{Ef_6}$ (Fig 7B) and $E_{Ef_{12}}$ (Fig. 7C) for the scenarios "0% Y - 100% Z", "50% Y - 0% Z", "50% Y - 100% Z" and "50% Y - 50% Z". The x-axis presents the number of trials and the y-axis presents the value of the criterion, averaged over the number of simulated data sets. Results show that the mean absolute errors are lower in scenarios "50% Y - 100% Z" and "50% Y - 50% Z" than in "0% Y - 100% Z", and that the mean absolute errors are lower in the "0% Y - 100% Z" scenario than in the "50% Y - 0% Z" scenario. For example, considering the treatment efficacy at 12 days with 40 trials (Fig. 7C), the mean absolute errors are 13% lower in scenarios "50% Y - 100% Z" and "50% Y - 50% Z" than in "0% Y - 100% Z" (0.30 vs 0.34), and the mean absolute error is 11% lower in "0% Y - 100% Z" than in "50% Y - 0% Z" (0.34 vs 0.38). Clearly, adding intensity data to prevalence data improves the accuracy of the estimations. The mean absolute errors decrease with the number of trials. For example, the $E_{\gamma}$ criterion decreases from 0.62 with 20 trials to 0.32 with 80 trials for the "50% Y - 50% Z" scenario. As noted above, 20 trials is clearly not sufficient to obtain accurate results.</span>
<span id="cb8-720"><a href="#cb8-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-721"><a href="#cb8-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r figure7, cache = FALSE, out.width="100%", fig.height = 2.5, echo = FALSE}</span></span>
<span id="cb8-722"><a href="#cb8-722" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-seven</span></span>
<span id="cb8-723"><a href="#cb8-723" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Values of $E_{\\gamma}$ (@eq-E_gamma) (**A**), $E_{Ef_6}$ (@eq-E_efficacy) (**B**) and $E_{Ef_{12}}$ (@eq-E_efficacy) (**C**) for the '0% Y - 100% Z', '50% Y - 0% Z', '50% Y - 100% Z' and '50% Y - 50% Z' scenarios. The x-axis presents the number of trials and the y-axis presents the absolute error averaged over the 974 simulated datasets. Different colors correspond to different scenarios."</span></span>
<span id="cb8-724"><a href="#cb8-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-725"><a href="#cb8-725" aria-hidden="true" tabindex="-1"></a><span class="in">types = c("50% Y - 0% Z", "0% Y - 100% Z", "50% Y - 100% Z", "50% Y - 50% Z")</span></span>
<span id="cb8-726"><a href="#cb8-726" aria-hidden="true" tabindex="-1"></a><span class="in">res_temp = res_simu %&gt;% filter(Type %in% types )</span></span>
<span id="cb8-727"><a href="#cb8-727" aria-hidden="true" tabindex="-1"></a><span class="in">col_temp = df_col %&gt;% arrange(type) %&gt;% filter(type %in% types) %&gt;% select(col) %&gt;% as.matrix %&gt;% as.vector  </span></span>
<span id="cb8-728"><a href="#cb8-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-729"><a href="#cb8-729" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(res_temp %&gt;% filter(!grepl("best", name))) + geom_point(aes(x = I, y = value, color = Type), size = 1) +</span></span>
<span id="cb8-730"><a href="#cb8-730" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_line(aes(x = I, y = value, color = Type), size = 0.2) + xlab("Number of trials") +</span></span>
<span id="cb8-731"><a href="#cb8-731" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(~ Erreur, nrow = 1, scales = "free") + theme(legend.position = "bottom") +</span></span>
<span id="cb8-732"><a href="#cb8-732" aria-hidden="true" tabindex="-1"></a><span class="in">    ylab("Mean absolute error") + theme(legend.title = element_blank(), axis.title.x = element_text(margin = margin(t = 5, b = - 8))) +</span></span>
<span id="cb8-733"><a href="#cb8-733" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values = col_temp)</span></span>
<span id="cb8-734"><a href="#cb8-734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-735"><a href="#cb8-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-736"><a href="#cb8-736" aria-hidden="true" tabindex="-1"></a><span class="fu">### Is it better to measure intensity or prevalence in new pest surveys?</span></span>
<span id="cb8-737"><a href="#cb8-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-738"><a href="#cb8-738" aria-hidden="true" tabindex="-1"></a>In order to optimize the design of new pest surveys that might be conducted in the future, we determine which type of observations should be favored. For that purpose, we compare the results obtained with the "100% Y - 0% Z", "0% Y - 100% Z", "100% Y / 100% Z" and "100% W" scenarios, for different values of $\alpha_0$ that defines the average number of infested plants. With $\alpha_0$ = -1, the proportion of infested plants is generally much lower than one, while with $\alpha_0 = 2$, 100% of plants are generally infested. The case $\alpha_0$ = 1 leads to intermediate levels of infestation.</span>
<span id="cb8-739"><a href="#cb8-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-740"><a href="#cb8-740" aria-hidden="true" tabindex="-1"></a>The three parameter sets used to generate the data are given in Table 7 and are labeled A, B and C. </span>
<span id="cb8-741"><a href="#cb8-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-742"><a href="#cb8-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-743"><a href="#cb8-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-744"><a href="#cb8-744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r table7, cache = FALSE}</span></span>
<span id="cb8-745"><a href="#cb8-745" aria-hidden="true" tabindex="-1"></a><span class="in">#|echo: false</span></span>
<span id="cb8-746"><a href="#cb8-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-747"><a href="#cb8-747" aria-hidden="true" tabindex="-1"></a><span class="in">tab7 = data.frame(Parameters = c(</span></span>
<span id="cb8-748"><a href="#cb8-748" aria-hidden="true" tabindex="-1"></a><span class="in">                    # alpha_0 et alpha_1</span></span>
<span id="cb8-749"><a href="#cb8-749" aria-hidden="true" tabindex="-1"></a><span class="in">                    c("\u03B1\u2080", "\u03B1\u2081"),</span></span>
<span id="cb8-750"><a href="#cb8-750" aria-hidden="true" tabindex="-1"></a><span class="in">                    </span></span>
<span id="cb8-751"><a href="#cb8-751" aria-hidden="true" tabindex="-1"></a><span class="in">                    # gamma_0</span></span>
<span id="cb8-752"><a href="#cb8-752" aria-hidden="true" tabindex="-1"></a><span class="in">                    c("\u03B3\u2080\u2080", "\u03B3\u2080\u2081", "\u03B3\u2080\u2082", "\u03B3\u2080\u2083"),</span></span>
<span id="cb8-753"><a href="#cb8-753" aria-hidden="true" tabindex="-1"></a><span class="in">                    </span></span>
<span id="cb8-754"><a href="#cb8-754" aria-hidden="true" tabindex="-1"></a><span class="in">                    # gamma_1</span></span>
<span id="cb8-755"><a href="#cb8-755" aria-hidden="true" tabindex="-1"></a><span class="in">                    c("\u03B3\u2081\u2080", "\u03B3\u2081\u2081", "\u03B3\u2081\u2082", "\u03B3\u2081\u2083"),</span></span>
<span id="cb8-756"><a href="#cb8-756" aria-hidden="true" tabindex="-1"></a><span class="in">                    </span></span>
<span id="cb8-757"><a href="#cb8-757" aria-hidden="true" tabindex="-1"></a><span class="in">                    # sigma_0, eta et chi</span></span>
<span id="cb8-758"><a href="#cb8-758" aria-hidden="true" tabindex="-1"></a><span class="in">                    c("\u03C3\u2080", "\u03B7", "\u03C7")</span></span>
<span id="cb8-759"><a href="#cb8-759" aria-hidden="true" tabindex="-1"></a><span class="in">                    ),</span></span>
<span id="cb8-760"><a href="#cb8-760" aria-hidden="true" tabindex="-1"></a><span class="in">                  </span></span>
<span id="cb8-761"><a href="#cb8-761" aria-hidden="true" tabindex="-1"></a><span class="in">                  "Values set A" = c(-1, alpha1, gamma0, gamma1, sig0, eta, chi),</span></span>
<span id="cb8-762"><a href="#cb8-762" aria-hidden="true" tabindex="-1"></a><span class="in">                  "Values set B" = c(1, alpha1, gamma0, gamma1, sig0, eta, chi),</span></span>
<span id="cb8-763"><a href="#cb8-763" aria-hidden="true" tabindex="-1"></a><span class="in">                  "Values set C" = c(2, alpha1, gamma0, gamma1, sig0, eta, chi)</span></span>
<span id="cb8-764"><a href="#cb8-764" aria-hidden="true" tabindex="-1"></a><span class="in">                  )</span></span>
<span id="cb8-765"><a href="#cb8-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-766"><a href="#cb8-766" aria-hidden="true" tabindex="-1"></a><span class="in">tab7 %&gt;%</span></span>
<span id="cb8-767"><a href="#cb8-767" aria-hidden="true" tabindex="-1"></a><span class="in">    t %&gt;% </span></span>
<span id="cb8-768"><a href="#cb8-768" aria-hidden="true" tabindex="-1"></a><span class="in">    `rownames&lt;-`(c("Set", "A", "B", "C")) %&gt;% </span></span>
<span id="cb8-769"><a href="#cb8-769" aria-hidden="true" tabindex="-1"></a><span class="in">    kbl(booktabs = TRUE, caption = "Parameters considered for the design of future pest surveys.") %&gt;%</span></span>
<span id="cb8-770"><a href="#cb8-770" aria-hidden="true" tabindex="-1"></a><span class="in">    column_spec(2, bold = TRUE) %&gt;%</span></span>
<span id="cb8-771"><a href="#cb8-771" aria-hidden="true" tabindex="-1"></a><span class="in">    kable_styling()</span></span>
<span id="cb8-772"><a href="#cb8-772" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-773"><a href="#cb8-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-774"><a href="#cb8-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-775"><a href="#cb8-775" aria-hidden="true" tabindex="-1"></a>@fig-height (A.1, B.1 and C.1) shows the mean absolute error $E_{\gamma}$ (@eq-E_gamma) as a function of the number of trials for the four scenarios "100% Y - 0% Z", "0% Y - 100% Z", "100% Y / 100% Z" and "100% W". @fig-height (A.2, B.2 and C.2) shows the distributions of infested plants with 40 trials corresponding to the three values of $\alpha_0$ reported in Table 7.</span>
<span id="cb8-776"><a href="#cb8-776" aria-hidden="true" tabindex="-1"></a>In case A (Table 7), the distribution of Z is such that Z is rarely close to 1 and often lower than 0.5 (@fig-height A.2). In case C, the distribution of Z is such that Z is often very close to 1 (100% of plants infested). Case B is intermediate. The accuracy of the estimated values of the model parameters $\gamma$ is better with scenario "100% Y - 0% Z" than with scenario "0% Y - 100% Z", for all number of trials. The advantage of "100% Y - 0% Z" is stronger in case of high pest prevalence (i.e., cases B and C) but very small in case of low pest prevalence (case A). For example, with 20 trials, the mean absolute error is 27% lower in the scenario "100% Y - 0% Z" than in "0% Y - 100% Z" for parameter set C (0.55 vs. 0.75), 10% lower for parameter set B (0.55 vs. 0.62), and not different for parameter set A (0.64). The "100% W" scenario leads to similar results as "100% Y - 0% Z", regardless of $\alpha_0$ and the number of trials. Results obtained with "100% Y / 100% Z" are generally similar to those obtained with "100% Y - 0% Z" and "100% W" but better than those obtained with the scenario "0% Y - 100% Z" in cases B and C. Here again, results show that 20 trials are not sufficient to obtain accurate parameter estimates.</span>
<span id="cb8-777"><a href="#cb8-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-778"><a href="#cb8-778" aria-hidden="true" tabindex="-1"></a><span class="in">```{r figure8, cache = FALSE, out.width="100%", fig.height = 6, echo = FALSE}</span></span>
<span id="cb8-779"><a href="#cb8-779" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-height</span></span>
<span id="cb8-780"><a href="#cb8-780" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Comparison of the '100% Y - 0% Z', '0% Y - 100% Z', '100% Y / 100% Z' and '100% W' scenarios according to the distribution of $Z$ and the number of trials, using the $E_{\\gamma}$ criterion (@eq-E_gamma). **A**, **B** and **C** correspond to different $Z$ distributions which are given by A.2, B.2 and C.2 (distribution for a number of trials equal to 40). A, B and C respectively correspond to $\\alpha_0 =$ -1, 1 and 2. The details of the simulation parameters are given in table 7. A1, B1 and C1 represent the absolute error $E_{\\gamma}$ averaged over the 974 simulated datasets as a function of the number of trials. Colors correspond to the different scenarios."</span></span>
<span id="cb8-781"><a href="#cb8-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-782"><a href="#cb8-782" aria-hidden="true" tabindex="-1"></a><span class="in">res_simu_q3_1 = readRDS(file = "Files_for_code/Results/Simulations/res_simu_q3_1.rds");   </span></span>
<span id="cb8-783"><a href="#cb8-783" aria-hidden="true" tabindex="-1"></a><span class="in">res_simu_q3_2 = readRDS(file = "Files_for_code/Results/Simulations/res_simu_q3_2.rds")</span></span>
<span id="cb8-784"><a href="#cb8-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-785"><a href="#cb8-785" aria-hidden="true" tabindex="-1"></a><span class="in">res_simu_q3_1 = res_simu_q3_1 %&gt;% mutate(Type = recode(Type, "100% Y - 100% Z" = "100% Y / 100% Z"))</span></span>
<span id="cb8-786"><a href="#cb8-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-787"><a href="#cb8-787" aria-hidden="true" tabindex="-1"></a><span class="in">types = res_simu_q3_1$Type %&gt;% unique</span></span>
<span id="cb8-788"><a href="#cb8-788" aria-hidden="true" tabindex="-1"></a><span class="in">col = df_col %&gt;% arrange(type) %&gt;% filter(type %in% types) %&gt;% select(col) %&gt;% as.matrix %&gt;% as.vector  </span></span>
<span id="cb8-789"><a href="#cb8-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-790"><a href="#cb8-790" aria-hidden="true" tabindex="-1"></a><span class="in">g1 = suppressWarnings(ggplot(res_simu_q3_1) + geom_point(aes(x = I, y = Mean_MAE, color = Type), size = 1) +</span></span>
<span id="cb8-791"><a href="#cb8-791" aria-hidden="true" tabindex="-1"></a><span class="in">              geom_line(aes(x = I, y = Mean_MAE, color = Type), size = 0.2) +</span></span>
<span id="cb8-792"><a href="#cb8-792" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(~ alpha0, ncol = 1, labeller = label_wrap_gen(multi_line = FALSE)) + </span></span>
<span id="cb8-793"><a href="#cb8-793" aria-hidden="true" tabindex="-1"></a><span class="in">    ylab(TeX("Mean relative absolute error for $\\gamma$")) + scale_color_manual(values = col[c(1, 2, 3, 4)]) + theme(plot.margin = margin(l = 0)) +</span></span>
<span id="cb8-794"><a href="#cb8-794" aria-hidden="true" tabindex="-1"></a><span class="in">    xlab("Number of trials") + theme(legend.position = "bottom", plot.margin = margin(t = 0, l = 0))) </span></span>
<span id="cb8-795"><a href="#cb8-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-796"><a href="#cb8-796" aria-hidden="true" tabindex="-1"></a><span class="in">legend = cowplot::get_legend(g1)</span></span>
<span id="cb8-797"><a href="#cb8-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-798"><a href="#cb8-798" aria-hidden="true" tabindex="-1"></a><span class="in">g2 = suppressWarnings(ggplot(res_simu_q3_2) + geom_histogram(aes(Z), stat = "count", fill = "#4345a1") + facet_wrap(~ alpha0, ncol = 1) + </span></span>
<span id="cb8-799"><a href="#cb8-799" aria-hidden="true" tabindex="-1"></a><span class="in">    ylab("Number of observations") + theme(plot.margin = margin(r = 0, l = 15, t = 0)) + xlab("Number of infested beets"))</span></span>
<span id="cb8-800"><a href="#cb8-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-801"><a href="#cb8-801" aria-hidden="true" tabindex="-1"></a><span class="in">suppressWarnings(do.call("grid.arrange", c(list(legend), list(g1  + theme(legend.position = "none"), g2), list(ncol = 2, layout_matrix = rbind(c(2, 3), c(1, 1)), heights = c(1, 0.2)))))</span></span>
<span id="cb8-802"><a href="#cb8-802" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-803"><a href="#cb8-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-804"><a href="#cb8-804" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb8-805"><a href="#cb8-805" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-806"><a href="#cb8-806" aria-hidden="true" tabindex="-1"></a>In order to evaluate pest treatment efficacy, numerous trials are conducted to monitor pest prevalence and intensity. Quite often, only one type of data is available and, when both prevalence and intensity are available, they are usually analysed separately. In this paper, we proposed an alternative approach based on a hierarchical statistical model able to analyze intensity and prevalence data, simultaneously.</span>
<span id="cb8-807"><a href="#cb8-807" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-808"><a href="#cb8-808" aria-hidden="true" tabindex="-1"></a>We successfully applied the model to a real dataset including prevalence and incidence data collected to evaluate three pesticide treatments against aphids in sugar beets. The model was fitted to this datased using a Markov chain Monte Carlo algorithm, and convergence was quickly achieved after a few thousands iterations. Results showed that the use of both prevalence and intensity data led to a substantial reduction of the uncertainty in the parameter estimates, compared to the use of a single type of data.</span>
<span id="cb8-809"><a href="#cb8-809" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb8-810"><a href="#cb8-810" aria-hidden="true" tabindex="-1"></a>Results obtained from simulated data confirmed that, when pest prevalence and pest intensity are collected separately in different trials, the model parameters are more accurately estimated combining both prevalence and intensity trials than using one type of trials only. We also found that, when prevalence data are collected in all trials and intensity data are collected in a subset of trials, estimations and pest treatment ranking are more accurate using both types of data than using prevalence data only. Moreover, when only one type of observation can be collected in a pest survey or in an experimental trial, our analysis indicates that it is usually better to collect intensity data than prevalence data, especially in situations where all or most of the plants are expected to be infested. Finally, our simulations show that it is unlikely to obtain accurate results with fewer than 40 trials when assessing the efficacy of pest control treatments based on prevalence and intensity data.</span>
<span id="cb8-811"><a href="#cb8-811" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-812"><a href="#cb8-812" aria-hidden="true" tabindex="-1"></a>Although our framework was illustrated to compare the efficacy of plant pest treatments, it could be applied to other areas of research in the future, in particular for optimizing designs used in animal and human epidemiology. It is imperative to note that the ultimate selection of a design should be contingent upon the consideration of localized constraints. As the model codes are made fully available, we believe that these codes could be used by different institutes to compare many different designs in the future, not only the types of designs considered in our paper. Of particular significance is the capability of our model to optimize sample sizes, with its impact contingent on the relative importance of within-trial variability compared to between-trial variability.    </span>
<span id="cb8-813"><a href="#cb8-813" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb8-814"><a href="#cb8-814" aria-hidden="true" tabindex="-1"></a><span class="fu"># Author contributions {.unnumbered}</span></span>
<span id="cb8-815"><a href="#cb8-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-816"><a href="#cb8-816" aria-hidden="true" tabindex="-1"></a>AF and DM designed the study. AF performed the computations. AF and DM wrote the paper.</span>
<span id="cb8-817"><a href="#cb8-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-818"><a href="#cb8-818" aria-hidden="true" tabindex="-1"></a><span class="fu"># Funding {.unnumbered}</span></span>
<span id="cb8-819"><a href="#cb8-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-820"><a href="#cb8-820" aria-hidden="true" tabindex="-1"></a>This work was partly funded by the project SEPIM (PNRI) and by the RMT SDMAA. </span>
<span id="cb8-821"><a href="#cb8-821" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-822"><a href="#cb8-822" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data availability {.unnumbered}</span></span>
<span id="cb8-823"><a href="#cb8-823" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-824"><a href="#cb8-824" aria-hidden="true" tabindex="-1"></a>Simulated data and model parameters are available without restriction. The original experimental data may be available under request.</span>
<span id="cb8-825"><a href="#cb8-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-826"><a href="#cb8-826" aria-hidden="true" tabindex="-1"></a><span class="fu"># Acknowledgements {.unnumbered}</span></span>
<span id="cb8-827"><a href="#cb8-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-828"><a href="#cb8-828" aria-hidden="true" tabindex="-1"></a>We are grateful to Anabelle Laurent, Elma Raaijmakers, Kathleen Antoons and to the institute ITB (https://www.itbfr.org/) for their comments on this project. </span>
<span id="cb8-829"><a href="#cb8-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-830"><a href="#cb8-830" aria-hidden="true" tabindex="-1"></a>We are grateful to the INRAE MIGALE bioinformatics facility (MIGALE, INRAE, 2020. Migale bioinformatics Facility, doi: 10.15454/1.5572390655343293E12) for providing help and/or computing and/or storage resources.</span>
<span id="cb8-831"><a href="#cb8-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-832"><a href="#cb8-832" aria-hidden="true" tabindex="-1"></a><span class="fu"># References {.unnumbered}</span></span>
<span id="cb8-833"><a href="#cb8-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-834"><a href="#cb8-834" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb8-835"><a href="#cb8-835" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb8-836"><a href="#cb8-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-837"><a href="#cb8-837" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session information {.appendix .unnumbered}</span></span>
<span id="cb8-838"><a href="#cb8-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-839"><a href="#cb8-839" aria-hidden="true" tabindex="-1"></a><span class="in">```{r session-info}</span></span>
<span id="cb8-840"><a href="#cb8-840" aria-hidden="true" tabindex="-1"></a><span class="in">sessionInfo()</span></span>
<span id="cb8-841"><a href="#cb8-841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-842"><a href="#cb8-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-843"><a href="#cb8-843" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>